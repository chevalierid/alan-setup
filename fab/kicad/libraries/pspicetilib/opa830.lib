* OPA830 
*****************************************************************************
* (C) Copyright 2016 Texas Instruments Incorporated. All rights reserved.
*****************************************************************************
** This model is designed as an aid for customers of Texas Instruments.
** TI and its licensors and suppliers make no warranties, either expressed
** or implied, with respect to this model, including the warranties of 
** merchantability or fitness for a particular purpose.  The model is
** provided solely on an "as is" basis.  The entire risk as to its quality
** and performance is with the customer.
*****************************************************************************
*
* Released by: Analog eLab Design Center, Texas Instruments Inc.
* Part: OPA2830
* Dual, Low-Power, Single-Supply, Wideband OPERATIONAL AMPLIFIER
* Date: 14/07/2016
* Model Type: PSPICE
* Simulator Version: 16.2.0.p001
* Datasheet: SBOS309D–AUGUST 2004–REVISED AUGUST 2008
*
*****************************************************************************

*  Notes: 
* OPA830 SUBCIRCUIT
* HIGH SPEED MONOLITHIC FULLY DIFFERENTIAL AMPLIFIER 
* THIS MODEL SIMULATES TYPICAL VALUES FOR THE FOLLOWING AT 5V OPERATION:
*   OUTPUT VOLTAGE LIMIT, INPUT VOLTAGE NOISE, INPUT BIAS CURRENT,
*   INPUT OFFSET VOLTAGE AND OFFSET CURRENT,CURRENT DRAWN FROM POWER SUPPLY
*   PSRR, CMRR
* THE LEAST POSITIVE INPUT VOLTAGE FOR THIS MACROMODEL IS 0.2V BELOW THE LOWER RAIL 
* MACROMODEL BANDWIDTH AGREES WITH SILICON FOR GAINS OF +2V/V, +5V/V, +10V/V.
* MACROMODEL BANDWIDTH FOR GAIN = +1V/V IS LOW COMPARED TO SILICON
* MACROMODEL SLEW RATE AGREES WITH SILICON FOR G=+2
* THIS MODEL DOES NOT MEET MANY OF THE DATA SHEET PARAMETERS AT 3V AND 10V OPERATION
* THIS MODEL IS TAKEN FROM OPA830. THE NAME OF SUBCIRCUIT IS CHANGED TO OPA2830.

***************************************************************************************
.SUBCKT OPA830 IN+ IN- VCC VEE VOUT
V2          24 25 2.4
IS3         VEE 30 5.05U
IS2         VCC 22 4.95U
V8          41 VEE 50M
V7          VCC 42 50M
Vos         22 44 -1.5M
Vor_4       48 49 100M
Vor_1       50 51 100M
V11         7 56 10
V10         57 7 10
Vor_2       53 55 5
Vor_3       54 52 5
IS1         VCC VEE 3.9M
V6          72 7 140
V5          7 73 140
R32         23 6 1 
EVCVS7      24 7 VCC 7  1
XU9         23 25 IDEAL_D_0
C11         26 7 8.25F IC=1.0022663618 
R28         9 7 1K 
GVCCS13     7 9 26 7  1M
R27         11 7 1K 
GVCCS14     7 11 9 7  1M
XR107       26 7 RNOISE_FREE_0
GVCCS10     7 26 27 7  1U
Cdiff       28 29 1.8P IC=-504.1045803864U 
CinpCM      29 7 600F IC=1.000702095 
CinnCM      7 28 600F IC=-1.0001979904 
L1          31 7 12M IC=-100.0000499747U 
XR107_2     7 28 RNOISE_FREE_1
XR107_3     29 7 RNOISE_FREE_1
R11         7 32 10MEG 
R10         40 8 1 
EVCVS1      40 7 30 7  1
R4          13 7 100K 
R1          14 7 100K 
XU24        7 15 13 41 VCVS_LIMIT_0
XU23        15 7 42 14 VCVS_LIMIT_0
C17         19 7 1P IC=0 
C16         7 43 1P IC=0 
C20         17 7 1P IC=0 
C15         VCC VEE 10P IC=0 
C22         7 20 1P IC=-10.5458647139M 
R31         20 12 1 
C23         7 10 1F IC=0 
C9          45 7 10P IC=0 
R30         45 15 10 
C21         7 16 1P IC=0 
C19         7 18 1P IC=0 
C12         47 7 1P IC=0 
R29         46 10 1 
R36         10 51 1M 
R35         10 49 1M 
SW12        52 48 18 7  S_VSWITCH_1
SW11        50 53 7 19  S_VSWITCH_2
R34         10 54 1K 
R33         10 55 1K 
SW10        57 12 20 7  S_VSWITCH_3
SW9         12 56 7 20  S_VSWITCH_4
R26         58 18 1 
R25         59 19 1 
R19         38 43 1 
R16         39 47 1 
R14         60 16 1 
R13         61 17 1 
R12         62 9 10M 
R7          63 12 10M 
R6          64 11 10M 
XU7         7 65 34 7 VCVS_LIMIT_1
XU6         46 32 36 7 VCVS_LIMIT_1
R5          34 33 200 
R15         0 7 100MEG 
GIsinking   VEE 7 66 7  1M
GIsourcing  VCC 7 67 7  1M
R23         66 7 10K 
SW7         15 66 45 7  S_VSWITCH_5
R21         7 67 10K 
SW8         15 67 45 7  S_VSWITCH_6
SW4         63 60 16 7  S_VSWITCH_7
SW3         61 63 7 17  S_VSWITCH_8
XU5         53 21 61 7 VCVS_LIMIT_2
XU3         52 21 60 7 VCVS_LIMIT_2
SW2         64 58 18 7  S_VSWITCH_9
SW1         59 64 7 19  S_VSWITCH_10
R22         68 6 1 
EVCVS4      68 7 22 7  1
XIn11       44 28 FEMT_0
XVn11       29 44 VNSE_0
SW6         62 38 43 7  S_VSWITCH_11
SW5         39 62 7 47  S_VSWITCH_12
XU26        6 8 7 37 VCCS_LIMIT_0
XU4         37 7 7 12 VCCS_LIMIT_1
EVCVS10     35 7 36 33  -1
R8          35 65 1MEG 
R9          65 34 1MEG 
R24         32 36 10MEG 
LPSR        69 7 2U IC=0 
XU25        70 7 71 28 VCVS_LIMIT_3
XU22        72 15 59 7 VCVS_LIMIT_4
XU21        73 15 58 7 VCVS_LIMIT_4
XU20        13 VOUT 38 7 VCVS_LIMIT_4
XU19        14 VOUT 39 7 VCVS_LIMIT_5
R20         IN+ 29 1 
R18         IN- 28 1 
XR106a      27 31 RNOISE_FREE_0
GVCCS6      7 27 21 7  1U
XR102       74 75 RNOISE_FREE_0
XR101       76 74 RNOISE_FREE_0
C6          74 0 1 IC=0 
XR105       21 7 RNOISE_FREE_0
XR104       12 7 RNOISE_FREE_2
XR103       7 37 RNOISE_FREE_0
EVCVS34     7 0 74 0  1
RPSR        69 70 1 
GVCCS11     7 70 VCC VEE  400U
RCM         77 78 1 
EVCVS29     76 0 VCC 0  1
EVCVS28     75 0 VEE 0  1
LCM         77 7 560N IC=-100.0000499747U 
EVCVSCM     71 30 78 7  1
GVCCS7      7 78 22 7  -200U
VCCVS1_in   33 VOUT
HCCVS1      15 7 VCCVS1_in   1K
GVCCS5      7 21 12 7  1U
Ccc         12 7 172P IC=1.0032648632 
EVCVS3      46 7 11 7  1
.MODEL S_VSWITCH_1 VSWITCH (RON=1 ROFF=10MEG VON=100M VOFF=-100M)
.MODEL S_VSWITCH_2 VSWITCH (RON=1 ROFF=10MEG VON=100M VOFF=-100M)
.MODEL S_VSWITCH_3 VSWITCH (RON=1 ROFF=100MEG VON=150 VOFF=0)
.MODEL S_VSWITCH_4 VSWITCH (RON=1 ROFF=100MEG VON=150 VOFF=0)
.MODEL S_VSWITCH_5 VSWITCH (RON=1M ROFF=10MEG VON=-10M VOFF=0)
.MODEL S_VSWITCH_6 VSWITCH (RON=1M ROFF=10MEG VON=10M VOFF=0)
.MODEL S_VSWITCH_7 VSWITCH (RON=1 ROFF=10MEG VON=1 VOFF=-1)
.MODEL S_VSWITCH_8 VSWITCH (RON=1 ROFF=10MEG VON=1 VOFF=-1)
.MODEL S_VSWITCH_9 VSWITCH (RON=1 ROFF=1G VON=10 VOFF=-10)
.MODEL S_VSWITCH_10 VSWITCH (RON=1 ROFF=1G VON=10 VOFF=-10)
.MODEL S_VSWITCH_11 VSWITCH (RON=1 ROFF=10MEG VON=10 VOFF=-10)
.MODEL S_VSWITCH_12 VSWITCH (RON=1 ROFF=10MEG VON=10 VOFF=-10)
.ENDS


*TG IDEAL DIODE
.SUBCKT IDEAL_D_0  A C
D1 A C DNOM
.MODEL DNOM D (TT=10P CJO=1E-18 IS=1E-15 RS=1E-3)
.ENDS IDEAL_D_0 


* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_0  1 2
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=1E6
ERES 1 3 VALUE = { I(VSENSE) * ROHMS }
RDUMMY 30 3 1
VSENSE 30 2 DC 0V
.ENDS RNOISE_FREE_0 


* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_1  1 2
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=8E5
ERES 1 3 VALUE = { I(VSENSE) * ROHMS }
RDUMMY 30 3 1
VSENSE 30 2 DC 0V
.ENDS RNOISE_FREE_1 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_0  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = 10.6M
.PARAM VPOS = 2
.PARAM VNEG = 0
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS VCVS_LIMIT_0 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_1  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = 1000K
.PARAM VPOS = 60000
.PARAM VNEG = -60000
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS VCVS_LIMIT_1 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_2  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = 100
.PARAM VPOS = 6000
.PARAM VNEG = -6000
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS VCVS_LIMIT_2 


* BEGIN PROG NSE FEMTO AMP/RT-HZ 
.SUBCKT FEMT_0  1 2
* BEGIN SETUP OF NOISE GEN - FEMPTOAMPS/RT-HZ
* INPUT THREE VARIABLES
* SET UP INSE 1/F
* FA/RHZ AT 1/F FREQ
.PARAM NLFF=8960
* FREQ FOR 1/F VAL
.PARAM FLWF=340
* SET UP INSE FB
* FA/RHZ FLATBAND
.PARAM NVRF=3530
* END USER INPUT
* START CALC VALS
.PARAM GLFF={PWR(FLWF,0.25)*NLFF/1164}
.PARAM RNVF={1.184*PWR(NVRF,2)}
.MODEL DVNF D KF={PWR(FLWF,0.5)/1E11} IS=1.0E-16
* END CALC VALS
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVNF
D2 8 0 DVNF
E1 3 6 7 8 {GLFF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNVF}
R5 5 0 {RNVF}
R6 3 4 1E9
R7 4 0 1E9
G1 1 2 3 4 1E-6
C1 1 0 1E-15
C2 2 0 1E-15
C3 1 2 1E-15
.ENDS
* END PROG NSE FEMTO AMP/RT-HZ


* BEGIN PROG NSE NANO VOLT/RT-HZ
.SUBCKT VNSE_0  1 2
* BEGIN SETUP OF NOISE GEN - NANOVOLT/RT-HZ
* INPUT THREE VARIABLES
* SET UP VNSE 1/F
* NV/RHZ AT 1/F FREQ
.PARAM NLF=22
* FREQ FOR 1/F VAL
.PARAM FLW=32
* SET UP VNSE FB
* NV/RHZ FLATBAND
.PARAM NVR=9.2
* END USER INPUT
* START CALC VALS
.PARAM GLF={PWR(FLW,0.25)*NLF/1164}
.PARAM RNV={1.184*PWR(NVR,2)}
.MODEL DVN D KF={PWR(FLW,0.5)/1E11} IS=1.0E-16
* END CALC VALS
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVN
D2 8 0 DVN
E1 3 6 7 8 {GLF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNV}
R5 5 0 {RNV}
R6 3 4 1E9
R7 4 0 1E9
E3 1 2 3 4 1
C1 1 0 1E-15
C2 2 0 1E-15
C3 1 2 1E-15
.ENDS
* END PROG NSE NANOV/RT-HZ


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCCS_LIMIT_0  VC+ VC- IOUT+ IOUT-
*              
.PARAM GAIN = 100U
.PARAM IPOS = .5
.PARAM INEG = -.5
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),IPOS,INEG)}
.ENDS VCCS_LIMIT_0 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCCS_LIMIT_1  VC+ VC- IOUT+ IOUT-
*              
.PARAM GAIN = 2.3E-3
.PARAM IPOS = 0.165
.PARAM INEG = -0.165
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),IPOS,INEG)}
.ENDS VCCS_LIMIT_1 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_3  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = -1
.PARAM VPOS = 20M
.PARAM VNEG = -20M
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS VCVS_LIMIT_3 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_4  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = 100
.PARAM VPOS = 5000
.PARAM VNEG = -5000
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS VCVS_LIMIT_4 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_5  VC+ VC- VOUT+ VOUT-
*             
.PARAM GAIN = 100
.PARAM VPOS = 5000
.PARAM VNEG = -5000
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS VCVS_LIMIT_5 


* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_2  1 2
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=32000
ERES 1 3 VALUE = { I(VSENSE) * ROHMS }
RDUMMY 30 3 1
VSENSE 30 2 DC 0V
.ENDS RNOISE_FREE_2 


.END
