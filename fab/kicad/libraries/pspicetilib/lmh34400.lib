* LMH34400 - Rev. A
* Created by Sean Cashin; 2022-05-16
* Created with Green-Williams-Lis Current Sense Amp Macro-model Architecture
* Copyright 2022 by Texas Instruments Corporation
******************************************************
* MACRO-MODEL SIMULATED PARAMETERS:
******************************************************
* AC PARAMETERS
**********************
* CLOSED-LOOP OUTPUT IMPEDANCE VS. FREQUENCY (Zout vs. Freq.)
* CLOSED-LOOP GAIN AND PHASE VS. FREQUENCY  WITH RL, CL EFFECTS (Acl vs. Freq.)
* COMMON-MODE REJECTION RATIO VS. FREQUENCY (CMRR vs. Freq.)
* POWER SUPPLY REJECTION RATIO VS. FREQUENCY (PSRR vs. Freq.)
* INPUT VOLTAGE NOISE DENSITY VS. FREQUENCY (en vs. Freq.)
**********************
* DC PARAMETERS
**********************
* INPUT COMMON-MODE VOLTAGE RANGE (Vcm)
* GAIN ERROR (Eg)
* INPUT BIAS CURRENT VS. INPUT COMMON-MODE VOLTAGE (Ib vs. Vcm)
* INPUT OFFSET VOLTAGE VS. TEMPERATURE (Vos vs. Temp)
* OUTPUT VOLTAGE SWING vs. OUTPUT CURRENT (Vout vs. Iout)
* SHORT-CIRCUIT OUTPUT CURRENT (Isc)
* QUIESCENT CURRENT (Iq)
**********************
* TRANSIENT PARAMETERS
**********************
* SLEW RATE (SR)
* SETTLING TIME VS. CAPACITIVE LOAD (ts)
* OVERLOAD RECOVERY TIME (tor)
******************************************************
.subckt LMH34400 IN VDD nEN nIDC_EN GND OUT
******************************************************
.MODEL R_NOISE RES (T_ABS=25)
.MODEL R_NOISELESS RES (T_ABS=-273.15)
C_C1         N707559 N707569  16E-6   
C_C2         N707579 N707589  2.65E-9   
C_C3         N707599 PSRRP  19.89E-12   
C_C30         N634613 0  0.74E-9   
C_C31         N634649 0  325E-12   
C_C32         N635794 N517170  160E-15   
C_C33         N635892 0  150E-12   
C_C34         N689434 N689440  1.3E-9   
C_C4         N1807909 N1807837  45E-12   
C_C49         0 VAMB  450E-9   
C_C5         VEE_B NEND  2E-12   
C_C61         N1694904 N1694894  10E-9   
C_C66         N689440 ZIN  5E-12   
C_C67         N689510 N689440  1.3E-12   
C_C68         N1810125 MID  10E-12   
C_C7         N707691 N707681  16E-6   
C_C8         N707671 N707661  15.92E-12   
C_C9         N708033 PSRRN  16E-15   
C_CMID         0 MID  1E-3   
E_E10         POSTMID 0 MID 0 1
E_E5         ZOINP N665548 N517170 0 1
E_E9         N665548 N709380 TEMPS 0 20E-6
E_EDRIFT2         N689510 N699068 TEMPC 0 1.1E-3
G_G1         VCC_CLP VEE_B VCC_B VEE_B -1
G_G10         VCC_CLP VEE_B VIMON 0 11.8
G_G11         VEE_CLP VCC_B VCC_B VEE_B 1
G_G12         VEE_CLP VCC_B 0 VIMON -13.9
G_G13         N516672 0 N463960 0 -19.45E3
G_G16         N460572 0 N460322 0 1
G_G17         GND 0 N461004 0 -1
G_G18         N460322 0 VIMON 0 -1
G_G19         N461004 0 0 VIMON -1
G_G2         N707579 MID N707569 MID -166
G_G3         N707599 MID N707589 MID -37.5
G_G37         N707559 MID VCC_B MID -16.5E-3
G_G39         N634649 0 N634613 0 -1
G_G4         VCC_B 0 VDD 0 -1
G_G40         N635870 0 N634649 0 -5
G_G41         N635794 0 N635892 0 -3
G_G42         VDD N465370 TEMPS 0 34E-6
G_G5         VEE_B 0 GND 0 -1
G_G7         N707691 MID VEE_B MID -0.68
G_G8         N707671 MID N707681 MID -50
G_G82         N1694592 0 VAMB 0 1
G_G88         0 IN_POST_ALC N1694918 0 0.12
G_G9         N707651 MID N707661 MID -1
G_GPSRR         N709380 N709328 PSRRP PSRRN -1
I_I2         VCC_CLP VEE_B DC 0.9  
I_I3         VCC_B VEE_CLP DC 0.2  
I_IQ1         VDD N465370 DC 8E-3  
I_IQ2         VDD N465482 DC 1.5E-3ADC  
I_IQ3         NEN VEE_B DC 65E-6  
I_ITEMP         0 TEMPS DC 1  
L_L1         N681058 N634613  1E-9  
L_L2         N1694904 N1694918  1E-6  
L_L5         N635870 N635892  1E-9  
L_L6         N689440 N689510  190E-9  
L_L7         N1807909 N1807837  10E-9  
R_R1         MID N707559  1 TC=0,0 
R_R10         0 N634613  2 TC=0,0 
R_R11         0 N634649  1 TC=0,0 
R_R15         0 N635794  1 TC=0,0 
R_R17         N517170 N635794  1E3 TC=0,0 
R_R19         PSRRN N707651  9E3 TC=0,0 
R_R2         ZIN N689434  770 TC=0,0 
R_R20         N707681 N707691  10E3 TC=0,0 
R_R21         N707661 N707671  1E3 TC=0,0 
R_R219         VAMB 0 R_NOISELESS 10E3
R_R22         MID N707691  1 TC=0,0 
R_R23         MID N707681  9 TC=0,0 
R_R24         MID N707671  1 TC=0,0 
R_R246         N1694918 0 R_NOISELESS 25
R_R247         N1694894 N1694904 R_NOISELESS 1E9
R_R25         MID N707661  20.41 TC=0,0 
R_R252         N1807837 N1807909  20 TC=0,0 
R_R253         N689440 N689510  350 TC=0,0 
R_R26         MID N707651  1 TC=0,0 
R_R27         MID N708033  1E3 TC=0,0 
R_R3         MID N707569  9 TC=0,0 
R_R31         VDD N460572  1E-3 TC=0,0 
R_R35         NEND NEN  18E3 TC=0,0 
R_R4         N707589 N707579  1E3 TC=0,0 
R_R6         MID N707589  6.036 TC=0,0 
R_R61         TEMPS 0  1 TC=1,0 
R_R65         N707569 N707559  10E3 TC=0,0 
R_R66         PSRRP N707599  1E3 TC=0,0 
R_R67         MID N707579  1 TC=0,0 
R_R68         MID N707599  1 TC=0,0 
R_R69         MID PSRRP  27.4 TC=0,0 
R_R70         0 N516672  1 TC=0,0 
R_R71         0 N635870  1 TC=0,0 
R_R72         0 N635892  2 TC=0,0 
R_R9         N709380 N709328  1 TC=0,0 
R_RINM1         0 VCC_B  1  
R_RINM3         MID VCC_B  1E3  
R_RINM4         0 MID  1E9 TC=0,0 
R_RINM5         VEE_B MID  1E3 TC=0,0 
R_RINM7         0 VEE_B  1 TC=0,0 
R_RIQ         N465370 VDD  330 TC=0,0 
R_RQ         GND N465482  1E-3 TC=0,0 
V_VINPUT_BIAS         VCC_B N699068 0.8
V_VOUTPUT_BIAS         N1807837 POSTMID -0.65
V_VTEMPAMB         TEMPC TEMPS 26
X_F1    N1694592 N1694772 VAMB 0 8COMPLETE_F1_LMH34400 
X_H4    PREOUT OUT VIMON 0 8COMPLETE_H4_LMH34400 
X_H5    IN_POST_ALC ZIN N463960 0 8COMPLETE_H5_LMH34400 
X_H6    N1694772 IN_POST_ALC N1694894 0 8COMPLETE_H6_LMH34400 
X_S11    VIMON 0 VCC_CLP VEE_B 8COMPLETE_S11_LMH34400 
X_S12    0 VIMON VEE_CLP VCC_B 8COMPLETE_S12_LMH34400 
X_S20    NIDC_EN GND IN IN_POST_ALC 8COMPLETE_S20_LMH34400 
X_S21    NIDC_EN GND IN N1694592 8COMPLETE_S21_LMH34400 
X_S29    NEND GND N465482 N465370 8COMPLETE_S29_LMH34400 
X_S30    VIMON 0 N460322 0 8COMPLETE_S30_LMH34400 
X_S31    0 VIMON N461004 0 8COMPLETE_S31_LMH34400 
X_S36    OUT VCC_CLP N517170 0 8COMPLETE_S36_LMH34400 
X_S37    VEE_CLP OUT N517170 0 8COMPLETE_S37_LMH34400 
X_S38    NEND GND IN_POST_ALC GND 8COMPLETE_S38_LMH34400 
X_S39    TEMPC 0 ZIN N689440 8COMPLETE_S39_LMH34400 
X_S40    NEND GND PREOUT ZOINP 8COMPLETE_S40_LMH34400 
X_S41    NEND GND PREOUT N1810125 8COMPLETE_S41_LMH34400 
X_U1         MID IN FEMT_LMH34400
X_U2         N1807909 N709328 VNSE_LMH34400
X_W1    N681007 N516672 N681007 N516672 8COMPLETE_W1_LMH34400 
X_W2    N681007 N681058 N681007 N681058 8COMPLETE_W2_LMH34400 
.ENDS  LMH34400
*
.SUBCKT 8COMPLETE_F1_LMH34400 1 2 3 4  
F_F1         3 4 VF_F1 -1
VF_F1         1 2 0V
.ENDS  8COMPLETE_F1_LMH34400
*
.SUBCKT 8COMPLETE_H4_LMH34400 1 2 3 4  
H_H4         3 4 VH_H4 1
VH_H4         1 2 0V
.ENDS  8COMPLETE_H4_LMH34400
*
.SUBCKT 8COMPLETE_H5_LMH34400 1 2 3 4  
H_H5         3 4 VH_H5 -1
VH_H5         1 2 0V
.ENDS  8COMPLETE_H5_LMH34400
*
.SUBCKT 8COMPLETE_H6_LMH34400 1 2 3 4  
H_H6         3 4 VH_H6 1
VH_H6         1 2 0V
.ENDS  8COMPLETE_H6_LMH34400
*
.SUBCKT 8COMPLETE_S11_LMH34400 1 2 3 4  
S_S11         3 4 1 2 _S11
RS_S11         1 2 1G
.MODEL         _S11 VSWITCH ROFF=1 RON=1E-3 VOFF=0.07 VON=0.085
.ENDS  8COMPLETE_S11_LMH34400
*
.SUBCKT 8COMPLETE_S12_LMH34400 1 2 3 4  
S_S12         3 4 1 2 _S12
RS_S12         1 2 1G
.MODEL         _S12 VSWITCH ROFF=1 RON=1E-3 VOFF=0.045 VON=0.05
.ENDS  8COMPLETE_S12_LMH34400
*
.SUBCKT 8COMPLETE_S20_LMH34400 1 2 3 4  
S_S20         3 4 1 2 _S20
RS_S20         1 2 1G
.MODEL         _S20 VSWITCH ROFF=1E6 RON=1E-3 VOFF=1.2 VON=1.6
.ENDS  8COMPLETE_S20_LMH34400
*
.SUBCKT 8COMPLETE_S21_LMH34400 1 2 3 4  
S_S21         3 4 1 2 _S21
RS_S21         1 2 1G
.MODEL         _S21 VSWITCH ROFF=1E-3 RON=1E6 VOFF=1.2 VON=1.6
.ENDS  8COMPLETE_S21_LMH34400
*
.SUBCKT 8COMPLETE_S29_LMH34400 1 2 3 4  
S_S29         3 4 1 2 _S29
RS_S29         1 2 1G
.MODEL         _S29 VSWITCH ROFF=1 RON=1E9 VOFF=1.2 VON=1.6
.ENDS  8COMPLETE_S29_LMH34400
*
.SUBCKT 8COMPLETE_S30_LMH34400 1 2 3 4  
S_S30         3 4 1 2 _S30
RS_S30         1 2 1G
.MODEL         _S30 VSWITCH ROFF=1E-6 RON=1 VOFF=0 VON=0.1E-3
.ENDS  8COMPLETE_S30_LMH34400
*
.SUBCKT 8COMPLETE_S31_LMH34400 1 2 3 4  
S_S31         3 4 1 2 _S31
RS_S31         1 2 1G
.MODEL         _S31 VSWITCH ROFF=1E-6 RON=1 VOFF=0 VON=0.1E-3
.ENDS  8COMPLETE_S31_LMH34400
*
.SUBCKT 8COMPLETE_S36_LMH34400 1 2 3 4  
S_S36         3 4 1 2 _S36
RS_S36         1 2 1G
.MODEL         _S36 VSWITCH ROFF=1E3 RON=1E-3 VOFF=-20E-3 VON=20E-3
.ENDS  8COMPLETE_S36_LMH34400
*
.SUBCKT 8COMPLETE_S37_LMH34400 1 2 3 4  
S_S37         3 4 1 2 _S37
RS_S37         1 2 1G
.MODEL         _S37 VSWITCH ROFF=1E3 RON=1E-3 VOFF=-20E-3 VON=20E-3
.ENDS  8COMPLETE_S37_LMH34400
*
.SUBCKT 8COMPLETE_S38_LMH34400 1 2 3 4  
S_S38         3 4 1 2 _S38
RS_S38         1 2 1G
.MODEL         _S38 VSWITCH ROFF=1E6 RON=0.1 VOFF=1.2 VON=1.6
.ENDS  8COMPLETE_S38_LMH34400
*
.SUBCKT 8COMPLETE_S39_LMH34400 1 2 3 4  
S_S39         3 4 1 2 _S39
RS_S39         1 2 1G
.MODEL         _S39 VSWITCH ROFF=81.5 RON=400 VOFF=-40 VON=300
.ENDS  8COMPLETE_S39_LMH34400
*
.SUBCKT 8COMPLETE_S40_LMH34400 1 2 3 4  
S_S40         3 4 1 2 _S40
RS_S40         1 2 1G
.MODEL         _S40 VSWITCH ROFF=9 RON=10E6 VOFF=1.2 VON=1.6
.ENDS  8COMPLETE_S40_LMH34400
*
.SUBCKT 8COMPLETE_S41_LMH34400 1 2 3 4  
S_S41         3 4 1 2 _S41
RS_S41         1 2 1G
.MODEL         _S41 VSWITCH ROFF=10E6 RON=1 VOFF=1.2 VON=1.6
.ENDS  8COMPLETE_S41_LMH34400
*
.SUBCKT 8COMPLETE_W1_LMH34400 1 2 3 4  
W_W1         3 4 VW_W1 _W1
VW_W1         1 2 0V
.MODEL         _W1 ISWITCH ROFF=1E-3 RON=1E6 IOFF=0.346 ION=0.35
.ENDS  8COMPLETE_W1_LMH34400
*
.SUBCKT 8COMPLETE_W2_LMH34400 1 2 3 4  
W_W2         3 4 VW_W2 _W2
VW_W2         1 2 0V
.MODEL         _W2 ISWITCH ROFF=1E-3 RON=1E6 IOFF=0.346 ION=0.35
.ENDS  8COMPLETE_W2_LMH34400
*
.SUBCKT FEMT_LMH34400 1 2
.PARAM FLWF=10000
.PARAM NLFF=7000
.PARAM NVRF=2500
.PARAM GLFF={PWR(FLWF,0.25)*NLFF/1164}
.PARAM RNVF={1.184*PWR(NVRF,2)}
.MODEL DVNF D KF={PWR(FLWF,0.5)/1E11} IS=1.0E-16
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVNF
D2 8 0 DVNF
E1 3 6 7 8 {GLFF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNVF}
R5 5 0 {RNVF}
R6 3 4 1E9
R7 4 0 1E9
G1 1 2 3 4 1E-6
.ENDS  FEMT_LMH34400
*
.SUBCKT VNSE_LMH34400 1 2
.PARAM FLW=10000
.PARAM NLF=7
.PARAM NVR=2.35
.PARAM GLF={PWR(FLW,0.25)*NLF/1164}
.PARAM RNV={1.184*PWR(NVR,2)}
.MODEL DVN D KF={PWR(FLW,0.5)/1E11} IS=1.0E-16
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVN
D2 8 0 DVN
E1 3 6 7 8 {GLF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNV}
R5 5 0 {RNV}
R6 3 4 1E9
R7 4 0 1E9
E3 1 2 3 4 1
.ENDS  VNSE_LMH34400
*