* OPA836 - Rev. A
* Created by Sean Cashin; 2020-03-24
* Created with Green-Williams-Lis Current Sense Amp Macro-model Architecture
* Copyright 2020 by Texas Instruments Corporation
******************************************************
* MACRO-MODEL SIMULATED PARAMETERS:
******************************************************
* AC PARAMETERS
**********************
* CLOSED-LOOP OUTPUT IMPEDANCE VS. FREQUENCY (Zout vs. Freq.)
* CLOSED-LOOP GAIN AND PHASE VS. FREQUENCY  WITH RL, CL EFFECTS (Acl vs. Freq.)
* COMMON-MODE REJECTION RATIO VS. FREQUENCY (CMRR vs. Freq.)
* POWER SUPPLY REJECTION RATIO VS. FREQUENCY (PSRR vs. Freq.)
* INPUT VOLTAGE NOISE DENSITY VS. FREQUENCY (en vs. Freq.)
**********************
* DC PARAMETERS
**********************
* INPUT COMMON-MODE VOLTAGE RANGE (Vcm)
* GAIN ERROR (Eg)
* INPUT BIAS CURRENT VS. INPUT COMMON-MODE VOLTAGE (Ib vs. Vcm)
* INPUT OFFSET VOLTAGE VS. TEMPERATURE (Vos vs. Temp)
* OUTPUT VOLTAGE SWING vs. OUTPUT CURRENT (Vout vs. Iout)
* SHORT-CIRCUIT OUTPUT CURRENT (Isc)
* QUIESCENT CURRENT (Iq)
**********************
* TRANSIENT PARAMETERS
**********************
* SLEW RATE (SR)
* SETTLING TIME VS. CAPACITIVE LOAD (ts)
* OVERLOAD RECOVERY TIME (tor)
******************************************************
.subckt OPA836 IN+ IN- OUT VCC VEE Vnot_pd
******************************************************
.MODEL R_NOISELESS RES (T_ABS=-273.15)
C_C1         LN CLAMP  4.33E-9   
C_C1A16         N1102900 N1102910  16.12E-9   
C_C1A17         N1102916 N709248  159.2E-12   
C_C1A33         N1106172 N1106182  16.12E-9   
C_C1A34         N1106188 N706294  159.2E-12   
C_C33         N406634 0  1E-15   
C_C34         N317950 0  1   
C_C35         N406794 0  1E-15   
C_C39         N1252259 N1252249  350E-9   
C_C41         N1268170 N1268207  80E-15   
C_C44         N1464277 LN  100E-12   
C_C45         LN N1464195  400E-12   
C_C46         LN N1464227  170E-12   
C_C47         N1480336 N1480326  20E-15   
C_C48         N1682969 LN  200P   
C_C7         N31014 LN  1P   
C_C_CMN         LN ESDN  1.2E-12   
C_C_CMN1         ESDN ESDP  1E-12   
C_C_CMP         ESDP LN  1.2E-12   
C_C_VIMON         LN VIMON  1E-9   
C_C_VOUT_S         LN VOUT_S  1E-12   
E_E3         N112292 LN OUT LN 1
E_E6         LN 0 N317950 0 1
E_E7         VCCC 0 VCC 0 1
E_E8         VEEE 0 VEE 0 1
G_G100         N1480326 LN N1268170 LN -10
G_G101         LP LN N1464227 LN -1
G_G102         N1464195 LN CLAMP LN -1
G_G103         N1464227 LN N1464195 LN -1
G_G104         N1254878 LN N1480336 LN -240
G_G106         N1106172 LN VEE_B LN -403E-3
G_G107         VCC_CLP VEEE VCC_B VEE_B -1
G_G108         VEE_CLP VCCC VCC_B VEE_B 1
G_G109         N1619882 0 VIMON LN 15
G_G110         0 VEE_CLP LN VIMON 6
G_G111         VCC VEE N1682969 LN 1E-3
G_G36         VCC_B 0 VCC 0 -1
G_G37         VEE_B 0 VEE 0 -1
G_G6         N25816 N11984 N709248 N706294 -1E-3
G_G77         N1106188 LN N1106182 LN -2
G_G87         N1102900 LN VCC_B LN -403E-3
G_G88         N1102916 LN N1102910 LN -2
G_G96         N1252249 LN N1464277 ZOUT -90.91
G_G98         N1263527 LN N1252259 LN -22
I_I1         VNOT_PD 0 DC 20N  
I_I_B         N06456 LN DC 650E-9  
I_I_OS         ESDN LN DC 620E-9  
I_I_Q         VCC VEE DC 5E-6  
L_L1         LP N1464277  1E-9  
R_R1         ESDP IN+ R_NOISELESS 10E-3
R_R10         ESDN N11991 R_NOISELESS 1E-3
R_R107         VCC_B 0 R_NOISELESS 1
R_R108         N317950 0 R_NOISELESS 1E12
R_R109         VEE_B 0 R_NOISELESS 1
R_R110         VCC_B N406634 R_NOISELESS 1E-3
R_R111         N406634 N317950 R_NOISELESS 1E6
R_R112         N317950 N406794 R_NOISELESS 1E6
R_R113         N406794 VEE_B R_NOISELESS 1E-3
R_R148         N1102916 LN R_NOISELESS 1
R_R162         ESDN ESDP R_NOISELESS 200E3
R_R183         N1102900 LN R_NOISELESS 1
R_R185         N1106172 LN R_NOISELESS 1
R_R186         N1106188 LN R_NOISELESS 1
R_R1A16         N1102916 N709248 R_NOISELESS 10E3
R_R1A31         N1102900 N1102910 R_NOISELESS 10E3
R_R1A33         N1106172 N1106182 R_NOISELESS 10E3
R_R1A34         N1106188 N706294 R_NOISELESS 10E3
R_R2         ESDN IN- R_NOISELESS 10E-3
R_R208         N1252259 N1252249 R_NOISELESS 10E3
R_R209         LN N1252249 R_NOISELESS 1
R_R21         N11984 N25816 R_NOISELESS 1E3
R_R210         LN N1252259 R_NOISELESS 500
R_R211         LN N1254878 R_NOISELESS 1
R_R212         LN ZOUT R_NOISELESS 3000
R_R213         ZOUT N1254878 R_NOISELESS 30000
R_R218         LN N1263527 R_NOISELESS 1
R_R219         LN N1268207 R_NOISELESS 10E3
R_R220         N1268170 N1263527 R_NOISELESS 90E3
R_R226         LN N1464277 R_NOISELESS 14
R_R230         LN N1464195 R_NOISELESS 1
R_R231         LN N1464227 R_NOISELESS 1
R_R243         N1480336 N1480326 R_NOISELESS 10E3
R_R244         LN N1480326 R_NOISELESS 1
R_R245         LN N1480336 R_NOISELESS 20
R_R248         VCC_CLP N1619882 R_NOISELESS 1E-3
R_R25         LN N28602 R_NOISELESS 1E9
R_R251         LN LP R_NOISELESS 1
R_R254         LN AOLNET R_NOISELESS 1E6
R_R255         LN N1682945 R_NOISELESS 1
R_R26         N30136 LN R_NOISELESS 1E9
R_R27         LN N30913 R_NOISELESS 1
R_R28         N31014 N30913 R_NOISELESS 1E-3
R_R2A17         N1102910 LN R_NOISELESS 99.73
R_R2A18         N709248 LN R_NOISELESS 5
R_R2A34         N1106182 LN R_NOISELESS 99.73
R_R2A35         N706294 LN R_NOISELESS 5
R_R3         LN ESDP R_NOISELESS 200E3
R_R4         ESDN LN R_NOISELESS 200E3
R_R8         N638941 N11006 R_NOISELESS 1E3
R_R81         LN VIMON R_NOISELESS 1
R_R83         LN N112292 R_NOISELESS 1E9
R_R9         N11006 N11984 R_NOISELESS 1E-3
R_R_VOUT_S         VOUT_S N112292 R_NOISELESS 100
V_V4         N1682557 LN 1VDC
V_VCM_MAX         N30136 VCC_B -1.1
V_VCM_MIN         N28602 VEE_B -0.2
X_ESD_OUT         OUT VCC VEE ESD_OUT_OPA836 
X_E_N         ESDP N06456 VNSE_OPA836 
X_F1    VOUT OUT LN VIMON 08_OP_AMP_COMPLETE_F1_OPA836 
X_IQ_N         LN VIMON LN VEE IQ_SRC_OPA836 
X_IQ_P         VIMON LN VCC LN IQ_SRC_OPA836 
X_I_NP1         ESDN LN FEMT_OPA836 
X_S10    OUT VCC_CLP LN LP 08_OP_AMP_COMPLETE_S10_OPA836 
X_S11    VNOT_PD VEEE N1682945 N1682557 08_OP_AMP_COMPLETE_S11_OPA836 
X_S12    N1682969 N1682945 N1682969 N1682945 08_OP_AMP_COMPLETE_S12_OPA836 
X_S13    N1682969 LN AOLNET LN 08_OP_AMP_COMPLETE_S13_OPA836 
X_S14    N1682969 LN VOUT ZOUT 08_OP_AMP_COMPLETE_S14_OPA836 
X_S3    VIMON LN VCC_CLP VEEE 08_OP_AMP_COMPLETE_S3_OPA836 
X_S4    LN VIMON VEE_CLP VCCC 08_OP_AMP_COMPLETE_S4_OPA836 
X_S7    VEE_CLP OUT CLAMP LN 08_OP_AMP_COMPLETE_S7_OPA836 
X_S8    OUT VCC_CLP CLAMP LN 08_OP_AMP_COMPLETE_S8_OPA836 
X_S9    VEE_CLP OUT LN LP 08_OP_AMP_COMPLETE_S9_OPA836 
X_U1         LN N06456 FEMT_OPA836 
X_U2         N31014 N11991 AOLNET LN AOL_1_OPA836
X_U3         AOLNET LN CLAMP LN AOL_2_OPA836 
X_VCM_CLAMP         N25816 LN N30913 LN N30136 N28602 VCM_CLAMP_OPA836 
X_VOS_DRIFT         N749288 N06456 VOS_DRIFT_OPA836 
X_VOS_VS_VCM         N638941 N749288 VCC VEE VOS_VS_VCM_OPA836 
.ENDS  OPA836
*
.SUBCKT 08_OP_AMP_COMPLETE_F1_OPA836 1 2 3 4  
F_F1         3 4 VF_F1 1
VF_F1         1 2 0V
.ENDS  08_OP_AMP_COMPLETE_F1_OPA836
*
.SUBCKT 08_OP_AMP_COMPLETE_S10_OPA836 1 2 3 4  
S_S10         3 4 1 2 _S10
RS_S10         1 2 1G
.MODEL         _S10 VSWITCH ROFF=2E6 RON=1E-3 VOFF=-0.1 VON=0.06
.ENDS  08_OP_AMP_COMPLETE_S10_OPA836
*
.SUBCKT 08_OP_AMP_COMPLETE_S11_OPA836 1 2 3 4  
S_S11         3 4 1 2 _S11
RS_S11         1 2 1G
.MODEL         _S11 VSWITCH ROFF=1E9 RON=1E-3 VOFF=0.7 VON=2.1
.ENDS  08_OP_AMP_COMPLETE_S11_OPA836
*
.SUBCKT 08_OP_AMP_COMPLETE_S12_OPA836 1 2 3 4  
S_S12         3 4 1 2 _S12
RS_S12         1 2 1G
.MODEL         _S12 VSWITCH ROFF=700 RON=250 VOFF=-0.3 VON=0.1
.ENDS  08_OP_AMP_COMPLETE_S12_OPA836
*
.SUBCKT 08_OP_AMP_COMPLETE_S13_OPA836 1 2 3 4  
S_S13         3 4 1 2 _S13
RS_S13         1 2 1G
.MODEL         _S13 VSWITCH ROFF=0.001 RON=1E6 VOFF=0.3 VON=0.7
.ENDS  08_OP_AMP_COMPLETE_S13_OPA836
*
.SUBCKT 08_OP_AMP_COMPLETE_S14_OPA836 1 2 3 4  
S_S14         3 4 1 2 _S14
RS_S14         1 2 1G
.MODEL         _S14 VSWITCH ROFF=10MEG RON=21E-3 VOFF=0.3 VON=0.7
.ENDS  08_OP_AMP_COMPLETE_S14_OPA836
*
.SUBCKT 08_OP_AMP_COMPLETE_S3_OPA836 1 2 3 4  
S_S3         3 4 1 2 _S3
RS_S3         1 2 1G
.MODEL         _S3 VSWITCH ROFF=1 RON=1E-3 VOFF=55E-3 VON=80E-3
.ENDS  08_OP_AMP_COMPLETE_S3_OPA836
*
.SUBCKT 08_OP_AMP_COMPLETE_S4_OPA836 1 2 3 4  
S_S4         3 4 1 2 _S4
RS_S4         1 2 1G
.MODEL         _S4 VSWITCH ROFF=1 RON=1E-3 VOFF=55E-3 VON=80E-3
.ENDS  08_OP_AMP_COMPLETE_S4_OPA836
*
.SUBCKT 08_OP_AMP_COMPLETE_S7_OPA836 1 2 3 4  
S_S7         3 4 1 2 _S7
RS_S7         1 2 1G
.MODEL         _S7 VSWITCH ROFF=2E6 RON=1E-3 VOFF=-0.1 VON=0.06
.ENDS  08_OP_AMP_COMPLETE_S7_OPA836
*
.SUBCKT 08_OP_AMP_COMPLETE_S8_OPA836 1 2 3 4  
S_S8         3 4 1 2 _S8
RS_S8         1 2 1G
.MODEL         _S8 VSWITCH ROFF=2E6 RON=1E-3 VOFF=-0.1 VON=0.06
.ENDS  08_OP_AMP_COMPLETE_S8_OPA836
*
.SUBCKT 08_OP_AMP_COMPLETE_S9_OPA836 1 2 3 4  
S_S9         3 4 1 2 _S9
RS_S9         1 2 1G
.MODEL         _S9 VSWITCH ROFF=2E6 RON=1E-3 VOFF=-0.1 VON=0.06
.ENDS  08_OP_AMP_COMPLETE_S9_OPA836
*
.SUBCKT AOL_1_OPA836 VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 1E-4
.PARAM IPOS = .5
.PARAM INEG = -.5
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),INEG,IPOS)}
.ENDS  AOL_1_OPA836
*
.SUBCKT AOL_2_OPA836 VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 0.0286
.PARAM IPOS = 1.96
.PARAM INEG = -2.03
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),INEG,IPOS)}
.ENDS  AOL_2_OPA836
*
.SUBCKT ESD_OUT_OPA836 OUT VCC VEE
.MODEL ESD_SW VSWITCH(RON=50 ROFF=1E12 VON=500E-3 VOFF=450E-3)
S1 VCC OUT OUT VCC ESD_SW
S2 OUT VEE VEE OUT ESD_SW
.ENDS  ESD_OUT_OPA836
*
.SUBCKT FEMT_OPA836 1 2
.PARAM FLWF=1
.PARAM NLFF=100
.PARAM NVRF=0.75
.PARAM GLFF={PWR(FLWF,0.25)*NLFF/1164}
.PARAM RNVF={1.184*PWR(NVRF,2)}
.MODEL DNVF D KF={PWR(FLWF,0.5)/1E11} IS=1.0E-16
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DNVF
D2 8 0 DNVF
E1 3 6 7 8 {GLFF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNVF}
R5 5 0 {RNVF}
R6 3 4 1E9
R7 4 0 1E9
G1 1 2 3 4 1E-6
.ENDS  FEMT_OPA836
*
.SUBCKT IQ_SRC_OPA836 VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 1E-3
G1 IOUT+ IOUT- VALUE={IF( (V(VC+,VC-)<=0),0,GAIN*V(VC+,VC-) )}
.ENDS  IQ_SRC_OPA836
*
.SUBCKT VCM_CLAMP_OPA836 VIN+ VIN- IOUT- IOUT+ VP+ VP-
.PARAM GAIN = 1
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VIN+,VIN-),V(VP-,VIN-), V(VP+,VIN-))}
.ENDS  VCM_CLAMP_OPA836
*
.SUBCKT VNSE_OPA836 1 2
.PARAM FLW=1
.PARAM NLF=75
.PARAM NVR=4.6
.PARAM GLF={PWR(FLW,0.25)*NLF/1164}
.PARAM RNV={1.184*PWR(NVR,2)}
.MODEL DVN D KF={PWR(FLW,0.5)/1E11} IS=1.0E-16
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVN
D2 8 0 DVN
E1 3 6 7 8 {GLF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNV}
R5 5 0 {RNV}
R6 3 4 1E9
R7 4 0 1E9
E3 1 2 3 4 1
.ENDS  VNSE_OPA836
*
.SUBCKT VOS_DRIFT_OPA836 VOS+ VOS-
.PARAM DC = 45.12E-6
.PARAM POL = 1
.PARAM DRIFT = 20E-6
E1 VOS+ VOS- VALUE={DC+POL*DRIFT*(TEMP-27)}
.ENDS  VOS_DRIFT_OPA836
*
.SUBCKT VOS_VS_VCM_OPA836 V+ V- REF+ REF-
E1 V+ 1 TABLE {(V(REF+, V-))} =
+(0.35, 450E-6)
+(0.4, 435E-6)
+(0.55, 275E-6)
+(0.65, 150E-6)
+(0.75, 75E-6)
+(0.85, 25E-6)
+(1, 0)
V1 1 V- 0
.ENDS  VOS_VS_VCM_OPA836
*