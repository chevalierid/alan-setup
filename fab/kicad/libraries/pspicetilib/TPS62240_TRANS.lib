*$
*TPS62240
*****************************************************************************
* (C) Copyright 2009 Texas Instruments Incorporated. All rights reserved.                                            
*****************************************************************************
** This model is designed as an aid for customers of Texas Instruments.                                             
** TI and its licensors and suppliers make no warranties, either expressed                                           
** or implied, with respect to this model, including the warranties of                                                    
** merchantability or fitness for a particular purpose. The model is                                                      
** provided solely on an "as is" basis. The entire risk as to its quality                                                    
** and performance is with the customer                                                                                          
*****************************************************************************
*
* This model was developed for Texas Instruments Incorporated by:
*   AEi Systems, LLC
*   5777 W. Century Blvd., Suite 876
*   Los Angeles, California  90045
*
* This model is subject to change without notice. Neither Texas Instruments Incorporated 
* nor AEi Systems is responsible for updating this model.
* For more information regarding modeling services, model libraries and simulation 
* products, please call AEi Systems at (310) 216-1144, or contact AEi Systems by email: 
* info@AENG.com. Or visit AEi Systems on the web at http://www.AENG.com.
*
*****************************************************************************
*
** Released by: Analog eLab Design Center, Texas Instruments Inc.
* Part: TPS62240
* Date: 06/17/2009
* Model Type: Transient 
* Simulator: PSpice 
* Simulator Version: 16.0.0.p001
* EVM Order Number: TPS62240EVM-229 
* EVM Users Guide: SLVU216, July 2007 
* Datasheet: SLVS762B, June 2007 - Revised September 2007
*
*****************************************************************************
.SUBCKT TPS62240_TRANS SW MODE FB EN VIN GND
X_GATE_DRIVER_U17         GATE_DRIVER_N106 GATE_DRIVER_N110 delay PARAMS:
+  PARAMS:  T=20  
R_GATE_DRIVER_R20         ODB GATE_DRIVER_N16553895  1  
X_GATE_DRIVER_U21         GATE_DRIVER_N16553895 GATE_DRIVER_N108 INV
X_GATE_DRIVER_U18         GATE_DRIVER_N107 GATE_DRIVER_N111 GATE_DRIVER_N105
+  AND2
C_GATE_DRIVER_C11         0 GATE_DRIVER_N16553895  1n  
X_GATE_DRIVER_U16         GATE_DRIVER_N106 GATE_DRIVER_N110 GATE_DRIVER_N104
+  AND2
R_GATE_DRIVER_R17         PULSE GATE_DRIVER_N106  1  
C_GATE_DRIVER_C8         0 GATE_DRIVER_N106  1n  
R_GATE_DRIVER_R21         GATE_DRIVER_N100 HS  1  
C_GATE_DRIVER_C12         0 HS  1n  
X_GATE_DRIVER_U19         GATE_DRIVER_N106 GATE_DRIVER_N107 INV
X_GATE_DRIVER_U22         GATE_DRIVER_N108 LS_ODB GATE_DRIVER_N109 OR2
X_GATE_DRIVER_U20         GATE_DRIVER_N107 GATE_DRIVER_N111 delay PARAMS:
+  PARAMS:  T=20  
E_GATE_DRIVER_ABM2         GATE_DRIVER_N101 0 VALUE {
+  IF(V(GATE_DRIVER_N109)>0.5, 0, V(GATE_DRIVER_N105))    }
E_GATE_DRIVER_ABM1         GATE_DRIVER_N100 0 VALUE {
+  IF(V(GATE_DRIVER_N16553895)>0.5, V(GATE_DRIVER_N104), 0)    }
R_GATE_DRIVER_R19         GATE_DRIVER_N101 LS  1  
C_GATE_DRIVER_C9         0 LS  1n  
X_PFM_CONTROLLER_U40         MODE PFM_CONTROLLER_MODE_INV INV
C_PFM_CONTROLLER_C14         0 PFM_CONTROLLER_N16895416  15pF  
X_PFM_CONTROLLER_U44         PFM_CONTROLLER_N104 PFM_EN
+  PFM_CONTROLLER_N16976278 AND2
s_PFM_CONTROLLER_S5         VIN,PFM_CONTROLLER_N16895210,PFM,0,
+  mod_PFM_CONTROLLER_S5 
.model  mod_PFM_CONTROLLER_S5 vswitch (ron=1m)
X_PFM_CONTROLLER_U48         PFM_CONTROLLER_N17126807 OCP_MODE
+  PFM_CONTROLLER_N16866999 OR2
V_PFM_CONTROLLER_V16         PFM_CONTROLLER_N16565192 0 2mV
X_PFM_CONTROLLER_U35          0 I_LO PFM_CONTROLLER_N167982113
+  PFM_CONTROLLER_N104 COMP_HYS
X_PFM_CONTROLLER_U28         PFM_CONTROLLER_N16919300 PFM_CONTROLLER_S_I
+  PFM_CONTROLLER_N16855383 AND2
R_PFM_CONTROLLER_R24         PFM_CONTROLLER_N16930800 PFM_CONTROLLER_N16927902 
+  300k  
X_PFM_CONTROLLER_U37          PFM_CONTROLLER_N16914101 I_LO
+  PFM_CONTROLLER_N16914378 COMP
X_PFM_CONTROLLER_U31         PFM_CONTROLLER_N16914378 PFM_CONTROLLER_N17047772
+  PFM_CONTROLLER_N16866417 RSFF_RDOM_VAR PARAMS:  T=5 
X_PFM_CONTROLLER_U53         PFM_CONTROLLER_N17094128 PFM_CONTROLLER_N17093812
+  PFM_CONTROLLER_N16785798 AND2
X_PFM_CONTROLLER_U30          FB PFM_CONTROLLER_N169163312
+  PFM_CONTROLLER_N16918667 COMP
C_PFM_CONTROLLER_C12         0 I_LO_M  20nF  
X_PFM_CONTROLLER_U29         PFM_CONTROLLER_N16866417 PFM_CONTROLLER_N16855383
+  PFM RSFF_RDOM_VAR PARAMS:  T=1 
V_PFM_CONTROLLER_V15         PFM_CONTROLLER_N166671953 0 2mV
V_PFM_CONTROLLER_V18         PFM_CONTROLLER_N16914101 0 20mV
X_PFM_CONTROLLER_U52         VIN PFM_CONTROLLER_N16976103 EN_SS VIN
+  PFM_CONTROLLER_N17096352 PFM_CONTROLLER_N17058416 PFM_CONTROLLER_N17055089
+  PFM_CONTROLLER_N17056967 PFM_CONTROLLER_N17093812 5BIT_UP_COUNTER_ASYCLR
X_PFM_CONTROLLER_U36          PFM_CONTROLLER_N16565192 I_LO PFM_CONTROLLER_S_I
+  COMP
E_PFM_CONTROLLER_GAIN1         PFM_CONTROLLER_N16930800 0 VALUE {0.2 * V(SW)}
X_PFM_CONTROLLER_U32          FB PFM_CONTROLLER_N110 PFM_CONTROLLER_N166671953
+  PFM_CONTROLLER_N101 COMP_HYS
X_PFM_CONTROLLER_U39         PFM PFM_CONTROLLER_N168931330 INV
X_PFM_CONTROLLER_U46         PFM_CONTROLLER_N16976278 PFM_CONTROLLER_N16974606
+  PFM_CONTROLLER_N16976103 OR2
V_PFM_CONTROLLER_V19         PFM_CONTROLLER_N170827663 0 8mV
X_PFM_CONTROLLER_U42         PFM_SEL PFM_CONTROLLER_S_I LS_ODB AND2
X_PFM_CONTROLLER_U51          PFM_CONTROLLER_N17096352 PFM_CONTROLLER_N17058416
+  PFM_CONTROLLER_N17055089 PFM_CONTROLLER_N17056967 PFM_CONTROLLER_N17094128
+  AND4
C_PFM_CONTROLLER_C15         PFM_CONTROLLER_N16927902 0  20pF  
X_PFM_CONTROLLER_U33         PFM_CONTROLLER_N101 PFM_CONTROLLER_N17126807 INV
V_PFM_CONTROLLER_V14         PFM_CONTROLLER_N110 0 588mV
V_PFM_CONTROLLER_V13         PFM_CONTROLLER_N169163312 0 610mV
X_PFM_CONTROLLER_U38          PFM_CONTROLLER_N16895416 PFM_CONTROLLER_N16927902
+  PFM_CONTROLLER_N17047772 COMP
R_PFM_CONTROLLER_R22         PFM_CONTROLLER_N16895210 PFM_CONTROLLER_N16895416 
+  320k  
V_PFM_CONTROLLER_V12         PFM_CONTROLLER_N169164680 0 600mV
X_PFM_CONTROLLER_U45          FB PFM_CONTROLLER_N169164680
+  PFM_CONTROLLER_N170827663 PFM_CONTROLLER_N16918546 COMP_HYS
R_PFM_CONTROLLER_R21         I_LO_M I_LO  50  
X_PFM_CONTROLLER_U50         PFM_CONTROLLER_N16785798 CLK EN_SS VIN
+  PFM_CONTROLLER_N16974606 M_UN0001 D_FF_ASYCLR
V_PFM_CONTROLLER_V17         PFM_CONTROLLER_N167982113 0 10mV
X_PFM_CONTROLLER_U41         PFM_CONTROLLER_MODE_INV PFM_EN
+  PFM_CONTROLLER_PFM_MODE PFM_SEL AND3
X_PFM_CONTROLLER_U34         PFM_CONTROLLER_N16866999 PFM_CONTROLLER_N16785798
+  PFM_CONTROLLER_PFM_MODE RSFF_RDOM_VAR PARAMS:  T=1 
X_PFM_CONTROLLER_U47         PFM_CONTROLLER_N16918546 PFM_CONTROLLER_N17083043
+  INV
X_PFM_CONTROLLER_U27         PFM_CONTROLLER_N16918667 PFM_CONTROLLER_N17083043
+  PFM_CONTROLLER_N16919300 RSFF_RDOM_VAR PARAMS:  T=5 
s_PFM_CONTROLLER_S6        
+  PFM_CONTROLLER_N16895416,0,PFM_CONTROLLER_N168931330,0, mod_PFM_CONTROLLER_S6 
.model  mod_PFM_CONTROLLER_S6 vswitch (ron=1m)
X_PWM_CONTROLLER_U43          PWM_CONTROLLER_3 PWM_CONTROLLER_4 PWM COMP
V_PWM_CONTROLLER_COMPENSATOR_V1         PWM_CONTROLLER_COMPENSATOR_N8 0 1.12Vdc
s_PWM_CONTROLLER_COMPENSATOR_S1        
+  PWM_CONTROLLER_COMPENSATOR_N8,PWM_CONTROLLER_VC,PFM_SEL,0,
+  mod_PWM_CONTROLLER_COMPENSATOR_S1 
.model  mod_PWM_CONTROLLER_COMPENSATOR_S1 vswitch (ron=1m)
X_PWM_CONTROLLER_COMPENSATOR_U2         EN_SS PWM_CONTROLLER_COMPENSATOR_N12
+  INV
X_PWM_CONTROLLER_COMPENSATOR_U1         PWM_CONTROLLER_COMPENSATOR_N16815911
+  PWM_CONTROLLER_COMPENSATOR_N168158141 INV
s_PWM_CONTROLLER_COMPENSATOR_S3        
+  PWM_CONTROLLER_COMPENSATOR_N7,0,PWM_CONTROLLER_COMPENSATOR_N16815911,0,
+  mod_PWM_CONTROLLER_COMPENSATOR_S3 
.model  mod_PWM_CONTROLLER_COMPENSATOR_S3 vswitch (ron=1m)
E_PWM_CONTROLLER_COMPENSATOR_E1         PWM_CONTROLLER_COMPENSATOR_N3 0 FB
+  PWM_CONTROLLER_COMPENSATOR_N3 1000
R_PWM_CONTROLLER_COMPENSATOR_R8         PWM_CONTROLLER_VC
+  PWM_CONTROLLER_COMPENSATOR_N9  1k  
s_PWM_CONTROLLER_COMPENSATOR_S2        
+  PWM_CONTROLLER_COMPENSATOR_N9,PWM_CONTROLLER_COMPENSATOR_N7,PWM_CONTROLLER_COMPENSATOR_N168158141,0,
+  mod_PWM_CONTROLLER_COMPENSATOR_S2 
.model  mod_PWM_CONTROLLER_COMPENSATOR_S2 vswitch (ron=1m)
s_PWM_CONTROLLER_COMPENSATOR_S4        
+  PWM_CONTROLLER_COMPENSATOR_N11,0,PWM_CONTROLLER_COMPENSATOR_N12,0,
+  mod_PWM_CONTROLLER_COMPENSATOR_S4 
.model  mod_PWM_CONTROLLER_COMPENSATOR_S4 vswitch (ron=1m)
R_PWM_CONTROLLER_COMPENSATOR_R14         PWM_CONTROLLER_COMPENSATOR_N6 0  100k 
+  
R_PWM_CONTROLLER_COMPENSATOR_R13         PWM_CONTROLLER_COMPENSATOR_N7 0  100k 
+  
R_PWM_CONTROLLER_COMPENSATOR_R11         VIN PWM_CONTROLLER_COMPENSATOR_N11 
+  200  
E_PWM_CONTROLLER_COMPENSATOR_E2         PWM_CONTROLLER_COMPENSATOR_N6 0
+  PWM_CONTROLLER_COMPENSATOR_N2 PWM_CONTROLLER_COMPENSATOR_N1 1000
X_PWM_CONTROLLER_COMPENSATOR_U3         PFM_SEL OCP_MODE
+  PWM_CONTROLLER_COMPENSATOR_N16815911 OR2
E_PWM_CONTROLLER_COMPENSATOR_LIMIT1         PWM_CONTROLLER_COMPENSATOR_N7 0
+  VALUE {LIMIT(V(PWM_CONTROLLER_COMPENSATOR_N6),0,10000)}
C_PWM_CONTROLLER_COMPENSATOR_C5         PWM_CONTROLLER_COMPENSATOR_N11 0  1uF  
R_PWM_CONTROLLER_COMPENSATOR_R5         PWM_CONTROLLER_COMPENSATOR_N1
+  PWM_CONTROLLER_COMPENSATOR_N16816168  338  
C_PWM_CONTROLLER_COMPENSATOR_C3         PWM_CONTROLLER_COMPENSATOR_N3
+  PWM_CONTROLLER_COMPENSATOR_N16816168  426pF  
R_PWM_CONTROLLER_COMPENSATOR_R7         PWM_CONTROLLER_COMPENSATOR_N1
+  PWM_CONTROLLER_COMPENSATOR_N3  10k  
D_PWM_CONTROLLER_COMPENSATOR_D2         PWM_CONTROLLER_VC
+  PWM_CONTROLLER_COMPENSATOR_N11 DIODE 
C_PWM_CONTROLLER_COMPENSATOR_C2         PWM_CONTROLLER_COMPENSATOR_N9
+  PWM_CONTROLLER_COMPENSATOR_N1  5pF  
R_PWM_CONTROLLER_COMPENSATOR_R9         0 PWM_CONTROLLER_COMPENSATOR_N9  10k  
C_PWM_CONTROLLER_COMPENSATOR_C4         PWM_CONTROLLER_COMPENSATOR_N9
+  PWM_CONTROLLER_COMPENSATOR_N16815734  149pF  
R_PWM_CONTROLLER_COMPENSATOR_R6         PWM_CONTROLLER_COMPENSATOR_N16815734
+  PWM_CONTROLLER_COMPENSATOR_N1  29.6k  
D_PWM_CONTROLLER_COMPENSATOR_D1         PWM_CONTROLLER_COMPENSATOR_N11 VIN
+  DIODE 
V_PWM_CONTROLLER_COMPENSATOR_V2         PWM_CONTROLLER_COMPENSATOR_N18 0 1.5Vdc
R_PWM_CONTROLLER_COMPENSATOR_R10         PWM_CONTROLLER_COMPENSATOR_N2 VREF_SS 
+  10k  
s_PWM_CONTROLLER_COMPENSATOR_S5        
+  PWM_CONTROLLER_COMPENSATOR_N18,PWM_CONTROLLER_VC,OCP_MODE,0,
+  mod_PWM_CONTROLLER_COMPENSATOR_S5 
.model  mod_PWM_CONTROLLER_COMPENSATOR_S5 vswitch (ron=1m)
X_PWM_CONTROLLER_U44          PWM_CONTROLLER_N16760553 PWM_CONTROLLER_4 CLK
+  COMP
V_PWM_CONTROLLER_V20         PWM_CONTROLLER_N16760553 0 0.1Vdc
E_PWM_CONTROLLER_DIFF1         PWM_CONTROLLER_2 0 VALUE 
+ {V(PWM_CONTROLLER_VC,PWM_CONTROLLER_5)}
E_PWM_CONTROLLER_GAIN2         PWM_CONTROLLER_5 0 VALUE {1/7.2 * V(VIN)}
E_PWM_CONTROLLER_LIMIT3         PWM_CONTROLLER_3 0 VALUE 
+ {LIMIT(V(PWM_CONTROLLER_2),0,0.98)}
V_PWM_CONTROLLER_V19         PWM_CONTROLLER_4 0  
+PULSE 0 1 0 {1/fs-0.2ns} 0.1ns 0.1ns {1/fs}
R_BUCK_CONVERTER_R3         VIN BUCK_CONVERTER_N16769670  1m  
R_BUCK_CONVERTER_R4         BUCK_CONVERTER_N16769542 GND  1m  
D_BUCK_CONVERTER_D_LS1         BUCK_CONVERTER_N16769542
+  BUCK_CONVERTER_N16769584 Dbreak 
s_BUCK_CONVERTER_Q_LS1        
+  BUCK_CONVERTER_N16769584,BUCK_CONVERTER_N16769542,LS,0,
+  mod_BUCK_CONVERTER_Q_LS1 
.model  mod_BUCK_CONVERTER_Q_LS1 vswitch (ron=0.2)
X_BUCK_CONVERTER_H1    BUCK_CONVERTER_N16769584 SW I_LO GND
+  BUCK_CONVERTER_BUCK_CONVERTER_H1 
s_BUCK_CONVERTER_Q_HS1        
+  BUCK_CONVERTER_N16769670,BUCK_CONVERTER_N16769584,HS,0,
+  mod_BUCK_CONVERTER_Q_HS1 
.model  mod_BUCK_CONVERTER_Q_HS1 vswitch (ron=0.4)
D_BUCK_CONVERTER_D_HS1         BUCK_CONVERTER_N16769584
+  BUCK_CONVERTER_N16769670 Dbreak 
X_FAULT_PROTECTION_U20         FAULT_PROTECTION_N16829960
+  FAULT_PROTECTION_N16898198 OCP_MODE RSFF_RDOM_VAR PARAMS:  T=0.001 
X_FAULT_PROTECTION_U17         FAULT_PROTECTION_N16898198
+  FAULT_PROTECTION_N16829960 OCP_GATE RSFF_RDOM_VAR PARAMS:  T=0.001 
V_FAULT_PROTECTION_V5         FAULT_PROTECTION_N16699495 0 0.7Vdc
V_FAULT_PROTECTION_V10         FAULT_PROTECTION_N166976653 0 5mVdc
X_FAULT_PROTECTION_U19         EN_SS FAULT_PROTECTION_UVLO ODB AND2
X_FAULT_PROTECTION_U5          VIN FAULT_PROTECTION_N16902196
+  FAULT_PROTECTION_N169021823 FAULT_PROTECTION_UVLO COMP_HYS
V_FAULT_PROTECTION_V2         FAULT_PROTECTION_N16902196 0 1.9Vdc
X_FAULT_PROTECTION_U18         CLK FAULT_PROTECTION_N16890738
+  FAULT_PROTECTION_N16829960 AND2
V_FAULT_PROTECTION_V3         FAULT_PROTECTION_N169021823 0 0.1Vdc
X_FAULT_PROTECTION_U7          FAULT_PROTECTION_N16705543 I_LO 0
+  FAULT_PROTECTION_N16890738 COMP_HYS
X_FAULT_PROTECTION_U10          I_LO FAULT_PROTECTION_N16699495
+  FAULT_PROTECTION_N166976653 FAULT_PROTECTION_N16898198 COMP_HYS
V_FAULT_PROTECTION_V4         FAULT_PROTECTION_N16705543 0 0.6Vdc
X_SOFT_START_S7    SOFT_START_N2151212 0 SOFT_START_N2153550 0
+  SOFT_START_SOFT_START_S7 
C_SOFT_START_C19         0 SOFT_START_N2174368  1pF  
X_SOFT_START_U48         SOFT_START_N2178745 SOFT_START_N166837351 delay
+  PARAMS: PARAMS:  T=200000
R_SOFT_START_R29         SOFT_START_N166837351 SOFT_START_N2174368  1  
C_SOFT_START_C23         0 EN_SS  1pF  
X_SOFT_START_U51         SOFT_START_N2177380 VREF_GD SOFT_START_N16786693 AND2
R_SOFT_START_R33         SOFT_START_N21949482 EN_SS  1  
C_SOFT_START_C26         0 PFM_EN  1pF  
R_SOFT_START_R36         SOFT_START_N16786693 PFM_EN  1  
V_SOFT_START_V21         SOFT_START_N2153550 SOFT_START_N2151737 0.01Vdc
C_SOFT_START_C21         0 VREF_SS  1pF  
X_SOFT_START_U46          SOFT_START_N2194625 SOFT_START_N2184567 0
+  SOFT_START_N2151212 COMP_HYS
R_SOFT_START_R31         SOFT_START_N2151737 VREF_SS  1  
C_SOFT_START_C17         SOFT_START_N2151737 SOFT_START_N21474191  40nF  
V_SOFT_START_V20         SOFT_START_N2184567 0 0.1Vdc
R_SOFT_START_R26         SOFT_START_N21474191 0  0.1m  
X_SOFT_START_U53          VREF_SS SOFT_START_N2202518 SOFT_START_N22021603
+  SOFT_START_N16785504 COMP_HYS
C_SOFT_START_C20         0 SOFT_START_N2194625  1pF  
R_SOFT_START_R30         SOFT_START_N21566802 SOFT_START_N2194625  1  
D_SOFT_START_U47         SOFT_START_N2151737 0 DIODE 
X_SOFT_START_U50         SOFT_START_N2174368 SOFT_START_N2178745
+  SOFT_START_N21949482 AND2
G_SOFT_START_G1         0 SOFT_START_N2151737 SOFT_START_N2151212 0 100e-6
V_SOFT_START_V22         SOFT_START_N22021603 0 2mVdc
V_SOFT_START_V23         SOFT_START_N2202518 0 588mV
C_SOFT_START_C25         0 SOFT_START_N16787280  1pF  
C_SOFT_START_C22         0 SOFT_START_N2178745  1pF  
X_SOFT_START_U44         SOFT_START_N16787280 SOFT_START_N2178745
+  SOFT_START_N21778712 AND2
R_SOFT_START_R35         ODB SOFT_START_N16787280  1  
R_SOFT_START_R32         EN SOFT_START_N2178745  1  
X_SOFT_START_U45         SOFT_START_N2177380 SOFT_START_N2174368
+  SOFT_START_N21566802 AND2
C_SOFT_START_C18         0 SOFT_START_N2177380  1pF  
C_SOFT_START_C24         0 VREF_GD  1pF  
R_SOFT_START_R28         SOFT_START_N21778712 SOFT_START_N2177380  1  
R_SOFT_START_R34         VREF_GD SOFT_START_N16785504  1  
X_PULSE_LOGIC_U1         PWM OCP_GATE PULSE_LOGIC_N00140 AND2
E_PULSE_LOGIC_ABM3         PULSE_LOGIC_N001661 0 VALUE { IF(V(PFM_SEL)>0.5,
+  V(PFM), V(PULSE_LOGIC_N00140))    }
C_PULSE_LOGIC_C16         0 PULSE  1n  
R_PULSE_LOGIC_R25         PULSE_LOGIC_N001661 PULSE  1  
.PARAM  v_rail=1 fs=2250khz
.ENDS TPS62240_TRANS
*$
.subckt BUCK_CONVERTER_BUCK_CONVERTER_H1 1 2 3 4  
H_BUCK_CONVERTER_H1         3 4 VH_BUCK_CONVERTER_H1 1
VH_BUCK_CONVERTER_H1         1 2 0V
.ends BUCK_CONVERTER_BUCK_CONVERTER_H1
*$
.subckt SOFT_START_SOFT_START_S7 1 2 3 4  
S_SOFT_START_S7         3 4 1 2 _SOFT_START_S7
RS_SOFT_START_S7         1 2 1G
.MODEL         _SOFT_START_S7 VSWITCH Roff=100e6 Ron=500 Voff=1.0V Von=0V
.ends SOFT_START_SOFT_START_S7
*$
.SUBCKT 5BIT_UP_COUNTER_ASYCLR UP CLK CLEAR PRESET Q0 Q1 Q2 Q3 Q4
X_U1         UP CLK CLEAR PRESET Q0 1 T_FF_ASYCLR
X_U2         UP 1 CLEAR PRESET Q1 2 T_FF_ASYCLR
X_U3         UP 2 CLEAR PRESET Q2 3 T_FF_ASYCLR
X_U4         UP 3 CLEAR PRESET Q3 4 T_FF_ASYCLR
X_U5         UP 4 CLEAR PRESET Q4 5 T_FF_ASYCLR
.ENDS
*$
.SUBCKT T_FF_ASYCLR T CLK CLEAR PRESET Q QBAR
R_R27         6 QBAR  1  
X_U2         2 3 1 OR2
X_U3         5 4 2 AND2
C_C19         0 Q  1pF
X_U4         T 6 3 AND2
R_R28         5 Q  1  
X_U5         T 4 INV
X_U6         1 CLK CLEAR PRESET 5 6 D_FF_ASYCLR
C_C18         0 QBAR  1pF
.ENDS
*$
.SUBCKT D_FF_ASYCLR D CLK CLEAR PRESET Q QBAR
X_U2          Q 2 CLEAR 6 NAND3
X_U5          1 CLK 4 2 NAND3
X_U7          PRESET 1 QBAR 5 NAND3
R_R1         5 Q  1  
C_C1         0 Q  1pF  
R_R2         6 QBAR  1  
X_U6          2 D CLEAR 4 NAND3
C_C2         0 QBAR  1pF  
X_U4          3 CLK CLEAR 1 NAND3
X_U3          PRESET 4 1 3 NAND3
.ENDS
*$
.SUBCKT AND4 A B C D OUT  
EOUT OUT 0 VALUE { IF( V(A)>0.5 & V(B)>0.5 & V(C)>0.5 & V(D)>0.5,1,0) }
.ENDS AND4
*$
.SUBCKT NAND A B OUT  
EOUT OUT 0 VALUE { IF( V(A)>0.5 & V(B)>0.5,0,1) }
.ENDS NAND
*$
.SUBCKT NAND3 A B C OUT  
EOUT OUT 0 VALUE { IF( V(A)>0.5 & V(B)>0.5 & V(C)>0.5,0,1) }
.ENDS NAND3
*$
.model Dbreak D Is=1e-14 Cjo=.1pF Rs=.1
*$
.SUBCKT RSFF_RDOM_VAR R S Q PARAMs:  T=10
EABM1  1 0 VALUE { If( V(S)>0.5 | V(Q)>0.5, 1,0)    }
EABM2  Q  0 VALUE { If( V(2)>0.5 & V(R)<0.5, 1,0)    }
R1   1 2 1
C1   2  0 {T*1e-9}
.ENDS RSFF_RDOM_VAR
*$
.SUBCKT DELAY IN OUT
+ PARAMS:  T=100
S_S1         MEAS 0 RESET2 0 S1
E_ABM1         CH 0 VALUE { if( V(IN)>0.5,1,0)    }
E_ABM3         OUT 0 VALUE { if( V(MEAS)>0.5 & V(CH)>0.5,1,0)    }
R_R1         MEAS CH  {T} 
C_C1         0 MEAS  1.4427n  
E_ABM2         RESET 0 VALUE { if(V(CH)<0.5,1,0)    }
R_R2         RESET2 RESET  0.1  
C_C2         0 RESET2  1.4427n  
.MODEL         S1 VSWITCH Roff=1e9 Ron=1.0 Voff=0.25V Von=0.75V
.ENDS DELAY
*$
.SUBCKT COMP INP INM OUT  
EOUT OUT 0 VALUE { IF( V(INP)>V(INM),1,0) }
.ENDS 
*$
.MODEL DIODE D(IS=8e-15 Rs=1m)
*$
.SUBCKT AND3 A B C OUT  
EOUT OUT 0 VALUE { IF( V(A)>0.5 & V(B)>0.5 & V(C)>0.5,1,0) }
.ENDS 
*$
.SUBCKT INV IN O  
EOUT O 0 VALUE { IF( V(IN)<0.5,1,0) }
.ENDS 
*$
.SUBCKT NOR2 A B O  
EOUT O 0 VALUE { IF( V(A)>0.5 | V(B)>0.5,0,1) }
.ENDS
*$
.SUBCKT OR2 A B OUT  
EOUT OUT 0 VALUE { IF( V(A)>0.5 | V(B)>0.5,1,0) }
.ENDS 
*$
.SUBCKT COMP_HYS INP INM HYS OUT PARAMS: V_R = {V_RAIL}
EIN INP1 INM1 INP INM 1 
EHYS INP1 INP2 VALUE { IF( V(1)>0.5,-V(HYS)/2,V(HYS)/2) }
EOUT OUT 0 VALUE { IF( V(INP2)>V(INM1), {V_R} ,0) }
R1 OUT 1 1
C1 1 0 5n
RINP1 INP1 0 1K
.ENDS 
*$
.SUBCKT AND2 A B OUT  
EOUT OUT 0 VALUE { IF( V(A)>0.5 & V(B)>0.5,1,0) }
.ENDS 
*$