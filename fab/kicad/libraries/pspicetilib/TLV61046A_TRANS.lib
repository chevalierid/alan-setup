*$
* TLV61046A
*****************************************************************************
* (C) Copyright 2017 Texas Instruments Incorporated. All rights reserved.                                            
*****************************************************************************
** This model is designed as an aid for customers of Texas Instruments.
** TI and its licensors and suppliers make no warranties, either expressed
** or implied, with respect to this model, including the warranties of 
** merchantability or fitness for a particular purpose.  The model is
** provided solely on an "as is" basis.  The entire risk as to its quality
** and performance is with the customer
*****************************************************************************
*
* This model is subject to change without notice. Texas Instruments
* Incorporated is not responsible for updating this model.
*
*****************************************************************************
*
** Released by: WEBENCH Design Center, Texas Instruments Inc.
* Part: TLV61046A
* Date: 10MAR2017
* Model Type:  TRANSIENT
* Simulator: PSPICE
* Simulator Version: 16.2.0.p001
* EVM Order Number: TLV61046EVM - 833
* EVM Users Guide: NA
* Datasheet: SLVSD82 - JANUARY 2017
*
* Model Version: Final 1.00
*
*****************************************************************************
*
* Updates:
*
* Final 1.00
* Release to Web.
*
*****************************************************************************
*
* Model Usage Notes:
*
* 1. The following features have been modeled
*      a. Switching Characteristics and variation with VIN
*      b. RON and variation with VIN
*      c. Quiescent Current v/s VIN at room temperature
*      d. IIN(OFF) v/s VIN at room temperature
*      e. Reverse Current Protection v/s VIN at room temperature
*      f. ON Threshold and Hysteresis v/s VIN
* 2. Temperature effects are not modeled. 
*
*****************************************************************************
.SUBCKT TLV61046A_TRANS VIN EN GND FB VOUT SW PARAMS: STEADY=0
R_R4         GND FB_INT  71.5k TC=0,0 
R_LOOP_R13         LOOP_N16682818 LOOP_N16682120  160 TC=0,0 
X_LOOP_U61         LOOP_N16682120 LOOP_N16682818 LOOP_N16680180 LOOP_N16688292
+  OR3_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
R_LOOP_R4         0 LOOP_COMP  2100MEG  
C_LOOP_C11         0 LOOP_N16691990  1n  
G_LOOP_ABM2I1         0 LOOP_N16631329 VALUE { {LIMIT(V(VREF,
+  LOOP_INT_FB_TEST)*9.3u, -20u, 20u)}    }
X_LOOP_U32         LOOP_ISW_LSD LOOP_ICTRL LOOP_N16707117 COMP_BASIC_GEN
+  PARAMS: VDD=1 VSS=0 VTHRESH=0.5
R_LOOP_R5         LOOP_COMP_IN SW  600k TC=0,0 
R_LOOP_R10         LOOP_N16639333 LOOP_N16889941  1 TC=0,0 
D_LOOP_D9         LOOP_COMP LOOP_N16885502 D_D1 
R_LOOP_R14         LOOP_N16691990 LOOP_N16691966  210 TC=0,0 
R_LOOP_R9         LOOP_THRESH LOOP_N16634513  2000k TC=0,0 
X_LOOP_U33         LOOP_THRESH LOOP_COMP_IN LOOP_N16635953 COMP_BASIC_GEN
+  PARAMS: VDD=1 VSS=0 VTHRESH=0.5
C_LOOP_C5         LOOP_N16763763 LOOP_COMP  80p  
C_LOOP_C10         0 LOOP_N16682818  1n  
C_LOOP_C6         LOOP_THRESH 0  3p  TC=0,0 
C_LOOP_C9         0 LOOP_ISW_LSD  5n  
X_LOOP_S2    LOOP_LSD_ON 0 LOOP_N16633757 0 LOOP_LOOP_S2 
X_LOOP_U57         EN_CTL LOOP_EN_CTL_BAR INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+  VTHRESH=500E-3
X_LOOP_U60         LOOP_N16635953 LOOP_COMP_OUT BUF_DELAY_BASIC_GEN PARAMS:
+  VDD=1 VSS=0 VTHRESH=0.5 DELAY=25n
D_LOOP_D8         LOOP_N16895502 LOOP_COMP D_D1 
R_LOOP_R15         LOOP_ISW_LSD LOOP_N16917727  10 TC=0,0 
X_LOOP_U48         LOOP_N16680180 LOOP_N16680856 INV_DELAY_BASIC_GEN PARAMS:
+  VDD=1 VSS=0 VTHRESH=0.5 DELAY=20n
X_LOOP_U56         LOOP_N16688292 GATE_N INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+  VTHRESH=500E-3
E_LOOP_ABM11         LOOP_N16912086 0 VALUE { if(V(LOOP_N16913651)>0.5,28.2,29)
+     }
E_LOOP_ABM10         LOOP_INT_FB_TEST 0 VALUE { ( IF (V(INT_TEST) > 0.5 ,
+  V(FB_INT), V(FB)))    }
R_LOOP_R7         0 LOOP_N16633757  100k TC=0,0 
D_LOOP_D5         LOOP_N16682120 LOOP_N16682818 D_D1 
R_LOOP_R8         LOOP_N16634513 LOOP_N16633757  2000k TC=0,0 
X_LOOP_U65         LOOP_N16707117 LOOP_EN_CTL_BAR LOOP_N16792841 LOOP_RES_LAT
+  OR3_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
E_LOOP_ABM3         LOOP_N17027035 0 VALUE { IF (V(VOUT) < 1 & V(START_SW) >
+  0.5, 0.15, LIMIT(-(0.2326*V(VIN)*V(VIN))+(1.1767*V(VIN))-0.5481,0.82,0.95))   
+  }
X_LOOP_U55         LOOP_LSD_TON_MIN LOOP_N16680180 INV_BASIC_GEN PARAMS: VDD=1
+  VSS=0 VTHRESH=500E-3
X_LOOP_U35         VOUT LOOP_N16912086 OVP COMP_BASIC_GEN PARAMS: VDD=1 VSS=0
+  VTHRESH=0.5
X_LOOP_U66         PRE_SS LOOP_N16792356 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+  VTHRESH=500E-3
C_LOOP_C8         0 LOOP_ICTRL  5n  
X_LOOP_U37         LOOP_LSD_ON LOOP_EN_CTL_BAR START_SW N17016622
+  SRLATCHRHP_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=0.5
X_LOOP_S1    LOOP_LSD_ON 0 LOOP_COMP_IN 0 LOOP_LOOP_S1 
V_LOOP_V8         LOOP_COMP LOOP_N16631329 0Vdc
X_LOOP_U63         LOOP_N16691966 LOOP_N16691990 LOOP_LSD_ON LOOP_LSD_TON_MIN
+  OR3_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
R_LOOP_R30         OVP LOOP_N16913651  10 TC=0,0 
C_LOOP_C7         0 LOOP_N16639333  133n  
E_LOOP_ABM1         LOOP_N16641040 0 VALUE { MIN(((V(LOOP_COMP) - 0.2)/1.4 +
+  0.14), V(LOOP_VAL_CUR_LIM))    }
X_LOOP_U36         LOOP_SET_LAT LOOP_RES_LAT LOOP_LSD_ON LOOP_GATE_BAR
+  SRLATCHRHP_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=0.5
R_LOOP_R6         LOOP_N16633757 SW  900k TC=0,0 
X_LOOP_U52         LOOP_N16680856 LOOP_N16680180 LOOP_N16682120 AND2_BASIC_GEN
+  PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
C_LOOP_C27         LOOP_N16913651 0  1n  TC=0,0 
R_LOOP_R16         LOOP_VAL_CUR_LIM LOOP_N17027035  10 TC=0,0 
R_LOOP_R12         0 LOOP_N16763763  1.2MEG  
R_LOOP_R11         LOOP_ICTRL LOOP_N16641040  10 TC=0,0 
X_LOOP_U67         OVP PFM_DETECT LOOP_N16792356 LOOP_N16792841 OR3_BASIC_GEN
+  PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
E_LOOP_ABM2         LOOP_N16889941 0 VALUE { V(LOOP_LSD_ON)    }
X_LOOP_U49         LOOP_LSD_ON LOOP_N16692190 INV_DELAY_BASIC_GEN PARAMS: VDD=1
+  VSS=0 VTHRESH=0.5 DELAY=20n
C_LOOP_C12         0 LOOP_VAL_CUR_LIM  1n  
C_LOOP_C3         LOOP_COMP_IN 0  15p  TC=0,0 
X_LOOP_U62         LOOP_N16692190 LOOP_LSD_ON LOOP_N16691966 AND2_BASIC_GEN
+  PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
C_LOOP_C4         LOOP_N16634513 0  3p  TC=0,0 
E_LOOP_ABM9         LOOP_N16917727 0 VALUE { ( IF (V(LOOP_N16639333) > 0.5 ,
+  V(ISENSE_N), 0))    }
V_LOOP_V9         LOOP_N16885502 0 1.7
D_LOOP_D7         LOOP_N16691966 LOOP_N16691990 D_D1 
X_LOOP_U54         LOOP_COMP_OUT LOOP_SET_LAT INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+  VTHRESH=500E-3
V_LOOP_V10         LOOP_N16895502 0 0.26
X_S2    TESTER GND VOUT N65324 TLV61046A_S2 
E_ABM7         INT_TEST 0 VALUE { IF (V(VIN) > V(FB), 0, 1)    }
R_R3         FB_INT N65324  1000k TC=0,0 
E_ABM6         TESTER 0 VALUE { IF ( V(EN_CTL)  > 0.5 & V(INT_TEST) > 0.5, 1,
+  0)    }
E_PFM_CONTROL_ABM3         PFM_CONTROL_N20363 0 VALUE { IF(
+  V(PFM_CONTROL_N13643) > 0.63, 1, 0)    }
X_PFM_CONTROL_U122         PFM_CONTROL_PFM_END GND PFM_CONTROL_N00986
+  OR2_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
R_PFM_CONTROL_R2         PFM_CONTROL_N16233 PFM_CONTROL_N16193  1k TC=0,0 
C_PFM_CONTROL_C6         0 PFM_CONTROL_N16193  5n IC=0 
E_PFM_CONTROL_ABM2         PFM_CONTROL_N18764 0 VALUE { IF ( V(PFM_CONTROL_VFB)
+  < 1.01*V(VREF), 1, 0)    }
E_PFM_CONTROL_ABM10         PFM_CONTROL_VFB 0 VALUE { ( IF (V(INT_TEST) > 0.5 ,
+  V(FB_INT), V(FB)))    }
X_PFM_CONTROL_U615         PFM_CONTROL_VFB_GT_VREF PFM_CONTROL_PFM_DETECT_BAR
+  PFM_CONTROL_N15079 AND2_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
C_PFM_CONTROL_C9         0 PFM_CONTROL_PFM_BEGIN  1n IC=0 
E_PFM_CONTROL_ABM4         PFM_CONTROL_N20875 0 VALUE { IF(
+  V(PFM_CONTROL_N16193) > 0.63, 1, 0)    }
C_PFM_CONTROL_C5         0 PFM_CONTROL_N13643  5n IC=0 
R_PFM_CONTROL_R6         PFM_CONTROL_N20875 PFM_CONTROL_PFM_END  10 TC=0,0 
C_PFM_CONTROL_C10         0 PFM_CONTROL_PFM_END  1n IC=0 
R_PFM_CONTROL_R3         PFM_CONTROL_N17990 PFM_CONTROL_VFB_GT_VREF  10 TC=0,0 
R_PFM_CONTROL_R1         PFM_CONTROL_N15079 PFM_CONTROL_N13643  1k TC=0,0 
E_PFM_CONTROL_ABM1         PFM_CONTROL_N17990 0 VALUE { IF ( V(PFM_CONTROL_VFB)
+  > 1.01*V(VREF), 1, 0)    }
R_PFM_CONTROL_R4         PFM_CONTROL_N18764 PFM_CONTROL_VFB_LT_VREF  10 TC=0,0 
X_PFM_CONTROL_U614         PFM_CONTROL_VFB_LT_VREF PFM_DETECT
+  PFM_CONTROL_N16233 AND2_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
C_PFM_CONTROL_C8         0 PFM_CONTROL_VFB_LT_VREF  1n IC=0 
X_PFM_CONTROL_U119         PFM_CONTROL_PFM_BEGIN PFM_CONTROL_N00986 PFM_DETECT
+  PFM_CONTROL_PFM_DETECT_BAR SRLATCHRHP_BASIC_GEN PARAMS: VDD=1 VSS=0
+  VTHRESH=0.5
R_PFM_CONTROL_R5         PFM_CONTROL_N20363 PFM_CONTROL_PFM_BEGIN  10 TC=0,0 
C_PFM_CONTROL_C7         0 PFM_CONTROL_VFB_GT_VREF  1n IC=0 
X_U1_U2         EN U1_N00637 U1_N073550 U1_EN_OK COMPHYS_BASIC_GEN PARAMS:
+  VDD=1 VSS=0 VTHRESH=0.5 T=10
V_U1_V4         U1_N00637 0 1.0
X_U1_U3         U1_VIN_OK U1_EN_OK EN_CTL AND2_BASIC_GEN PARAMS: VDD=1 VSS=0
+  VTHRESH=500E-3
X_U1_U1         VIN U1_N00226 U1_N075853 U1_VIN_OK COMPHYS_BASIC_GEN PARAMS:
+  VDD=1 VSS=0 VTHRESH=0.5 T=10
V_U1_V5         U1_N073550 0 0.6
V_U1_V3         U1_N075853 0 200m
V_U1_V2         U1_N00226 0 1.75
E_U2_ABM5         U2_BG 0 VALUE { if( V(EN_CTL)>0.5,0.800,0)    }
E_U2_E2         U2_N16745403 0 VIN 0 0.5
D_U2_D4         U2_VREF_FEED U2_N16746214 D_D1 
V_U2_V2         U2_N16746214 0 0.075
E_U2_E1         VREF U2_N16744571 U2_VREF_INT 0 1
D_U2_D2         U2_SS VIN D_D1 
G_U2_ABM2I1         VIN U2_SS VALUE { if(V(EN_CTL) >0.5 & V(PRE_SS) > 0.6,
+  V(U2_SS_CUR_SRC),0)    }
C_U2_C3         U2_SS 0  18.75p IC=0 TC=0,0 
R_U2_R1         0 U2_VREF_FEED  1k TC=0,0 
E_U2_ABM6         U2_N16744571 0 VALUE { if( V(U2_VREF_INT)>0.79,
+  V(U2_VREF_FEED),0)    }
C_U2_C4         U2_N16745403 U2_VREF_FEED  0.1n IC=0 TC=0,0 
V_U2_V1         U2_N16747625 0 0.025
E_U2_ABM7         U2_SS_CUR_SRC 0 VALUE { IF ( {STEADY} < 1, 3n, 100u)    }
D_U2_D3         U2_N16747625 U2_VREF_FEED D_D1 
E_U2_ABM2         U2_VREF_INT 0 VALUE { if( V(U2_SS)>V(U2_BG),
+  V(U2_BG),V(U2_SS))    }
C_U4_C12         U4_N16912393 0  50u  TC=0,0 
E_U4_ABM8         U4_N169123991 0 VALUE { V(EN_CTL)    }
X_U4_H1    U4_N00219 0 U4_N16916644 0 DRIVER_U4_H1 
R_U4_R18         U4_N17013619 U4_N17013637  10 TC=0,0 
R_U4_R15         U4_N16967912 0  250 TC=0,0 
X_U4_S6    U4_SHORT_PULSE 0 VO U4_N17002565 DRIVER_U4_S6 
X_U4_S3    U4_N16834226 0 VO U4_N24146 DRIVER_U4_S3 
E_U4_ABM5         U4_N16834224 0 VALUE { if(V(EN_CTL)>0.5 & V(U4_SHORT_PULSE) <
+  2.5 ,1,0)    }
E_U4_ABM7         U4_N17006595 0 VALUE { IF (V(VOUT)<1 & V(START_SW) > 0.5
+  ,5,0)    }
R_U4_R14         U4_SHORT U4_N17006595  1 TC=0,0 
R_U4_R9         U4_N16750328 ISENSE_P  5 TC=0,0 
X_U4_S1    GATE_N 0 SW U4_N00219 DRIVER_U4_S1 
X_U4_U7         VOUT U4_N24200 U4_CUR_LIM_VAR CURRENT_LIMIT_PROG PARAMS: 
+  IMIN=0 ROUT=1
X_U4_S2    U4_N16908596 0 U4_N24200 VOUT DRIVER_U4_S2 
V_U4_V8         VO U4_N16921664 0Vdc
X_U4_S5    U4_SHORT_PULSE 0 VOUT U4_N16995902 DRIVER_U4_S5 
C_U4_C3         ISENSE_N 0  1n  TC=0,0 
X_U4_U4         U4_P_SS_BAR U4_N16808424 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+  VTHRESH=500E-3
E_U4_ABM6         U4_N16954870 0 VALUE { IF ( V(EN_CTL)  > 0.5 &
+  V(U4_N16932864) < 0.63 & {STEADY} < 1, 1, 0)    }
R_U4_R10         U4_N16916644 ISENSE_N  5 TC=0,0 
E_U4_ABM15         U4_N17023435 0 VALUE { IF ( V(U4_SHORT)  > 2.5 &
+  V(U4_SHORT_EXIT) < 2.5, 5, 0)    }
R_U4_R21         U4_SHORT_EXIT U4_N17017257  1 TC=0,0 
E_U4_ABM10         U4_N16915680 0 VALUE { IF ( V(EN_CTL)  > 0.5 &
+  V(U4_N16912393) < 0.63 & {STEADY} < 1, 1, 0)    }
R_U4_R17         U4_N16808424 PRE_SS  10 TC=0,0 
R_U4_R13         U4_P_SS_BAR U4_N16915680  10 TC=0,0 
C_U4_C10         PRE_SS 0  1n  TC=0,0 
R_U4_R11         U4_N16834226 U4_N16834224  1 TC=0,0 
D_U4_D5         U4_N16990504 U4_N16967912 D_D1 
C_U4_C13         0 U4_P_SS_BAR  1n  
C_U4_C8         0 U4_N16834226  1n  
E_U4_ABM14         U4_N17017257 0 VALUE { IF ( V(U4_N17013619)  > 0.5 & V(VOUT)
+  > 100p, 5, 0)    }
E_U4_ABM12         U4_N16967912 0 VALUE { V(VIN)-0.10    }
X_U4_S4    U4_SHORT_PULSE 0 VIN U4_N16990504 DRIVER_U4_S4 
D_U4_D6         U4_N16995902 U4_N16967912 D_D1 
X_U4_U5         U4_N16954620 U4_N16908596 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+  VTHRESH=500E-3
R_U4_R16         U4_N17002565 U4_N16967912  5 TC=0,0 
D_U4_D1         SW U4_N16921664 D_D1 
R_U4_R22         U4_SHORT_PULSE U4_N17023435  1 TC=0,0 
C_U4_C9         0 U4_N16954620  1n  
C_U4_C17         0 U4_SHORT_PULSE  1n  
C_U4_C11         0 U4_SHORT  1n  
C_U4_C2         ISENSE_P 0  1n  TC=0,0 
X_U4_H2    U4_N24146 U4_N24200 U4_N16750328 0 DRIVER_U4_H2 
R_U4_R12         U4_N16954620 U4_N16954870  10 TC=0,0 
C_U4_C16         0 U4_SHORT_EXIT  1n  
R_U4_R20         U4_N169328701 U4_N16932864  40 TC=0,0 
E_U4_ABM9         U4_CUR_LIM_VAR 0 VALUE { IF (V(U4_N16912393) < 0.63, 30m,
+  95m)    }
C_U4_C15         0 U4_N17013619  0.5u  
R_U4_R19         U4_N169123991 U4_N16912393  40 TC=0,0 
D_U4_D4         U4_N00219 SW D_D1 
C_U4_C14         U4_N16932864 0  50u  TC=0,0 
E_U4_ABM13         U4_N17013637 0 VALUE { IF (V(U4_SHORT) > 2.5 ,1,0)    }
E_U4_ABM11         U4_N169328701 0 VALUE { V(EN_CTL)    }
.ENDS TLV61046A_TRANS
*$
.subckt LOOP_LOOP_S2 1 2 3 4  
S_LOOP_S2         3 4 1 2 _LOOP_S2
RS_LOOP_S2         1 2 1G
.MODEL         _LOOP_S2 VSWITCH Roff=1e9 Ron=0.001 Voff=0.45V Von=0.55V
.ends LOOP_LOOP_S2
*$
.subckt LOOP_LOOP_S1 1 2 3 4  
S_LOOP_S1         3 4 1 2 _LOOP_S1
RS_LOOP_S1         1 2 1G
.MODEL         _LOOP_S1 VSWITCH Roff=1e9 Ron=0.001 Voff=0.45V Von=0.55V
.ends LOOP_LOOP_S1
*$
.subckt TLV61046A_S2 1 2 3 4  
S_S2         3 4 1 2 _S2
RS_S2         1 2 1G
.MODEL         _S2 VSWITCH Roff=1e10 Ron=0.001 Voff=0.2V Von=0.8V
.ends TLV61046A_S2
*$
.subckt DRIVER_U4_H1 1 2 3 4  
H_U4_H1         3 4 VH_U4_H1 1
VH_U4_H1         1 2 0V
.ends DRIVER_U4_H1
*$
.subckt DRIVER_U4_S6 1 2 3 4  
S_U4_S6         3 4 1 2 _U4_S6
RS_U4_S6         1 2 1G
.MODEL         _U4_S6 VSWITCH Roff=1e9 Ron=0.01 Voff=0.2 Von=0.8
.ends DRIVER_U4_S6
*$
.subckt DRIVER_U4_S3 1 2 3 4  
S_U4_S3         3 4 1 2 _U4_S3
RS_U4_S3         1 2 1G
.MODEL         _U4_S3 VSWITCH Roff=1e9 Ron=0.85 Voff=0.5V Von=0.51V
.ends DRIVER_U4_S3
*$
.subckt DRIVER_U4_S1 1 2 3 4  
S_U4_S1         3 4 1 2 _U4_S1
RS_U4_S1         1 2 1G
.MODEL         _U4_S1 VSWITCH Roff=1e9 Ron=0.450 Voff=0.5V Von=0.51V
.ends DRIVER_U4_S1
*$
.subckt DRIVER_U4_S2 1 2 3 4  
S_U4_S2         3 4 1 2 _U4_S2
RS_U4_S2         1 2 1G
.MODEL         _U4_S2 VSWITCH Roff=1e9 Ron=0.001 Voff=0.5V Von=0.51V
.ends DRIVER_U4_S2
*$
.subckt DRIVER_U4_S5 1 2 3 4  
S_U4_S5         3 4 1 2 _U4_S5
RS_U4_S5         1 2 1G
.MODEL         _U4_S5 VSWITCH Roff=1e9 Ron=0.01 Voff=0.2 Von=0.8
.ends DRIVER_U4_S5
*$
.subckt DRIVER_U4_S4 1 2 3 4  
S_U4_S4         3 4 1 2 _U4_S4
RS_U4_S4         1 2 1G
.MODEL         _U4_S4 VSWITCH Roff=1e9 Ron=0.01 Voff=0.2 Von=0.8
.ends DRIVER_U4_S4
*$
.subckt DRIVER_U4_H2 1 2 3 4  
H_U4_H2         3 4 VH_U4_H2 1
VH_U4_H2         1 2 0V
.ends DRIVER_U4_H2
*$
.model D_D1 d
+ is=1e-015
+ tt=1e-011
+ rs=0.05
+ n=0.1
*$
.SUBCKT current_limit_prog out vin lim PARAMS: 
+  imin = -10m 
+  rout =  10m
E1 vyy   0 VALUE = {LIMIT(V(vin), V(out)+imin*rout, V(out)+V(lim)*rout)}
R1 vyy vzz { rout }
F1 vin vyy V1 1
V1 vzz out 0V
.ENDS current_limit_prog
*$
.SUBCKT AND2_BASIC_GEN A B Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5 
E_ABMGATE    YINT 0 VALUE {{IF(V(A) > {VTHRESH}  &  
+ V(B) > {VTHRESH},{VDD},{VSS})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS AND2_BASIC_GEN
*$
.SUBCKT AND3_BASIC_GEN A B C Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5 
E_ABMGATE    YINT 0 VALUE {{IF(V(A) > {VTHRESH}  &  
+ V(B) > {VTHRESH} &
+ V(C) > {VTHRESH},{VDD},{VSS})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS AND3_BASIC_GEN
*$
.SUBCKT COMP_BASIC_GEN INP INM Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5	
E_ABM Yint 0 VALUE {IF (V(INP) > 
+ V(INM), {VDD},{VSS})}
R1 Yint Y 1
C1 Y 0 1n
.ENDS COMP_BASIC_GEN
*$
.SUBCKT COMPHYS_BASIC_GEN INP INM HYS OUT PARAMS: VDD=1 VSS=0 VTHRESH=0.5	
EIN INP1 INM1 INP INM 1 
EHYS INP1 INP2 VALUE { IF( V(1) > {VTHRESH},-V(HYS),0) }
EOUT OUT 0 VALUE { IF( V(INP2)>V(INM1), {VDD} ,{VSS}) }
R1 OUT 1 1
C1 1 0 5n
RINP1 INP1 0 1K
.ENDS COMPHYS_BASIC_GEN
*$
.SUBCKT COMPHYS2_BASIC_GEN INP INM HYS OUT PARAMS: VDD=1 VSS=0 VTHRESH=0.5	
+ T=10
EIN INP1 INM1 INP INM 1 
EHYS INM2 INM1 VALUE { IF( V(1) > {VTHRESH},-V(HYS)/2,V(HYS)/2) }
EOUT OUT 0 VALUE { IF( V(INP1)>V(INM2), {VDD} ,{VSS}) }
R1 OUT 1 1
C1 1 0 {T*1e-9}
RINP1 INP1 0 10K
RINM2 INM2 0 10K
.ENDS COMPHYS2_BASIC_GEN
*$
.SUBCKT OP_AMP P M OUT 
+ PARAMs:  Hlimit=5 Rin=10Meg BW=18Meg DC_Gain=100 Rout=100 Llimit=0 SRP=1 SRM=1
R_Rin         P M  {Rin}
E_E1          5 0 M P {-Gain}
E_LIMIT2      6 0 VALUE {LIMIT(V(5), {-Abs(SRM)*Ca*1Meg+V(1)/Ra},
+                 {SRP*Ca*1Meg+V(1)/Ra})}
G_G2          1 0 6 0 -1
R_Ra          0 1  {Ra} 
C_Ca          0 1  {Ca}   
E_LIMIT1      2 0 VALUE {LIMIT(V(1),{Llimit},{Hlimit})}
V_VL          3 0 {Llimit+200m}
V_VH          4 0 {Hlimit-200m}
D_D1          3 1 Dideal 
D_D2          1 4 Dideal 
R_Rout        OUT 2  {Rout}
.model Dideal D Is=1e-10 Cjo=.01pF Rs=1m  N=1
.PARAM  Ra=1k   Ca={exp(DC_gain*log(10)/20)/(2*3.14159*BW*Ra)} 
+ Gain={exp(DC_gain*log(10)/20)/Ra} 
.ENDS OP_AMP
*$
.subckt SWHYSTE NodeMinus NodePlus Plus Minus PARAMS: RON=1 
+ ROFF=1MEG VT=5 VH=2
S5 NodePlus NodeMinus 8 0 smoothSW
EBcrtl 8 0 Value = { IF ( V(plus)-V(minus) > V(ref), 1, 0 ) }
EBref ref1 0 Value = { IF ( V(8) > 0.5, {VT-VH}, {VT+VH} ) }
Rdel ref1 ref 100
Cdel ref 0 100p  IC={VT+VH}
Rconv1 8 0 10Meg
Rconv2 plus 0 10Meg
Rconv3 minus 0 10Meg
.model smoothSW VSWITCH (RON={RON} ROFF={ROFF} VON=1 VOFF=0)
.ends SWHYSTE
*$
.SUBCKT OR2_BASIC_GEN A B Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5 
E_ABMGATE    YINT 0 VALUE {{IF(V(A) > {VTHRESH}  |  
+ V(B) > {VTHRESH},{VDD},{VSS})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS OR2_BASIC_GEN
*$
.SUBCKT OR3_BASIC_GEN A B C Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5 
E_ABMGATE    YINT 0 VALUE {{IF(V(A) > {VTHRESH}  |  
+ V(B) > {VTHRESH} |
+ V(C) > {VTHRESH},{VDD},{VSS})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS OR3_BASIC_GEN
*$
.SUBCKT INV_BASIC_GEN A  Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5 
E_ABMGATE    YINT 0 VALUE {{IF(V(A) > {VTHRESH} , 
+ {VSS},{VDD})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS INV_BASIC_GEN
*$
.SUBCKT INV_DELAY_BASIC_GEN A  Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5 DELAY = 10n 
E_ABMGATE1    YINT1 0 VALUE {{IF(V(A) > {VTHRESH} , 
+ {VDD},{VSS})}}
RINT YINT1 YINT2 1
CINT YINT2 0 {DELAY*1.3}
E_ABMGATE2    YINT3 0 VALUE {{IF(V(YINT2) > {VTHRESH} , 
+ {VSS},{VDD})}}
RINT2 YINT3 Y 1
CINT2 Y 0 1n
.ENDS INV_DELAY_BASIC_GEN
*$
.SUBCKT BUF_DELAY_BASIC_GEN A  Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5 DELAY = 10n 
E_ABMGATE1    YINT1 0 VALUE {{IF(V(A) > {VTHRESH} , 
+ {VDD},{VSS})}}
RINT YINT1 YINT2 1
CINT YINT2 0 {DELAY*1.3}
E_ABMGATE2    YINT3 0 VALUE {{IF(V(YINT2) > {VTHRESH} , 
+ {VDD},{VSS})}}
RINT2 YINT3 Y 1
CINT2 Y 0 1n
.ENDS BUF_DELAY_BASIC_GEN
*$
.SUBCKT BUF_BASIC_GEN A  Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5 
E_ABMGATE    YINT 0 VALUE {{IF(V(A) > {VTHRESH} , 
+ {VDD},{VSS})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS BUF_BASIC_GEN
*$
.SUBCKT SRLATCHSHP_BASIC_GEN S R Q QB PARAMS: VDD=1 VSS=0 VTHRESH=0.5 
GQ 0 Qint VALUE = {IF(V(S) > {VTHRESH},5,IF(V(R)>{VTHRESH},-5, 0))}
CQint Qint 0 1n
RQint Qint 0 1000MEG
D_D10 Qint MY5 D_D1
V1 MY5 0 {VDD}
D_D11 MYVSS Qint D_D1
V2 MYVSS 0 {VSS} 
EQ Qqq 0 Qint 0 1
X3 Qqq Qqqd1 BUF_BASIC_GEN PARAMS: VDD={VDD} VSS={VSS} VTHRESH={VTHRESH}
RQq Qqqd1 Q 1
EQb Qbr 0 VALUE = {IF( V(Q) > {VTHRESH}, {VSS},{VDD})}
RQb Qbr QB 1 
Cdummy1 Q 0 1n 
Cdummy2 QB 0 1n 
.IC V(Qint) {VSS}
.ENDS SRLATCHSHP_BASIC_GEN
*$
.SUBCKT SRLATCHRHP_BASIC_GEN2 S R Q QB PARAMS: VDD=1 VSS=0 VTHRESH=0.5 
GQ 0 Qint VALUE = {IF(V(R) > {VTHRESH},-5,IF(V(S)>{VTHRESH},5, 0))}
CQint Qint 0 1n
RQint Qint 0 1000MEG
D_D10 Qint MY5 D_D1
V1 MY5 0 {VDD}
D_D11 MYVSS Qint D_D1
V2 MYVSS 0 {VSS} 
EQ Qqq 0 Qint 0 1
X3 Qqq Qqqd1 BUF_BASIC_GEN PARAMS: VDD={VDD} VSS={VSS} VTHRESH={VTHRESH}
RQq Qqqd1 Q 1
EQb Qbr 0 VALUE = {IF( V(Q) > {VTHRESH}, {VSS},{VDD})}
RQb Qbr QB 1 
Cdummy1 Q 0 1n 
Cdummy2 QB 0 1n
.IC V(Qint) {VSS}
.ENDS SRLATCHRHP_BASIC_GEN2
*$
.SUBCKT SRLATCHRHP_BASIC_GEN S R Q QB PARAMS: VDD=1 VSS=0 VTHRESH=0.5
X_NOR1 R QB Q1 NOR2_BASIC_GEN PARAMS: VDD={VDD} VSS={VSS} VTHRESH={VTHRESH}
R_8242 Q1 Q 1
C_8242 Q 0 1n IC=0
X_NOR2 S1 Q QB1 NOR2_BASIC_GEN PARAMS: VDD={VDD} VSS={VSS} VTHRESH={VTHRESH}
R_6252 QB1 QB 1
C_6252 QB 0 1n
E_RHP S1 0 VALUE = {IF((V(S)>{VTHRESH} & V(R)>{VTHRESH}),{VSS},V(S))}
.ENDS SRLATCHRHP_BASIC_GEN
*$
.SUBCKT NOR2_BASIC_GEN A B Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5 
E_ABMGATE    YINT 0 VALUE {{IF(V(A) > {VTHRESH}  |  
+ V(B) > {VTHRESH},{VSS},{VDD})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS NOR2_BASIC_GEN
*$
.SUBCKT LDCR IN OUT
+ PARAMs:  L=1u DCR=0.01 IC=0
L	IN 1  {L} IC={IC}
RDCR	1 OUT {DCR}
.ENDS LDCR
*$
.SUBCKT CESR IN OUT
+ PARAMs:  C=100u ESR=0.01 IC=0 X=2
C	IN 1  {C*X} IC={IC}
RESR	1 OUT {ESR/X}
.ENDS CESR
*$