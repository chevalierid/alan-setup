* BUF802 - Rev. A
* Created by Sean Cashin; 2021-05-03
* Created with Green-Williams-Lis Current Sense Amp Macro-model Architecture
* Copyright 2021 by Texas Instruments Corporation
******************************************************
* MACRO-MODEL SIMULATED PARAMETERS:
******************************************************
* AC PARAMETERS
**********************
* CLOSED-LOOP OUTPUT IMPEDANCE VS. FREQUENCY (Zout vs. Freq.)
* CLOSED-LOOP GAIN AND PHASE VS. FREQUENCY  WITH RL, CL EFFECTS (Acl vs. Freq.)
* COMMON-MODE REJECTION RATIO VS. FREQUENCY (CMRR vs. Freq.)
* POWER SUPPLY REJECTION RATIO VS. FREQUENCY (PSRR vs. Freq.)
* INPUT VOLTAGE NOISE DENSITY VS. FREQUENCY (en vs. Freq.)
**********************
* DC PARAMETERS
**********************
* INPUT COMMON-MODE VOLTAGE RANGE (Vcm)
* GAIN ERROR (Eg)
* INPUT BIAS CURRENT VS. INPUT COMMON-MODE VOLTAGE (Ib vs. Vcm)
* INPUT OFFSET VOLTAGE VS. TEMPERATURE (Vos vs. Temp)
* OUTPUT VOLTAGE SWING vs. OUTPUT CURRENT (Vout vs. Iout)
* SHORT-CIRCUIT OUTPUT CURRENT (Isc)
* QUIESCENT CURRENT (Iq)
**********************
* TRANSIENT PARAMETERS
**********************
* SLEW RATE (SR)
* SETTLING TIME VS. CAPACITIVE LOAD (ts)
* OVERLOAD RECOVERY TIME (tor)
******************************************************
.subckt BUF802 IN+ OUT VCC VEE CLH CLL In_Bias In_Aux TempC
******************************************************
.MODEL R_NOISELESS RES (T_ABS=-273.15)
C_C10         MID N1150509  1E-15   
C_C11         N1151229 MID  1E-15   
C_C2         N1150861 N1150135  88E-12   
C_C3         N1150173 PSRRN  177E-15   
C_C33         N1154507 0  1E-15   
C_C34         N1154335 0  1   
C_C35         N1154545 0  1E-15   
C_C40         N1150153 N1150163  1.6E-12   
C_C41         N1150203 PSRRP  16E-15   
C_C42         N1150979 N1150233  207E-12   
C_C43         MID SR_CLAMP  89P   
C_C47         N1150223 N1150213  530E-15   
C_C48         MID SR_CLAMP  85P   
C_C49         MID N1161273  17P   
C_C6         MID N1152577  25P   
C_C7         POSTCLAMP MID  1E-15   
C_C8         MID N1149829  1E-15   
C_C9         MID N1151169  1E-15   
C_C_CMP1         ESDP MID  2.4E-12   
C_C_CMP2         MID IN_BIAS  250E-15   
C_C_VIMON         MID VIMON  1E-10   
C_C_VOUT_S         MID VOUT_S  1E-10   
E_E10         N1152909 N1152885 TEMPC N1195365 685E-6
E_E11         N1162833 MID ESDP MID 1
E_E3         N1153973 MID OUT MID 1
E_E6         MID 0 N1154335 0 1
E_E7         85C_AOLOUT MID N1152577 MID 1
E_E8         27C_AOLOUT MID N1161273 MID 0.984
E_E9         TEMPS MID N1193390 0 0.2
G_G18         N1152553 MID SR_CLAMP MID -1.19
G_G3         N1150251 MID VCC_B MID -1
G_G36         VCC_B 0 VCC 0 -1
G_G37         VEE_B 0 VEE 0 -1
G_G4         N1150153 MID N1150135 MID -1
G_G5         N1150173 MID N1150163 MID -3.8
G_G6         PRECLAMP N1151739 PSRRP PSRRN -1E-3
G_G60         N1150117 MID VEE_B MID -1
G_G61         N1150203 MID N1150213 MID -5
G_G62         N1150223 MID N1150233 MID -0.45
G_G63         N1161249 MID SR_CLAMP MID -1.085
G_G64         VCC_B JFET_SOURCE N1162833 JFET_SOURCE -11E-3
G_G65         N1162997 MID JFET_SOURCE MID -0.99
G_G66         JFET_SOURCE N1163181 IN_AUX N1163181 2.5E-3
G_G67         VCC VEE TEMPC 0 -11.5e-6
G_G68         ESDP MID N1198690 0 1
G_G8         VCC_CLP MID N1149829 MID -1E-3
G_G9         VEE_CLP MID N1151169 MID -1E-3
I_I_BAUX         IN_AUX N1163181 DC 10E-6  
I_I_BAUX1         0 N1198690 DC 1  
I_I_Q         VCC VEE DC 0.0343  
L_L1         N1152553 N1152577  100P  
L_L3         N1161249 N1161273  100P  
L_L4         N1163907 N1163915  10UH  
L_L5         N1162815 ESDP  978E-12  
R_R1         N1162815 IN+ R_NOISELESS 10E-3
R_R107         VCC_B 0 R_NOISELESS 1
R_R108         N1154335 0 R_NOISELESS 1E12
R_R109         VEE_B 0 R_NOISELESS 1
R_R110         VCC_B N1154507 R_NOISELESS 1E-3
R_R111         N1154507 N1154335 R_NOISELESS 1E6
R_R112         N1154335 N1154545 R_NOISELESS 1E6
R_R113         N1154545 VEE_B R_NOISELESS 1E-3
R_R155         VCC VEE R_NOISELESS 180K
R_R159         N1152553 MID R_NOISELESS 1
R_R160         N1152577 MID R_NOISELESS 4
R_R168         N1150153 N1150163 R_NOISELESS 10K
R_R169         N1150173 PSRRN R_NOISELESS 10K
R_R170         N1150203 PSRRP R_NOISELESS 10K
R_R171         PSRRP MID R_NOISELESS 5000
R_R173         CLAW_CLAMP MID R_NOISELESS 1
R_R182         N1150223 N1150213 R_NOISELESS 10K
R_R183         N1150213 MID R_NOISELESS 309.3
R_R184         N1153311 N1153317 R_NOISELESS 10E3
R_R186         VEE_B CLL R_NOISELESS 1E9
R_R187         N1152443 N1152233 R_NOISELESS 10E3
R_R188         VCC_B CLH R_NOISELESS 1E9
R_R194         N1161183 MID R_NOISELESS 1
R_R195         N1161249 MID R_NOISELESS 1
R_R196         N1161273 MID R_NOISELESS 9.9
R_R197         JFET_SOURCE N1162833 R_NOISELESS 33E6
R_R198         VCC_B JFET_SOURCE R_NOISELESS 7.1E3
R_R199         IN_BIAS N1162997 R_NOISELESS 100E3
R_R2         N1150163 MID R_NOISELESS 101
R_R200         MID N1162997 R_NOISELESS 1
R_R201         N1163181 JFET_SOURCE R_NOISELESS 1E9
R_R202         N1163181 IN_AUX R_NOISELESS 30E3
R_R203         N1163915 N1154209 R_NOISELESS 5.5
R_R205         POSTCLAMP N1152457 R_NOISELESS 1E3
R_R21         N1151739 PRECLAMP R_NOISELESS 1E3
R_R27         MID N1152457 R_NOISELESS 1
R_R29         N1149807 VCC_B R_NOISELESS 1E3
R_R30         N1149829 N1149807 R_NOISELESS 1E-3
R_R31         VCC_CLP MID R_NOISELESS 1E3
R_R32         N1151153 VEE_B R_NOISELESS 1E3
R_R33         N1151169 N1151153 R_NOISELESS 1E-3
R_R34         VEE_CLP MID R_NOISELESS 1E3
R_R35         MID VCC_CLP R_NOISELESS 1E9
R_R36         N1150481 MID R_NOISELESS 1
R_R37         N1150509 N1150481 R_NOISELESS 1E-3
R_R38         N1151229 N1151215 R_NOISELESS 1E-3
R_R39         MID N1151215 R_NOISELESS 1
R_R4         PSRRN MID R_NOISELESS 989
R_R40         MID VEE_CLP R_NOISELESS 1E9
R_R81         MID N1153945 R_NOISELESS 1E9
R_R83         MID N1153973 R_NOISELESS 1E9
R_R9         N1152909 N1151739 R_NOISELESS 1E-3
R_RSRC         N1150153 MID R_NOISELESS 1
R_RSRC1         N1150117 MID R_NOISELESS 1
R_RSRC10         N1150223 MID R_NOISELESS 1
R_RSRC2         N1150861 MID R_NOISELESS 10000
R_RSRC3         N1150117 N1150135 R_NOISELESS 15710
R_RSRC4         N1150173 MID R_NOISELESS 1
R_RSRC5         N1150251 N1150233 R_NOISELESS 1000
R_RSRC6         N1150251 MID R_NOISELESS 1
R_RSRC7         N1150979 MID R_NOISELESS 10000
R_RSRC8         N1150203 MID R_NOISELESS 1
R_R_VIMON         VIMON N1153945 R_NOISELESS 1
R_R_VOUT_S         VOUT_S N1153973 R_NOISELESS 1
V_V11         N1163181 VEE 3
V_V12         TEMPC N1193390 55
V_V13         N1195365 0 850
V_VCM_MAX         VCC_B N1152443 3
V_VCM_MIN         N1153311 VEE_B 3
X_AOL_2         POSTCLAMP MID MID CLAW_CLAMP AOL_2_BUF802 
X_AOL_3         POSTCLAMP MID MID N1161183 AOL_2_BUF802 
X_CLAWN         MID VIMON VEE_B N1151153 CLAWN_BUF802 
X_CLAWP         VIMON MID N1149807 VCC_B CLAWP_BUF802 
X_CLAW_AMP         VCC_CLP VEE_CLP VOUT_S MID N1150481 N1151215 CLAMP_AMP_LO_BUF802 
X_CLAW_SRC         N1150509 N1151229 CLAW_CLAMP MID CLAW_SRC_BUF802 
X_ESD_OUT         OUT VCC VEE ESD_OUT_BUF802 
X_E_N         JFET_SOURCE N1152885 VNSE_BUF802 
X_H3    OUT N1154209 N1153945 MID SCHEMATIC1_H3_BUF802 
X_IQ_N         MID VIMON MID VEE IQ_SRC_BUF802 
X_IQ_P         VIMON MID VCC MID IQ_SRC_BUF802 
X_I_NP         N1152885 MID FEMT_BUF802 
X_S1    CLL VEE_B CLL N1153317 SCHEMATIC1_S1_BUF802 
X_S2    VCC_B CLH N1152233 CLH SCHEMATIC1_S2_BUF802 
X_S5    MID TEMPS 27C_AOLOUT N1163907 SCHEMATIC1_S5_BUF802 
X_S6    TEMPS MID 85C_AOLOUT N1163907 SCHEMATIC1_S6_BUF802 
X_S7    TEMPS MID N1163907 N1154209 SCHEMATIC1_S7_BUF802 
X_S8    TEMPC 0 N1198690 0 SCHEMATIC1_S8_BUF802 
X_VCM_CLAMP         PRECLAMP MID N1152457 MID N1152233 N1153317 VCM_CLAMP_BUF802 
X_W1    CLAW_CLAMP N1153019 N1152511 N1153019 SCHEMATIC1_W1_BUF802 
X_W2    SR_CLAMP N1153035 N1152511 N1153035 SCHEMATIC1_W2_BUF802 
X_W3    N1161183 N1161493 N1161207 N1161493 SCHEMATIC1_W3_BUF802 
X_W4    SR_CLAMP N1161509 N1161207 N1161509 SCHEMATIC1_W4_BUF802 
.ENDS  BUF802
*
.SUBCKT AOL_2_BUF802 VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 1
.PARAM IPOS = 20
.PARAM INEG = -20
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),INEG,IPOS)}
.ENDS  AOL_2_BUF802
*
.SUBCKT CLAMP_AMP_LO_BUF802 VC+ VC- VIN COM VO+ VO-
.PARAM G=1
GVO+ COM VO+ VALUE = {IF(V(VIN,COM)>V(VC+,COM),((V(VIN,COM)-V(VC+,COM))*G),0)}
GVO- COM VO- VALUE = {IF(V(VIN,COM)<V(VC-,COM),((V(VC-,COM)-V(VIN,COM))*G),0)}
.ENDS  CLAMP_AMP_LO_BUF802
*
.SUBCKT CLAWN_BUF802 VC+ VC- IOUT+ IOUT-
G1 IOUT+ IOUT- TABLE {(V(VC+,VC-))} =
+(0, 1.5E-3)
+(10, 1.7E-3)
+(50, 1.9E-3)
+(100, 2.1E-3)
+(200, 2.43E-3)
+(342, 2.86E-3)
+(365, 3.17E-3)
+(374, 12.17E-3)
.ENDS  CLAWN_BUF802
*
.SUBCKT CLAWP_BUF802 VC+ VC- IOUT+ IOUT-
G1 IOUT+ IOUT- TABLE {(V(VC+,VC-))} =
+(0, 1.6E-3)
+(10, 1.8E-3)
+(50, 1.9E-3)
+(100, 2.19E-3)
+(200, 2.3E-3)
+(250, 2.55E-3)
+(316, 2.80E-3)
+(340, 3.09E-3)
+(348, 4.12E-3)
+(356, 12.42E-3)
.ENDS  CLAWP_BUF802
*
.SUBCKT CLAW_SRC_BUF802 VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 1
.PARAM IPOS = 40
.PARAM INEG = -40
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),INEG,IPOS)}
.ENDS  CLAW_SRC_BUF802
*
.SUBCKT ESD_OUT_BUF802 OUT VCC VEE
.MODEL ESD_SW VSWITCH(RON=50 ROFF=1E12 VON=500E-3 VOFF=450E-3)
S1 VCC OUT OUT VCC ESD_SW
S2 OUT VEE VEE OUT ESD_SW
.ENDS  ESD_OUT_BUF802
*
.SUBCKT FEMT_BUF802 1 2
.PARAM FLWF=0.1
.PARAM NLFF=10E5
.PARAM NVRF=1500
.PARAM GLFF={PWR(FLWF,0.25)*NLFF/1164}
.PARAM RNVF={1.184*PWR(NVRF,2)}
.MODEL DNVF D KF={PWR(FLWF,0.5)/1E11} IS=1.0E-16
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DNVF
D2 8 0 DNVF
E1 3 6 7 8 {GLFF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNVF}
R5 5 0 {RNVF}
R6 3 4 1E9
R7 4 0 1E9
G1 1 2 3 4 1E-6
.ENDS  FEMT_BUF802
*
.SUBCKT IQ_SRC_BUF802 VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 1E-3
G1 IOUT+ IOUT- VALUE={IF( (V(VC+,VC-)<=0),0,GAIN*V(VC+,VC-) )}
.ENDS  IQ_SRC_BUF802
*
.SUBCKT SCHEMATIC1_H3_BUF802 1 2 3 4  
H_H3         3 4 VH_H3 -1E3
VH_H3         1 2 0V
.ENDS  SCHEMATIC1_H3_BUF802
*
.SUBCKT SCHEMATIC1_S1_BUF802 1 2 3 4  
S_S1         3 4 1 2 _S1
RS_S1         1 2 1G
.MODEL         _S1 VSWITCH ROFF=1E9 RON=1E-3 VOFF=2.9 VON=3.1
.ENDS  SCHEMATIC1_S1_BUF802
*
.SUBCKT SCHEMATIC1_S2_BUF802 1 2 3 4  
S_S2         3 4 1 2 _S2
RS_S2         1 2 1G
.MODEL         _S2 VSWITCH ROFF=1E9 RON=1E-3 VOFF=2.9 VON=3.1
.ENDS  SCHEMATIC1_S2_BUF802
*
.SUBCKT SCHEMATIC1_S5_BUF802 1 2 3 4  
S_S5         3 4 1 2 _S5
RS_S5         1 2 1G
.MODEL         _S5 VSWITCH ROFF=1 RON=1E-3 VOFF=-6 VON=6
.ENDS  SCHEMATIC1_S5_BUF802
*
.SUBCKT SCHEMATIC1_S6_BUF802 1 2 3 4  
S_S6         3 4 1 2 _S6
RS_S6         1 2 1G
.MODEL         _S6 VSWITCH ROFF=1E3 RON=1E-3 VOFF=-6 VON=6
.ENDS  SCHEMATIC1_S6_BUF802
*
.SUBCKT SCHEMATIC1_S7_BUF802 1 2 3 4  
S_S7         3 4 1 2 _S7
RS_S7         1 2 1G
.MODEL         _S7 VSWITCH ROFF=1.72 RON=2.03 VOFF=-6 VON=6
.ENDS  SCHEMATIC1_S7_BUF802
*
.SUBCKT SCHEMATIC1_S8_BUF802 1 2 3 4  
S_S8         3 4 1 2 _S8
RS_S8         1 2 1G
.MODEL         _S8 VSWITCH ROFF=112E-12 RON=1E-3 VOFF=27 VON=540
.ENDS  SCHEMATIC1_S8_BUF802
*
.SUBCKT SCHEMATIC1_W1_BUF802 1 2 3 4  
W_W1         3 4 VW_W1 _W1
VW_W1         1 2 0V
.MODEL         _W1 ISWITCH ROFF=1E-3 RON=1E9 IOFF=700M ION=730M
.ENDS  SCHEMATIC1_W1_BUF802
*
.SUBCKT SCHEMATIC1_W2_BUF802 1 2 3 4  
W_W2         3 4 VW_W2 _W2
VW_W2         1 2 0V
.MODEL         _W2 ISWITCH ROFF=1E-3 RON=1E9 IOFF=700M ION=730M
.ENDS  SCHEMATIC1_W2_BUF802
*
.SUBCKT SCHEMATIC1_W3_BUF802 1 2 3 4  
W_W3         3 4 VW_W3 _W3
VW_W3         1 2 0V
.MODEL         _W3 ISWITCH ROFF=1E-3 RON=1E9 IOFF=700M ION=730M
.ENDS  SCHEMATIC1_W3_BUF802
*
.SUBCKT SCHEMATIC1_W4_BUF802 1 2 3 4  
W_W4         3 4 VW_W4 _W4
VW_W4         1 2 0V
.MODEL         _W4 ISWITCH ROFF=1E-3 RON=1E9 IOFF=700M ION=730M
.ENDS  SCHEMATIC1_W4_BUF802
*
.SUBCKT VCM_CLAMP_BUF802 VIN+ VIN- IOUT- IOUT+ VP+ VP-
.PARAM GAIN = 1
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VIN+,VIN-),V(VP-,VIN-), V(VP+,VIN-))}
.ENDS  VCM_CLAMP_BUF802
*
.SUBCKT VNSE_BUF802 1 2
.PARAM FLW=1000
.PARAM NLF=22
.PARAM NVR=7.7
.PARAM GLF={PWR(FLW,0.25)*NLF/1164}
.PARAM RNV={1.184*PWR(NVR,2)}
.MODEL DVN D KF={PWR(FLW,0.5)/1E11} IS=1.0E-16
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVN
D2 8 0 DVN
E1 3 6 7 8 {GLF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNV}
R5 5 0 {RNV}
R6 3 4 1E9
R7 4 0 1E9
E3 1 2 3 4 1
.ENDS  VNSE_BUF802
*