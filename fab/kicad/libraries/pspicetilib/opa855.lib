* OPA855 - Rev. A
* Created by Sean Cashin; 2020-06-04
* Created with Green-Williams-Lis Current Sense Amp Macro-model Architecture
* Copyright 2020 by Texas Instruments Corporation
******************************************************
* MACRO-MODEL SIMULATED PARAMETERS:
******************************************************
* AC PARAMETERS
**********************
* CLOSED-LOOP OUTPUT IMPEDANCE VS. FREQUENCY (Zout vs. Freq.)
* CLOSED-LOOP GAIN AND PHASE VS. FREQUENCY  WITH RL, CL EFFECTS (Acl vs. Freq.)
* COMMON-MODE REJECTION RATIO VS. FREQUENCY (CMRR vs. Freq.)
* POWER SUPPLY REJECTION RATIO VS. FREQUENCY (PSRR vs. Freq.)
* INPUT VOLTAGE NOISE DENSITY VS. FREQUENCY (en vs. Freq.)
**********************
* DC PARAMETERS
**********************
* INPUT COMMON-MODE VOLTAGE RANGE (Vcm)
* GAIN ERROR (Eg)
* INPUT BIAS CURRENT VS. INPUT COMMON-MODE VOLTAGE (Ib vs. Vcm)
* INPUT OFFSET VOLTAGE VS. TEMPERATURE (Vos vs. Temp)
* OUTPUT VOLTAGE SWING vs. OUTPUT CURRENT (Vout vs. Iout)
* SHORT-CIRCUIT OUTPUT CURRENT (Isc)
* QUIESCENT CURRENT (Iq)
**********************
* TRANSIENT PARAMETERS
**********************
* SLEW RATE (SR)
* SETTLING TIME VS. CAPACITIVE LOAD (ts)
* OVERLOAD RECOVERY TIME (tor)
******************************************************
.subckt OPA855 IN+ IN- OUT VCC VEE
******************************************************
.MODEL R_NOISELESS RES (T_ABS=-273.15)
C_C1A         N1492098 N1492108  26.53E-12   
C_C1A1         MID N1492376  2E-12   
C_C1A15         N1483677 N1483687  29.36P   
C_C1A16         PSRRP N1481259  50P   
C_C1A17         N1483713 PSRRN  34.6F   
C_C1A35         N1461236 N1461246  18.72P   
C_C1A36         N1461252 CMRR  53F   
C_C1A39         N1481243 N1481253  22.74P   
C_C1A40         N1483693 N1483703  34.6F   
C_C1A41         N1534615 N1534625  4.55E-12   
C_C1A42         MID N1534887  2E-12   
C_C1A43         N1541593 N1541603  4.55E-12   
C_C33         N406634 0  1E-15   
C_C34         N317950 0  1   
C_C35         N406794 0  1E-15   
C_C44         N1446217 MID  5P   
C_C47         MID CLAMP  12.5e-12   
C_C7         N31014 MID  1P   
C_C8         MID N35813  1E-15   
C_C9         MID N38096  1E-15   
C_C_CMN         MID ESDN  0.6P   
C_C_CMN1         ESDN ESDP  0.2P   
C_C_CMP         ESDP MID  0.6P   
C_C_VIMON         MID VIMON  1E-12   
C_C_VOUT_S         MID VOUT_S  1E-12   
E_E3         N112292 MID OUT MID 1
E_E6         MID 0 N317950 0 1
G_G1         N1492098 MID N1446217 ZO -1.5
G_G111         N1461252 MID N1461246 MID 333
G_G114         N1481243 MID VCC_B MID 0.716
G_G115         N1481259 MID N1481253 MID 4
G_G116         N1483677 MID VEE_B MID 1.578
G_G117         N1534615 MID N1492126 MID -28
G_G118         N1534635 MID N1534625 MID -1
G_G119         N1541593 MID N1534645 MID -28
G_G12         N1446199 MID CLAMP MID -1
G_G2         N10570 N10561 CMRR MID -1E-3
G_G36         VCC_B 0 VCC 0 -1
G_G37         VEE_B 0 VEE 0 -1
G_G4         N1254860 MID N1541603 MID -114
G_G5         N1492118 MID N1492108 MID -1
G_G6         N25816 N11984 PSRRP PSRRN -1E-3
G_G76         N1461236 MID ESDP MID 0.117
G_G77         N1483693 MID N1483687 MID 21.74
G_G78         N1483713 MID N1483703 MID 21.74
G_G8         VCC_CLP MID N35813 MID -1E-3
G_G9         VEE_CLP MID N38096 MID -1E-3
I_I_B         N06456 MID DC 12U  
I_I_OS         ESDN MID DC 12.1U  
I_I_Q         VCC VEE DC 0.0164  
L_L1         N1446199 N1446217  400P  
L_L2         PSRRP N1490067  4N  
R_R1         ESDP IN+ R_NOISELESS 10E-3
R_R10         ESDN N11991 R_NOISELESS 1E-3
R_R107         VCC_B 0 R_NOISELESS 1
R_R108         N317950 0 R_NOISELESS 1E12
R_R109         VEE_B 0 R_NOISELESS 1
R_R110         VCC_B N406634 R_NOISELESS 1E-3
R_R111         N406634 N317950 R_NOISELESS 1E6
R_R112         N317950 N406794 R_NOISELESS 1E6
R_R113         N406794 VEE_B R_NOISELESS 1E-3
R_R146         N1461236 MID R_NOISELESS 1
R_R147         N1461252 MID R_NOISELESS 1
R_R148         N1483713 MID R_NOISELESS 1
R_RIN_DIFF     ESDN ESDP R_NOISELESS 50K
R_R1A         N1492108 N1492098 R_NOISELESS 10E3
R_R1A1         N1492126 N1492118 R_NOISELESS 30
R_R1A14         N1461236 N1461246 R_NOISELESS 10E3
R_R1A15         N1461252 CMRR R_NOISELESS 10E3
R_R1A16         PSRRP MID R_NOISELESS 2.8
R_R1A17         N1483693 N1483703 R_NOISELESS 10E3
R_R1A18         N1483713 PSRRN R_NOISELESS 10E3
R_R1A40         N1481243 N1481253 R_NOISELESS 10E3
R_R1A41         N1490067 N1481259 R_NOISELESS 7
R_R1A42         N1483677 N1483687 R_NOISELESS 10E3
R_R1A43         N1534645 N1534635 R_NOISELESS 30
R_R1A44         N1534625 N1534615 R_NOISELESS 10
R_R1A45         N1541603 N1541593 R_NOISELESS 10
R_R2         ESDN IN- R_NOISELESS 10E-3
R_R21         N11984 N25816 R_NOISELESS 1E3
R_R211         MID N1254860 R_NOISELESS 1
R_R225         MID N1446199 R_NOISELESS 1
R_R226         MID N1446217 R_NOISELESS 30
R_R245         VCC VEE R_NOISELESS 4.5K
R_R246         N1481243 MID R_NOISELESS 1
R_R247         N1481259 MID R_NOISELESS 1
R_R248         N1483677 MID R_NOISELESS 1
R_R249         N1483693 MID R_NOISELESS 1
R_R25         MID N28602 R_NOISELESS 1E9
R_R250         MID N1492098 R_NOISELESS 1
R_R251         MID N1534615 R_NOISELESS 1
R_R252         MID N1534635 R_NOISELESS 1
R_R253         MID N1541593 R_NOISELESS 1
R_R26         N30136 MID R_NOISELESS 1E9
R_R27         MID N30913 R_NOISELESS 1
R_R28         N31014 N30913 R_NOISELESS 1E-3
R_R29         N35675 VCC_B R_NOISELESS 1E3
R_R2A         MID N1492108 R_NOISELESS 20E3
R_R2A1         N1492376 N1492126 R_NOISELESS 10
R_R2A16         N1483687 MID R_NOISELESS 0.542
R_R2A17         N1483703 MID R_NOISELESS 482.2
R_R2A18         PSRRN MID R_NOISELESS 482.2
R_R2A36         N1461246 MID R_NOISELESS 0.85
R_R2A37         CMRR MID R_NOISELESS 30.1
R_R2A40         N1481253 MID R_NOISELESS 0.7
R_R2A41         N1534887 N1534645 R_NOISELESS 10
R_R2A42         MID N1534625 R_NOISELESS 0.363
R_R2A43         MID N1541603 R_NOISELESS 0.363
R_R3         MID ESDP R_NOISELESS 2.3MEG
R_R30         N35813 N35675 R_NOISELESS 1E-3
R_R31         VCC_CLP MID R_NOISELESS 1E3
R_R32         N38050 VEE_B R_NOISELESS 1E3
R_R33         N38096 N38050 R_NOISELESS 1E-3
R_R34         VEE_CLP MID R_NOISELESS 1E3
R_R4         ESDN MID R_NOISELESS 2.3MEG
R_R6         MID N1492118 R_NOISELESS 1
R_R60         MID AOLNET R_NOISELESS 1
R_R8         N10561 N10570 R_NOISELESS 1E3
R_R81         MID N110431 R_NOISELESS 1E9
R_R83         MID N112292 R_NOISELESS 1E9
R_R9         N10570 N11984 R_NOISELESS 1E-3
R_RDUMMY         MID ZO R_NOISELESS 140
R_RX         ZO N1254860 R_NOISELESS 1400
R_R_VIMON         VIMON N110431 R_NOISELESS 100
R_R_VOUT_S         VOUT_S N112292 R_NOISELESS 100
V_VCM_MAX         N30136 VCC_B -0.4
V_VCM_MIN         N28602 VEE_B 1.1
X_ESD_OUT         OUT VCC VEE ESD_OUT_OPA855 
X_E_N         ESDP N06456 VNSE_OPA855 
X_H3    OUT ZO N110431 MID 08_OP_AMP_COMPLETE_H3_OPA855 
X_IQ_N         MID VIMON MID VEE IQ_SRC_OPA855 
X_IQ_P         VIMON MID VCC MID IQ_SRC_OPA855 
X_I_NP1         ESDN MID FEMT_OPA855 
X_S1    OUT VCC_CLP CLAMP MID 08_OP_AMP_COMPLETE_S1_OPA855 
X_S2    VEE_CLP OUT CLAMP MID 08_OP_AMP_COMPLETE_S2_OPA855 
X_U1         MID N06456 FEMT_OPA855 
X_U2         N31014 N11991 AOLNET MID AOL_1_OPA855 
X_U3         AOLNET MID CLAMP MID AOL_2_OPA855 
X_U5         VIMON MID N35675 VCC_B CLAWP_OPA855 
X_U6         VIMON MID VEE_B N38050 CLAWN_OPA855 
X_VCM_CLAMP         N25816 MID N30913 MID N30136 N28602 VCM_CLAMP_OPA855 
X_VOS_DRIFT         N749288 N06456 VOS_DRIFT_OPA855 
X_VOS_VS_VCM         N10561 N749288 VCC VEE VOS_VS_VCM_OPA855 
.ENDS  OPA855
*
.SUBCKT 08_OP_AMP_COMPLETE_H3_OPA855 1 2 3 4  
H_H3         3 4 VH_H3 -1E3
VH_H3         1 2 0V
.ENDS  08_OP_AMP_COMPLETE_H3_OPA855
*
.SUBCKT 08_OP_AMP_COMPLETE_S1_OPA855 1 2 3 4  
S_S1         3 4 1 2 _S1
RS_S1         1 2 1G
.MODEL         _S1 VSWITCH ROFF=20E3 RON=1E-3 VOFF=-0.05 VON=0.04
.ENDS  08_OP_AMP_COMPLETE_S1_OPA855
*
.SUBCKT 08_OP_AMP_COMPLETE_S2_OPA855 1 2 3 4  
S_S2         3 4 1 2 _S2
RS_S2         1 2 1G
.MODEL         _S2 VSWITCH ROFF=20E3 RON=1E-3 VOFF=-0.05 VON=0.04
.ENDS  08_OP_AMP_COMPLETE_S2_OPA855
*
.SUBCKT AOL_1_OPA855 VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 1
.PARAM IPOS = .5
.PARAM INEG = -.5
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),INEG,IPOS)}
.ENDS  AOL_1_OPA855
*
.SUBCKT AOL_2_OPA855 VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 0.75
.PARAM IPOS = 40e-3
.PARAM INEG = -40e-3
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),INEG,IPOS)}
.ENDS  AOL_2_OPA855
*
.SUBCKT CLAWN_OPA855 VC+ VC- IOUT+ IOUT-
G1 IOUT+ IOUT- TABLE {ABS(V(VC+,VC-))} =
+(0, 1.02E-3)
+(20.5, 1.19E-3)
+(46.37, 1.37E-3)
+(55.32, 1.43E-3)
+(61.86, 1.47E-3)
+(67.19, 1.51E-3)
+(72.22, 1.55E-3)
+(78.37, 1.60E-3)
+(85.63, 1.63E-3)
+(90.22, 1.67E-3)
+(93.85, 1.70E-3)
+(97.87, 1.74E-3)
+(101.1, 1.76E-3)
+(104.5, 1.80E-3)
+(106.9, 1.83E-3)
+(109.9, 1.91E-3)
+(111.9, 2.026E-3)
+(120.1, 3.40E-3)

.ENDS  CLAWN_OPA855
*
.SUBCKT CLAWP_OPA855 VC+ VC- IOUT+ IOUT-
G1 IOUT+ IOUT- TABLE {ABS(V(VC+,VC-))} =
+(0, 7.88E-4)
+(6.1, 8.68E-4)
+(15.2, 9.53E-4)
+(27.1, 1.04E-3)
+(42.8, 1.16E-3)
+(60.7, 1.29E-3)
+(97.11, 1.66E-3)
+(106.7, 1.81E-3)
+(112.2, 1.99E-3)
+(120.1, 3.40E-3)

.ENDS  CLAWP_OPA855
*
.SUBCKT ESD_OUT_OPA855 OUT VCC VEE
.MODEL ESD_SW VSWITCH(RON=50 ROFF=1E12 VON=500E-3 VOFF=450E-3)
S1 VCC OUT OUT VCC ESD_SW
S2 OUT VEE VEE OUT ESD_SW
.ENDS  ESD_OUT_OPA855
*
.SUBCKT FEMT_OPA855 1 2
.PARAM FLWF=1000
.PARAM NLFF=35000
.PARAM NVRF=2500
.PARAM GLFF={PWR(FLWF,0.25)*NLFF/1164}
.PARAM RNVF={1.184*PWR(NVRF,2)}
.MODEL DNVF D KF={PWR(FLWF,0.5)/1E11} IS=1.0E-16
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DNVF
D2 8 0 DNVF
E1 3 6 7 8 {GLFF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNVF}
R5 5 0 {RNVF}
R6 3 4 1E9
R7 4 0 1E9
G1 1 2 3 4 1E-6
.ENDS  FEMT_OPA855
*
.SUBCKT IQ_SRC_OPA855 VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 1E-3
G1 IOUT+ IOUT- VALUE={IF( (V(VC+,VC-)<=0),0,GAIN*V(VC+,VC-) )}
.ENDS  IQ_SRC_OPA855
*
.SUBCKT VCM_CLAMP_OPA855 VIN+ VIN- IOUT- IOUT+ VP+ VP-
.PARAM GAIN = 1
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VIN+,VIN-),V(VP-,VIN-), V(VP+,VIN-))}
.ENDS  VCM_CLAMP_OPA855
*
.SUBCKT VNSE_OPA855 1 2
.PARAM FLW=1000
.PARAM NLF=3
.PARAM NVR=0.98
.PARAM GLF={PWR(FLW,0.25)*NLF/1164}
.PARAM RNV={1.184*PWR(NVR,2)}
.MODEL DVN D KF={PWR(FLW,0.5)/1E11} IS=1.0E-16
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVN
D2 8 0 DVN
E1 3 6 7 8 {GLF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNV}
R5 5 0 {RNV}
R6 3 4 1E9
R7 4 0 1E9
E3 1 2 3 4 1
.ENDS  VNSE_OPA855
*
.SUBCKT VOS_DRIFT_OPA855 VOS+ VOS-
.PARAM DC = -4E-4
.PARAM POL = 1
.PARAM DRIFT = 20E-6
E1 VOS+ VOS- VALUE={DC+POL*DRIFT*(TEMP-27)}
.ENDS  VOS_DRIFT_OPA855
*
.SUBCKT VOS_VS_VCM_OPA855 V+ V- REF+ REF-
E1 V+ 1 TABLE {(V(REF+, V-))} =
+(0.35, 450E-6)
+(0.4, 435E-6)
+(0.55, 275E-6)
+(0.65, 150E-6)
+(0.75, 75E-6)
+(0.85, 25E-6)
+(1, 0)
V1 1 V- 0
.ENDS  VOS_VS_VCM_OPA855
*