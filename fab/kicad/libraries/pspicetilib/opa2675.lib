* OPA2675 - Rev. A
* Created by Sean Cashin; 2022-09-21
* Created with Green-Williams-Lis Current Sense Amp Macro-model Architecture
* Copyright 2022 by Texas Instruments Corporation
******************************************************
* MACRO-MODEL SIMULATED PARAMETERS:
******************************************************
* AC PARAMETERS
**********************
* CLOSED-LOOP OUTPUT IMPEDANCE VS. FREQUENCY (Zout vs. Freq.)
* CLOSED-LOOP GAIN AND PHASE VS. FREQUENCY  WITH RL, CL EFFECTS (Acl vs. Freq.)
* COMMON-MODE REJECTION RATIO VS. FREQUENCY (CMRR vs. Freq.)
* POWER SUPPLY REJECTION RATIO VS. FREQUENCY (PSRR vs. Freq.)
* INPUT VOLTAGE NOISE DENSITY VS. FREQUENCY (en vs. Freq.)
**********************
* DC PARAMETERS
**********************
* INPUT COMMON-MODE VOLTAGE RANGE (Vcm)
* GAIN ERROR (Eg)
* INPUT BIAS CURRENT VS. INPUT COMMON-MODE VOLTAGE (Ib vs. Vcm)
* INPUT OFFSET VOLTAGE VS. TEMPERATURE (Vos vs. Temp)
* OUTPUT VOLTAGE SWING vs. OUTPUT CURRENT (Vout vs. Iout)
* SHORT-CIRCUIT OUTPUT CURRENT (Isc)
* QUIESCENT CURRENT (Iq)
**********************
* TRANSIENT PARAMETERS
**********************
* SLEW RATE (SR)
* SETTLING TIME VS. CAPACITIVE LOAD (ts)
* OVERLOAD RECOVERY TIME (tor)
******************************************************
.subckt OPA2675 INp INm OUT VCC VEE A0 GND
******************************************************
.MODEL R_NOISELESS RES (T_ABS=-273.15)
C_C1         N1410320 N1410360  50N   
C_C34         MID AOLOUT  624.312E-12   
C_C36         SLEW MID  1.442E-9   
C_C38         N505726 PSRRM  410E-12   
C_C39         N1346042 PSRRP  410E-12   
C_C5         CMRR N462608  16E-9   
C_C7         N957214 MID  235.4E-15   
C_C8         N957264 MID  213E-15   
C_CINM         INM MID  1.5E-12   
C_CINP         MID INP  1.5E-12   
C_CMID         0 PREMID  1E-3   
E_E1         N957042 MID AOL3 MID 1
E_E5         N1410360 MID AOLOUT MID 1
E_E8         MID 0 PREMID 0 1
E_E9         N959235 MID N463418 MID 1
G_G10         VCC_CLP VEE_B IMON 0 1
G_G11         VCC_B VEE_CLP VCC_B VEE_B -1
G_G16         VCC GND N460322 GND 1
G_G17         VEE GND N461004 GND -1
G_G18         N460322 GND IMON GND -1
G_G19         N461004 GND GND IMON -1
G_G3         AOL2 MID SLEW MID -1
G_G4         VCC_B 0 VCC 0 -1
G_G40         VCC_B VEE_CLP 0 IMON 2
G_G41         N956884 MID N956866 MID -1
G_G42         N956734 MID N956892 MID -1
G_G43         AOL3 MID N956734 MID -1
G_G44         N505726 MID VEE_B MID -4.272
G_G45         N1346042 MID VCC_B MID -3
G_G5         VEE_B 0 VEE 0 -1
G_G6         N462608 MID N463406 MID -0.18
G_G9         VCC_CLP VEE_B VCC_B VEE_B -1
G_GCMRR         N463410 N463406 CMRR MID -1E-3
G_GPSRR         N463418 N463410 PSRRP PSRRM -1E-3
I_I1         CREF TEMPC DC 1ADC  
I_I2         VCC_CLP VEE_B DC 1.1  
I_I3         VCC_B VEE_CLP DC 1.1  
I_I4         MID INP DC 5E-6  
I_I5         MID INM DC 6E-6  
I_IBPD         A0 MID DC 30E-6  
I_IQ1         VCC N465370 DC 13.7E-3  
I_IQ2         VCC N465486 DC 2.75E-3  
L_L1         N957042 AOLOUT  100E-12  
L_L2         MID N957030  116.845E-12  
L_L3         MID N957036  60.932E-12  
L_L4         ZOUT ZOUTL  3E-9  
R_R1         N956866 N957214 R_NOISELESS 1000
R_R2         AOL2 N956866 R_NOISELESS 1437
R_R21         N1410360 ZOUTL R_NOISELESS 1.0825
R_R22         N1410320 ZOUTL R_NOISELESS 30
R_R3         N956884 N956892 R_NOISELESS 65.95
R_R36         AOL2 MID R_NOISELESS 1
R_R37         N956884 MID R_NOISELESS 1
R_R38         N956734 N957030 R_NOISELESS 1
R_R39         AOL3 N957036 R_NOISELESS 1
R_R4         N956892 N957264 R_NOISELESS 1000
R_R5         A0 MID R_NOISELESS 28E3
R_RC         N462608 CMRR R_NOISELESS 10E3
R_RCMRR         N463406 N463410 R_NOISELESS 1E3
R_RINM         N959235 INM R_NOISELESS 30
R_RINP         MID INP R_NOISELESS 3E6
R_RIQ         VCC N465370 R_NOISELESS 115E3
R_RM         MID N462608 R_NOISELESS 1
R_RM1         MID CMRR R_NOISELESS 0.1
R_RMID         VCC_B 0 R_NOISELESS 1
R_RMID1         PREMID 0 R_NOISELESS 1E9
R_RMID2         VEE_B 0 R_NOISELESS 1
R_RMID3         PREMID VEE_B R_NOISELESS 1E3
R_RMID4         VCC_B PREMID R_NOISELESS 1E3
R_RPSN1         N505726 MID R_NOISELESS 1
R_RPSN2         N505726 PSRRM R_NOISELESS 1E3
R_RPSN3         PSRRM MID R_NOISELESS 0.39
R_RPSP         PSRRP MID R_NOISELESS 0.39
R_RPSP1         N1346042 MID R_NOISELESS 1
R_RPSP2         PSRRP N1346042 R_NOISELESS 1E3
R_RPSRR         N463410 N463418 R_NOISELESS 1E3
R_RQ         N465486 VEE R_NOISELESS 1E-3
R_RTEMPCOEF         TEMPC CREF R_NOISELESS 1
V_V14         CREF 0 27
V_VCMH         VCC_B N940824 2.4
V_VCML         N940832 VEE_B 2.4
X_H4    N1415236 OUT IMON 0 8COMPLETE_H4_OPA2675 
X_S11    IMON 0 VCC_CLP VEE_B 8COMPLETE_S11_OPA2675 
X_S12    0 IMON VEE_CLP VCC_B 8COMPLETE_S12_OPA2675 
X_S29    A0 GND N465486 N465370 8COMPLETE_S29_OPA2675 
X_S30    IMON GND N460322 GND 8COMPLETE_S30_OPA2675 
X_S31    GND IMON N461004 GND 8COMPLETE_S31_OPA2675 
X_S36    OUT VCC_CLP N516672 MID 8COMPLETE_S36_OPA2675 
X_S37    VEE_CLP OUT N516672 MID 8COMPLETE_S37_OPA2675 
X_S38    A0 GND N1415236 ZOUT 8COMPLETE_S38_OPA2675 
X_S39    OUT VCC_CLP AOLOUT MID 8COMPLETE_S39_OPA2675 
X_S40    VEE_CLP OUT AOLOUT MID 8COMPLETE_S40_OPA2675 
X_S41    OUT VCC_CLP ZOUT ZOUTL 8COMPLETE_S41_OPA2675 
X_S42    VEE_CLP OUT ZOUT ZOUTL 8COMPLETE_S42_OPA2675 
X_U1         N938010 N463406 VNSE_OPA2675
X_U3         MID N938010 FEMT_OPA2675
X_U4         MID INM FEMTB_OPA2675
X_U5         N959235 INM MID N516672 N940824 N940832 VCM_CLAMP_OPA2675
X_U6         N938010 INP VOS_DRIFT_OPA2675
X_W1    N516672 N973734 N973790 N973734 8COMPLETE_W1_OPA2675 
X_W2    N973764 SLEW N973764 N973790 8COMPLETE_W2_OPA2675 
.ENDS  OPA2675
*
.SUBCKT 8COMPLETE_H4_OPA2675 1 2 3 4  
H_H4         3 4 VH_H4 1
VH_H4         1 2 0V
.ENDS  8COMPLETE_H4_OPA2675
*
.SUBCKT 8COMPLETE_S11_OPA2675 1 2 3 4  
S_S11         3 4 1 2 _S11
RS_S11         1 2 1G
.MODEL         _S11 VSWITCH ROFF=1 RON=1E-3 VOFF=1 VON=1.3
.ENDS  8COMPLETE_S11_OPA2675
*
.SUBCKT 8COMPLETE_S12_OPA2675 1 2 3 4  
S_S12         3 4 1 2 _S12
RS_S12         1 2 1G
.MODEL         _S12 VSWITCH ROFF=1 RON=1E-3 VOFF=1 VON=1.3
.ENDS  8COMPLETE_S12_OPA2675
*
.SUBCKT 8COMPLETE_S29_OPA2675 1 2 3 4  
S_S29         3 4 1 2 _S29
RS_S29         1 2 1G
.MODEL         _S29 VSWITCH ROFF=1 RON=1E9 VOFF=0.8 VON=2
.ENDS  8COMPLETE_S29_OPA2675
*
.SUBCKT 8COMPLETE_S30_OPA2675 1 2 3 4  
S_S30         3 4 1 2 _S30
RS_S30         1 2 1G
.MODEL         _S30 VSWITCH ROFF=1E-6 RON=1 VOFF=0 VON=0.1E-3
.ENDS  8COMPLETE_S30_OPA2675
*
.SUBCKT 8COMPLETE_S31_OPA2675 1 2 3 4  
S_S31         3 4 1 2 _S31
RS_S31         1 2 1G
.MODEL         _S31 VSWITCH ROFF=1E-6 RON=1 VOFF=0 VON=0.1E-3
.ENDS  8COMPLETE_S31_OPA2675
*
.SUBCKT 8COMPLETE_S36_OPA2675 1 2 3 4  
S_S36         3 4 1 2 _S36
RS_S36         1 2 1G
.MODEL         _S36 VSWITCH ROFF=2E3 RON=1E-3 VOFF=-50E-3 VON=50E-3
.ENDS  8COMPLETE_S36_OPA2675
*
.SUBCKT 8COMPLETE_S37_OPA2675 1 2 3 4  
S_S37         3 4 1 2 _S37
RS_S37         1 2 1G
.MODEL         _S37 VSWITCH ROFF=2E3 RON=1E-3 VOFF=-50E-3 VON=50E-3
.ENDS  8COMPLETE_S37_OPA2675
*
.SUBCKT 8COMPLETE_S38_OPA2675 1 2 3 4  
S_S38         3 4 1 2 _S38
RS_S38         1 2 1G
.MODEL         _S38 VSWITCH ROFF=1E-3 RON=1E9 VOFF=0.8 VON=2
.ENDS  8COMPLETE_S38_OPA2675
*
.SUBCKT 8COMPLETE_S39_OPA2675 1 2 3 4  
S_S39         3 4 1 2 _S39
RS_S39         1 2 1G
.MODEL         _S39 VSWITCH ROFF=1.2 RON=200E-3 VOFF=-10E-3 VON=10E-3
.ENDS  8COMPLETE_S39_OPA2675
*
.SUBCKT 8COMPLETE_S40_OPA2675 1 2 3 4  
S_S40         3 4 1 2 _S40
RS_S40         1 2 1G
.MODEL         _S40 VSWITCH ROFF=1.2 RON=200E-3 VOFF=-10E-3 VON=10E-3
.ENDS  8COMPLETE_S40_OPA2675
*
.SUBCKT 8COMPLETE_S41_OPA2675 1 2 3 4  
S_S41         3 4 1 2 _S41
RS_S41         1 2 1G
.MODEL         _S41 VSWITCH ROFF=2E3 RON=1E-3 VOFF=-100E-3 VON=100E-3
.ENDS  8COMPLETE_S41_OPA2675
*
.SUBCKT 8COMPLETE_S42_OPA2675 1 2 3 4  
S_S42         3 4 1 2 _S42
RS_S42         1 2 1G
.MODEL         _S42 VSWITCH ROFF=2E3 RON=1E-3 VOFF=-100E-3 VON=100E-3
.ENDS  8COMPLETE_S42_OPA2675
*
.SUBCKT 8COMPLETE_W1_OPA2675 1 2 3 4  
W_W1         3 4 VW_W1 _W1
VW_W1         1 2 0V
.MODEL         _W1 ISWITCH ROFF=1E-3 RON=1E6 IOFF=4.7 ION=5
.ENDS  8COMPLETE_W1_OPA2675
*
.SUBCKT 8COMPLETE_W2_OPA2675 1 2 3 4  
W_W2         3 4 VW_W2 _W2
VW_W2         1 2 0V
.MODEL         _W2 ISWITCH ROFF=1E-3 RON=1E6 IOFF=4.7 ION=5
.ENDS  8COMPLETE_W2_OPA2675
*
.SUBCKT FEMT_OPA2675 1 2
.PARAM FLWF=100
.PARAM NLFF=0.006
.PARAM NVRF=0.0008
.PARAM GLFF={PWR(FLWF,0.25)*NLFF/1164}
.PARAM RNVF={1.184*PWR(NVRF,2)}
.MODEL DVNF D KF={PWR(FLWF,0.5)/1E11} IS=1.0E-16
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVNF
D2 8 0 DVNF
E1 3 6 7 8 {GLFF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNVF}
R5 5 0 {RNVF}
R6 3 4 1E9
R7 4 0 1E9
G1 1 2 3 4 1E-6
.ENDS  FEMT_OPA2675
*
.SUBCKT FEMTB_OPA2675 1 2
.PARAM FLWF=100
.PARAM NLFF=0.07
.PARAM NVRF=0.015
.PARAM GLFF={PWR(FLWF,0.25)*NLFF/1164}
.PARAM RNVF={1.184*PWR(NVRF,2)}
.MODEL DVNF D KF={PWR(FLWF,0.5)/1E11} IS=1.0E-16
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVNF
D2 8 0 DVNF
E1 3 6 7 8 {GLFF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNVF}
R5 5 0 {RNVF}
R6 3 4 1E9
R7 4 0 1E9
G1 1 2 3 4 1E-6
.ENDS  FEMTB_OPA2675
*
.SUBCKT VCM_CLAMP_OPA2675 VIN+ VIN- IOUT- IOUT+ VP+ VP-
.PARAM GAIN = -27.35
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VIN+,VIN-),V(VP-,VIN-), V(VP+,VIN-))}
.ENDS  VCM_CLAMP_OPA2675
*
.SUBCKT VNSE_OPA2675 1 2
.PARAM FLW=100
.PARAM NLF=4
.PARAM NVR=2.4
.PARAM GLF={PWR(FLW,0.25)*NLF/1164}
.PARAM RNV={1.184*PWR(NVR,2)}
.MODEL DVN D KF={PWR(FLW,0.5)/1E11} IS=1.0E-16
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVN
D2 8 0 DVN
E1 3 6 7 8 {GLF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNV}
R5 5 0 {RNV}
R6 3 4 1E9
R7 4 0 1E9
E3 1 2 3 4 1
.ENDS  VNSE_OPA2675
*
.SUBCKT VOS_DRIFT_OPA2675 VOS+ VOS-
.PARAM DC = -10.5E-3
.PARAM POL = 1
.PARAM DRIFT = 3E-6
E1 VOS+ VOS- VALUE={DC+POL*DRIFT*(TEMP-27)}
.ENDS  VOS_DRIFT_OPA2675
*