* OPA818 - Rev. A
* Created by Sean Cashin; 2020-06-02
* Created with Green-Williams-Lis Current Sense Amp Macro-model Architecture
* Copyright 2020 by Texas Instruments Corporation
******************************************************
* MACRO-MODEL SIMULATED PARAMETERS:
******************************************************
* AC PARAMETERS
**********************
* CLOSED-LOOP OUTPUT IMPEDANCE VS. FREQUENCY (Zout vs. Freq.)
* CLOSED-LOOP GAIN AND PHASE VS. FREQUENCY  WITH RL, CL EFFECTS (Acl vs. Freq.)
* COMMON-MODE REJECTION RATIO VS. FREQUENCY (CMRR vs. Freq.)
* POWER SUPPLY REJECTION RATIO VS. FREQUENCY (PSRR vs. Freq.)
* INPUT VOLTAGE NOISE DENSITY VS. FREQUENCY (en vs. Freq.)
**********************
* DC PARAMETERS
**********************
* INPUT COMMON-MODE VOLTAGE RANGE (Vcm)
* GAIN ERROR (Eg)
* INPUT BIAS CURRENT VS. INPUT COMMON-MODE VOLTAGE (Ib vs. Vcm)
* INPUT OFFSET VOLTAGE VS. TEMPERATURE (Vos vs. Temp)
* OUTPUT VOLTAGE SWING vs. OUTPUT CURRENT (Vout vs. Iout)
* SHORT-CIRCUIT OUTPUT CURRENT (Isc)
* QUIESCENT CURRENT (Iq)
**********************
* TRANSIENT PARAMETERS
**********************
* SLEW RATE (SR)
* SETTLING TIME VS. CAPACITIVE LOAD (ts)
* OVERLOAD RECOVERY TIME (tor)
******************************************************
.subckt OPA818 IN+ IN- OUT VCC VEE
******************************************************
.MODEL R_NOISE RES (T_ABS=0)
.MODEL R_NOISELESS RES (T_ABS=-273.15)
C_C1         MID N78838  5.75E-12   
C_C1A         N781607 N781617  5.27E-11   
C_C1A10         N784850 N706294  5.779E-10   
C_C1A11         N788897 N788911  1.061E-8   
C_C1A12         N788919 N709248  1.592E-12   
C_C1A17         N725398 N725428  530.5E-12   
C_C1A20         N915845 N915839  5.305E-13   
C_C1A21         N806818 N915855  1.592E-8   
C_C1A22         N916866 N916860  5.305E-13   
C_C1A23         N819305 N916876  1.592E-8   
C_C1A9         N781627 N781637  1.592E-14   
C_C1B         MID N725708  2.653E-15   
C_C1C         N725214 N725836  2.653E-15   
C_C3         MID N949870  1E-17   
C_C33         N406634 0  1E-15   
C_C34         N317950 0  1   
C_C35         N406794 0  1E-15   
C_C4         MID N301844  2.5P   
C_C5         N949926 N980363  14F   
C_C7         N31014 MID  1E-15   
C_C8         MID N35813  1E-15   
C_C9         MID N38096  1E-15   
C_C_CMN         MID ESDN  1.87E-12   
C_C_CMP         ESDP MID  1.87E-12   
C_C_DIFF         ESDN ESDP  0.5P   
C_C_VCLP         VCLP MID  1E-12   
C_C_VIMON         MID VIMON  1E-12   
C_C_VOUT_S         MID VOUT_S  1E-12   
E_E2         N91498 MID N301844 MID 1
E_E3         N112292 MID OUT MID 1
E_E6         MID 0 N317950 0 1
G_G1         N781607 MID ESDP MID 0.2944
G_G2         N10570 N10561 N781637 MID -1E-3
G_G36         VCC_B 0 VCC 0 -1
G_G37         VEE_B 0 VEE 0 -1
G_G57         N725398 MID N301844 N516723 -30
G_G58         N781627 MID N781617 MID 5
G_G59         N784850 MID VEE_B MID -9.661
G_G6         N25816 N11984 N709248 N706294 -1E-3
G_G60         N788897 MID VCC_B MID -10
G_G61         N788919 MID N788911 MID -100
G_G67         N725346 MID N725428 MID -15
G_G68         N06456 MID N915839 MID -1E-6
G_G69         ESDN MID N916860 MID -1E-6
G_G72         N915845 MID N915855 MID -2
G_G73         N916866 MID N916876 MID -2
G_G74         N949870 MID N78838 MID -300E-6
G_G75         N949932 MID N949926 MID -1
G_G76         N980363 MID N949870 MID -3.33
G_G77         N806818 MID N806812 MID -10
G_G78         N819305 MID N819171 MID -10
G_G8         VCC_CLP MID N35813 MID -1E-3
G_G9         VEE_CLP MID N38096 MID -1E-3
G_GD4         N725214 MID N725574 MID -1
G_GD5         N725936 MID N725836 MID -90.91
I_I_B         N06456 MID DC 4P  
I_I_OS         ESDN MID DC 3P  
I_I_Q         VCC VEE DC 27.7E-3  
L_L1         N949932 N301844  15N  
R_R1         ESDP IN+ R_NOISELESS 10E-3
R_R10         ESDN N11991 R_NOISELESS 1E-3
R_R107         VCC_B 0 R_NOISELESS 1
R_R108         N317950 0 R_NOISELESS 1E12
R_R109         VEE_B 0 R_NOISELESS 1
R_R11         MID N725346 R_NOISELESS 1
R_R110         VCC_B N406634 R_NOISELESS 1E-3
R_R111         N406634 N317950 R_NOISELESS 1E6
R_R112         N317950 N406794 R_NOISELESS 1E6
R_R113         N406794 VEE_B R_NOISELESS 1E-3
R_R137         MID N725398 R_NOISELESS 1
R_R139         MID N725214 R_NOISELESS 1
R_R140         MID N725936 R_NOISELESS 1
R_R141         N781607 MID R_NOISELESS 1
R_R142         N781627 MID R_NOISELESS 1
R_R143         N784850 MID R_NOISELESS 1
R_R144         N788897 MID R_NOISELESS 1
R_R145         N788919 MID R_NOISELESS 1
R_R152         N915845 MID R_NOISELESS 1
R_R153         N806818 MID R_NOISELESS 1
R_R154         N916866 MID R_NOISELESS 1
R_R155         N819305 MID R_NOISELESS 1
R_R157         N949870 MID R_NOISELESS 1E6
R_R160         N949932 MID R_NOISELESS 1
R_R161         N301844 MID R_NOISELESS 56
R_R162         N980363 MID R_NOISELESS 1
R_R163         N980363 N949926 R_NOISELESS 10K
R_R164         N949926 MID R_NOISELESS 1
R_R165         N806812 MID R_NOISE 1E9
R_R166         N819171 MID R_NOISE 1E9
R_R1A         N781607 N781617 R_NOISELESS 10E3
R_R1A10         N781627 N781637 R_NOISELESS 10E3
R_R1A11         N784850 N706294 R_NOISELESS 10E3
R_R1A12         N788897 N788911 R_NOISELESS 10E3
R_R1A13         N788919 N709248 R_NOISELESS 10E3
R_R1A20         N915845 N915839 R_NOISELESS 10E3
R_R1A21         N806818 N915855 R_NOISELESS 10E3
R_R1A22         N916866 N916860 R_NOISELESS 10E3
R_R1A23         N819305 N916876 R_NOISELESS 10E3
R_R1A9         N725428 N725398 R_NOISELESS 1E4
R_R1C2         N725836 N725214 R_NOISELESS 1E4
R_R1D1         N725708 N725574 R_NOISELESS 1E4
R_R2         ESDN IN- R_NOISELESS 10E-3
R_R21         N11984 N25816 R_NOISELESS 1E3
R_R25         MID N28602 R_NOISELESS 1E9
R_R26         N30136 MID R_NOISELESS 1E9
R_R27         MID N30913 R_NOISELESS 1
R_R28         N31014 N30913 R_NOISELESS 1E-3
R_R29         N35669 VCC_B R_NOISELESS 1E3
R_R2A         N781617 MID R_NOISELESS .604
R_R2A10         N781637 MID R_NOISELESS 2.5E3
R_R2A11         N706294 MID R_NOISELESS 0.02754
R_R2A12         N788911 MID R_NOISELESS 1.5E-3
R_R2A13         N709248 MID R_NOISELESS 101
R_R2A18         MID N725428 R_NOISELESS 344.8
R_R2A21         N915839 MID R_NOISELESS 309.3
R_R2A22         N915855 MID R_NOISELESS 1
R_R2A23         N916860 MID R_NOISELESS 309.3
R_R2A24         N916876 MID R_NOISELESS 1
R_R2B         N725574 N725346 R_NOISELESS 90E3
R_R2C         MID N725836 R_NOISELESS 638.3
R_R3         MID ESDP R_NOISELESS 500G
R_R30         N35813 N35669 R_NOISELESS 1E-3
R_R31         VCC_CLP MID R_NOISELESS 1E3
R_R32         N38050 VEE_B R_NOISELESS 1E3
R_R33         N38096 N38050 R_NOISELESS 1E-3
R_R34         VEE_CLP MID R_NOISELESS 1E3
R_R4         ESDN MID R_NOISELESS 500G
R_R60         MID AOLNET R_NOISELESS 1E6
R_R8         N10561 N10570 R_NOISELESS 1E3
R_R81         MID N110431 R_NOISELESS 1E9
R_R83         MID N112292 R_NOISELESS 1E9
R_R9         N10570 N11984 R_NOISELESS 1E-3
R_RDUMMY1         MID N516723 R_NOISELESS 1100
R_RX1         N516723 N725936 R_NOISELESS 11000
R_R_VCLP         N91498 VCLP R_NOISELESS 100
R_R_VIMON         VIMON N110431 R_NOISELESS 100
R_R_VOUT_S         VOUT_S N112292 R_NOISELESS 100
V_VCM_MAX         N30136 VCC_B -3.2
V_VCM_MIN         N28602 VEE_B 0
X_AOL_1         N31014 N11991 MID AOLNET AOL_1_OPA818 
X_AOL_2         AOLNET MID MID N78838 AOL_2_OPA818 
X_CLAWN         MID VIMON VEE_B N38050 CLAWN_OPA818 
X_CLAWP         VIMON MID N35669 VCC_B CLAWP_OPA818 
X_ESD_OUT         OUT VCC VEE ESD_OUT_OPA818 
X_E_N         ESDP N06456 VNSE_OPA818 
X_H3    OUT N516723 N110431 MID 08_OP_AMP_COMPLETE_H3_OPA818 
X_IQ_N         MID VIMON MID VEE IQ_SRC_OPA818 
X_IQ_P         VIMON MID VCC MID IQ_SRC_OPA818 
X_S1    OUT VCC_CLP N78838 MID 08_OP_AMP_COMPLETE_S1_OPA818 
X_S2    VEE_CLP OUT N78838 MID 08_OP_AMP_COMPLETE_S2_OPA818 
X_VCM_CLAMP         N25816 MID N30913 MID N30136 N28602 VCM_CLAMP_OPA818 
X_VOS_DRIFT         N749288 N06456 VOS_DRIFT_OPA818 
X_VOS_VS_VCM         N10561 N749288 VCC VEE VOS_VS_VCM_OPA818 
.ENDS  OPA818
*
.SUBCKT 08_OP_AMP_COMPLETE_H3_OPA818 1 2 3 4  
H_H3         3 4 VH_H3 -1E3
VH_H3         1 2 0V
.ENDS  08_OP_AMP_COMPLETE_H3_OPA818
*
.SUBCKT 08_OP_AMP_COMPLETE_S1_OPA818 1 2 3 4  
S_S1         3 4 1 2 _S1
RS_S1         1 2 1G
.MODEL         _S1 VSWITCH ROFF=2MEG RON=0.05 VOFF=-1 VON=1
.ENDS  08_OP_AMP_COMPLETE_S1_OPA818
*
.SUBCKT 08_OP_AMP_COMPLETE_S2_OPA818 1 2 3 4  
S_S2         3 4 1 2 _S2
RS_S2         1 2 1G
.MODEL         _S2 VSWITCH ROFF=2MEG RON=0.05 VOFF=-1 VON=1
.ENDS  08_OP_AMP_COMPLETE_S2_OPA818
*
.SUBCKT AOL_1_OPA818 VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 1E-4
.PARAM IPOS = .5
.PARAM INEG = -.5
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),INEG,IPOS)}
.ENDS  AOL_1_OPA818
*
.SUBCKT AOL_2_OPA818 VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 10E-3
.PARAM IPOS = 85E-3
.PARAM INEG = -80E-3
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),INEG,IPOS)}
.ENDS  AOL_2_OPA818
*
.SUBCKT CLAWN_OPA818 VC+ VC- IOUT+ IOUT-
G1 IOUT+ IOUT- TABLE {(V(VC+,VC-))} =
+(0, 1.2E-3)
+(80, 1.25E-3)
+(85, 1.31E-3)
+(95, 2.08E-3)
+(103, 2.96E-3)
+(108, 3.48E-3)
+(113, 5.07E-3)
+(116, 6.41E-3)
+(118, 1.07E-2)
.ENDS  CLAWN_OPA818
*
.SUBCKT CLAWP_OPA818 VC+ VC- IOUT+ IOUT-
G1 IOUT+ IOUT- TABLE {(V(VC+,VC-))} =
+(0, 9E-4)
+(40, 1E-3)
+(73, 1.02E-3)
+(118, 1.21E-3)
+(123, 1.63E-3)
+(128, 2.33E-3)
+(133, 2.87E-3)
+(138, 6.32E-3)
+(143, 1.08E-2)
.ENDS  CLAWP_OPA818
*
.SUBCKT ESD_OUT_OPA818 OUT VCC VEE
.MODEL ESD_SW VSWITCH(RON=50 ROFF=1E12 VON=500E-3 VOFF=450E-3)
S1 VCC OUT OUT VCC ESD_SW
S2 OUT VEE VEE OUT ESD_SW
.ENDS  ESD_OUT_OPA818
*
.SUBCKT IQ_SRC_OPA818 VC+ VC- IOUT+ IOUT-
.PARAM GAIN = 1E-3
G1 IOUT+ IOUT- VALUE={IF( (V(VC+,VC-)<=0),0,GAIN*V(VC+,VC-) )}
.ENDS  IQ_SRC_OPA818
*
.SUBCKT VCM_CLAMP_OPA818 VIN+ VIN- IOUT- IOUT+ VP+ VP-
.PARAM GAIN = 1
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VIN+,VIN-),V(VP-,VIN-), V(VP+,VIN-))}
.ENDS  VCM_CLAMP_OPA818
*
.SUBCKT VNSE_OPA818 1 2
.PARAM FLW=0.1
.PARAM NLF=811
.PARAM NVR=2.2
.PARAM GLF={PWR(FLW,0.25)*NLF/1164}
.PARAM RNV={1.184*PWR(NVR,2)}
.MODEL DVN D KF={PWR(FLW,0.5)/1E11} IS=1.0E-16
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVN
D2 8 0 DVN
E1 3 6 7 8 {GLF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNV}
R5 5 0 {RNV}
R6 3 4 1E9
R7 4 0 1E9
E3 1 2 3 4 1
.ENDS  VNSE_OPA818
*
.SUBCKT VOS_DRIFT_OPA818 VOS+ VOS-
.PARAM DC = 210E-6
.PARAM POL = 1
.PARAM DRIFT = 20E-6
E1 VOS+ VOS- VALUE={DC+POL*DRIFT*(TEMP-27)}
.ENDS  VOS_DRIFT_OPA818
*
.SUBCKT VOS_VS_VCM_OPA818 V+ V- REF+ REF-
E1 V+ 1 TABLE {(V(REF+, V-))} =
+(0.35, 450E-6)
+(0.4, 435E-6)
+(0.55, 275E-6)
+(0.65, 150E-6)
+(0.75, 75E-6)
+(0.85, 25E-6)
+(1, 0)
V1 1 V- 0
.ENDS  VOS_VS_VCM_OPA818
*
