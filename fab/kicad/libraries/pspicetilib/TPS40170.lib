*$
* TPS40170
*****************************************************************************
* (C) Copyright 2011 Texas Instruments Incorporated. All rights reserved.
*****************************************************************************
** This model is designed as an aid for customers of Texas Instruments.
** TI and its licensors and suppliers make no warranties, either expressed
** or implied, with respect to this model, including the warranties of
** merchantability or fitness for a particular purpose. The model is
** provided solely on an "as is" basis. The entire risk as to its quality
** and performance is with the customer
*****************************************************************************
*
** Released by: Analog eLab Design Center, Texas Instruments Inc.
* Part: TPS40170
* Date: 07JUL2011
* Model Type: Transient
* Simulator: PSpice
* Simulator Version: 16.0.0.p001
* EVM Order Number: TPS40170EVM-578  
* EVM Users Guide: SLVU436 – January 2011
* Datasheet: SLUS970 – February 2011
* Model Version: Final 1.10
*
*****************************************************************************
*
* Updates:
*
* Final 1.10
* Fixed OCP and SCP current limit levels
*
* Final 1.00
* Release to Web.
*
***************************************************************************
.SUBCKT TPS40170 SYNC FB HDRV RT SS SW PGND AGND TRK COMP M/S PGOOD VBP VDD VIN LDRV ILIM UVLO BOOT ENABLE
E_U3_GAIN1 U3_N144236 0 VALUE {1 * V(FB)}
V_U3_V4 U3_N133169 0 10
D_U3_D2 0 COMP D300
E_U3_ABM2 U3_REF 0 VALUE { MIN(V(U3_N2752920), V(TRK)) }
X_U3_U11          COMP U3_N133169 DC_1mV_1mA_1V_1nA
X_U3_U10         U3_REF U3_N144236 U3_N132154 op_amp PARAMS: PARAMS:  HLIMIT=10
+ RIN=23.3MEG BW=10MEG DC_GAIN=90 ROUT=100 LLIMIT=0 SRP=10 SRM=10
X_U3_S2    U3_DISABLE_EA 0 COMP 0 ERROR_AMP_U3_S2 
C_U3_C2 U3_N132154 COMP 1p
X_U3_U13         CALIBRATION OCFLT U3_DISABLE_EA OR2_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
E_U3_ABM3 U3_N2752920 0 VALUE { MIN(V(SS_EAMP), 0.6) }
G_U3_G2 U3_N132154 COMP TABLE { V(U3_N132154, COMP) }
+ ( (-10,-2.2m)(-1m,-2m)(0,0)(1m,2m)(10,2.2m) )
G_U1_G1 VIN UVLO U1_VIN_OK 0 5u
X_U1_U27         UVLO U1_N2805279 U1_VIN_OK COMP_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=0.5
X_U1_U24         ENABLE U1_N253044 U1_N253445 ENOK COMPHYS_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=0.5
R_U1_R14 0 UVLO 10Meg
X_U1_U33         OCFLT U1_DISCHARGE_ENABLED U1_DISCHARGE AND2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U1_U30         OCFLT U1_OCFLT_N INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
G_U1_ABMII1 VDD SS VALUE { { IF (V(U1_CHARGE) > 0.5, 11.6u, 0) } }
X_U1_U28         ENOK U1_VIN_OK BP_OK VDD_OK RUN AND4_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
E_U1_ABM4 U1_N160998 0 VALUE { (V(SS) * 0.57) - 0.37 }
X_U1_U19         SS U1_N2861276 SS_COMPLETE COMP_BASIC
V_U1_V6 U1_N2869841 0 0.3
X_U1_U20         U1_N2869841 SS CSS_DISCHARGED COMP_BASIC
E_U1_ABM3 SS_EAMP 0 VALUE { MAX (V(U1_N160998), 0) }
X_U1_S1    U1_N2857755 0 SS 0 EN_SS_U1_S1 
V_U1_V5 U1_N2861276 0 2.5
X_U1_U16         SS_EAMP U1_N163802 NORMAL_OC COMP_BASIC
R_U1_R15 ENABLE 0 10Meg
X_U1_U32         SS_COMPLETE CSS_DISCHARGED U1_DISCHARGE_ENABLED N2879291
+ SRLATCHRHP_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=0.5
X_U1_U31         CALIBRATION_N U1_N2885403 U1_CHARGE AND2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
V_U1_V7 U1_N253044 0 600m
X_U1_U34         OCFLT U1_DISCHARGE_ENABLED U1_N2885403 NAND2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
V_U1_V4 U1_N163802 0 0.7
V_U1_V8 U1_N253445 0 500m
G_U1_ABMII2 VDD SS VALUE { { IF (V(SS) < 0.5 & V(U1_CHARGE) > 0.5,
+ 40.4u, 0) } }
D_U1_D1 SS VDD D_D1
X_U1_U29         CALIBRATION_N RUN U1_N2857755 NAND2_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
V_U1_V133 U1_N2805279 0 0.9Vdc
G_U1_ABMII3 SS 0 VALUE { { IF (V(U1_DISCHARGE) > 0.5, 0.95u, 0) } }
R_R1 AGND 0 1m
X_U8_U11         U8_N160856 U8_N160840 DELAY_TPS40170 PARAMS:  T=60  
X_U8_U38         U8_N160968 HDRV U8_N160778 COMP_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=0.5
D_U8_D5 HDRV BOOT DIDEAL
R_U8_R1 U8_N161046 BOOT 15
D_U8_D41 VBP U8_N161046 Dbreak
X_U8_S1    U8_PWMH2 0 BOOT HDRV DRIVER_U8_S1 
D_U8_D7 0 LDRV DIDEAL
X_U8_U36         PWML U8_N197252 U8_N160440 AND2_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U8_U37         PWMH U8_N160840 U8_PWMH2 AND2_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
V_U8_V2 U8_N160896 0 1
X_U8_U31         U8_N160494 U8_N160440 U8_N160354 AND2_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
X_U8_U41         U8_N160440 U8_N160432 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U8_S2    U8_N161016 0 HDRV SW DRIVER_U8_S2 
X_U8_U32         U8_N160494 U8_N160432 U8_N160282 AND2_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
X_U8_S3    U8_N160354 0 VBP LDRV DRIVER_U8_S3 
D_U8_D4 LDRV VBP DIDEAL
D_U8_D6 SW HDRV DIDEAL
X_U8_U40         U8_PWMH2 U8_N161016 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U8_S4    U8_N160282 0 LDRV 0 DRIVER_U8_S4 
V_U8_V3 U8_N160968 SW 1
X_U8_U42         CAL U8_N160494 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U8_U39         U8_N160896 LDRV U8_N160856 COMP_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=0.5
X_U8_U12         U8_N160778 U8_N197252 DELAY_TPS40170 PARAMS: T=50  
E_U2_ABM6 U2_N2751353 0 VALUE { {IF(V(U2_N2752015) > 0.5, V(VIN), 0)}
+ }
E_U2_LIMIT2 U2_N2852277 0 VALUE {LIMIT(V(U2_N2852303),0,0.4)}
E_U2_ABM5 U2_N2747011 0 VALUE { {IF(V(U2_N2751353) > 8, 8,
+ V(U2_N2751353))} }
X_U2_S1    U2_DISABLE 0 U2_N2852111 0 LDO_U2_S1 
R_U2_R7 U2_N2857881 VBP 60
G_U2_G4 VIN VBP U2_N2747005 0 0.1
X_U2_S2    U2_DISABLE 0 U2_N2857881 0 LDO_U2_S2 
V_U2_V3 U2_N1708233 0 300m
X_U2_U6         ENOK U2_DISABLE INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
R_U2_R10 U2_N2852111 VDD 60
E_U2_E5 U2_N2852303 0 U2_N2852253 VDD 1
E_U2_LIMIT1 U2_N2747005 0 VALUE {LIMIT(V(U2_N2747043),0,1.75)}
X_U2_U3         VDD U2_N2855787 VDD_OK COMP_BASIC
V_U2_V2 U2_N2855787 0 3
E_U2_E4 U2_N2747043 0 U2_N2747011 VBP 1
X_U2_U4         VBP U2_N161218 U2_N1708233 BP_OK COMPHYS_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=0.5
G_U2_G5 VBP VDD U2_N2852277 0 0.1
E_U2_ABM8 U2_N2852067 0 VALUE { {IF(V(ENOK) > 0.5, V(VBP), 0)} }
V_U2_V1 U2_N161218 0 4.15
E_U2_ABM2 U2_N2750084 0 VALUE { {IF(V(VIN) > 3, 1, 0)} }
X_U2_U5         U2_N2750084 ENOK U2_N2752015 AND2_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
E_U2_ABM7 U2_N2852253 0 VALUE { {IF(V(U2_N2852067) > 3.3, 3.3,
+ V(U2_N2852067))} }
X_U10         OCFLT N592387 INV_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
X_U7_U43         U7_MAX_DUTY_CYCLE CT U7_MAX_DUTY_B COMP_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=0.5
X_U7_U36         U7_RAMP2 COMP U7_N200633 COMP_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=0.5
D_U7_D41 U7_N16922098 U7_N16922475 Dbreak
X_U7_U40         U7_N168103 U7_DRV_ENABLE PWML AND2_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
X_U7_U273         U7_DRV_ENABLE U7_DRV_DISABLE INV_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
I_U7_I1 U7_N16922118 U7_N16922098 DC 1uAdc
X_U7_U272         OCFLT U7_N16926810 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
I_U7_I2 U7_N16922094 0 DC 20uAdc
X_U7_U41         U7_N16926810 RUN U7_DRV_ENABLE AND2_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
X_U7_U276         U7_N16922230 U7_N16922122 U7_N16922264 OR2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U7_U46         PWMH U7_DRV_DISABLE U7_SW_START N16934377 SRLATCHRHP_BASIC_GEN
+ PARAMS: VDD=1 VSS=0 VTHRESH=0.5
V_U7_V14 U7_N16922173 0 0.8Vdc
V_U7_V3 U7_MAX_DUTY_CYCLE 0 0.95
X_U7_U45         U7_CLKB U7_N210378 U7_PWM_BEFORE AND2_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
D_U7_D42 U7_N16922173 U7_N16922094 Dbreak
X_U7_U48         U7_CLKB U7_CLOCK_EX U7_N16922122 AND2_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
X_U7_U275         U7_N16922098 U7_N16922094 U7_LDRV_SS COMP_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=0.5
X_U7_U35         U7_N16964863 U7_N16964877 BUFFER_PS PARAMS: VHI=1 VLO=0
+ VTHRESH=500E-3 TPLH=20E-9 TPHL=20E-9 TR=1E-9 TF=1E-9
R_U7_R6 U7_N16922475 U7_N16922118 10k
X_U7_U30         U7_N114697 U7_LDRV_SS U7_SW_START U7_N168103 AND3_BASIC_GEN
+ PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
V_U7_V12 U7_RAMP2 CT 1Vdc
C_U7_C2 0 U7_N16922094 10p IC=0
X_U7_U42         PWMH U7_N114697 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
C_U7_C3 0 U7_N16922098 30p IC=0
X_U7_U39         CLK U7_CLKB INV_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
X_U7_U44         U7_PWM_BEFORE U7_DRV_ENABLE PWMH AND2_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
X_U7_U26         CLK U7_N200633 U7_N210378 N204543 SRLATCHRHP_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=0.5
V_U7_V13 U7_N16922118 0 3.3Vdc
X_U7_S2    U7_N16922264 0 U7_N16922118 U7_N16922094 PWMOSC_U7_S2 
X_U7_U47         U7_CLKB U7_N16964863 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U7_S3    U7_N16922230 0 U7_N16922098 0 PWMOSC_U7_S3 
X_U7_U274         U7_SW_START U7_N16922230 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U7_U50         U7_N16964877 U7_N16964863 U7_CLOCK_EX OR2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
G_U4_ABMII1 U4_N2936428 U4_LDRV_CAL VALUE { {IF (V(CAL) > 0.5, 10u, 0)}
+ }
X_U4_U282         U4_N2948810 U4_N225874 U4_OPEN N2948830 SRLATCHRHP_BASIC_GEN
+ PARAMS: VDD=1 VSS=0 VTHRESH=0.5
V_U4_V1 U4_N2936428 0 240m
X_U4_U29         CAL U4_N2948662 U4_N2948810 AND2_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U4_CALIB_TIMING_U161         CAL U4_CALIB_TIMING_N2809565 one_shot_1 PARAMS:
+ PARAMS: T=50
X_U4_CALIB_TIMING_U4         RUN U4_CALIB_TIMING_N2809661 INV_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U4_CALIB_TIMING_U171         U4_CALIB_TIMING_N2809565
+ U4_CALIB_TIMING_N2809661 CALIBRATION_N CALIBRATION SRLATCHRHP_BASIC_GEN
+ PARAMS: VDD=1 VSS=0 VTHRESH=0.5
X_U4_CALIB_TIMING_U6         RUN U4_CALIB_TIMING_N2809723 one_shot PARAMS:
+ PARAMS: T=50e3
X_U4_CALIB_TIMING_U14         U4_CALIB_TIMING_N2809723 CAL one_shot_1 PARAMS:
+ PARAMS: T={(750-(700*SS)) * 1e3}
R_U4_R4 0 A 1
X_U4_U21         CAL U4_N226689 U4_N225782 AND2_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U4_S2    CAL 0 U4_LDRV_CAL LDRV COMP_CALIB_U4_S2 
G_U4_ABMI4 0 A VALUE { if( V(U4_OPEN)>0.5 ,7.25,
+ if( V(U4_20K)>0.5,16.4,
+ if( V(U4_10K)>0.5,3.2,7.25) ) ) }
X_U4_U24         U4_N227004 U4_N225874 U4_20K N227440 SRLATCHRHP_BASIC_GEN
+ PARAMS: VDD=1 VSS=0 VTHRESH=0.5
X_U4_U30         RUN U4_N225874 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U4_U25         CAL U4_N236835 U4_N227004 AND2_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
V_U4_V4 U4_N119463 0 0.08
D_U4_D2 U4_LDRV_CAL U4_N2936428 D_D1
V_U4_V5 U4_N119519 0 0.18
X_U4_U20         U4_N225782 U4_N225874 U4_10K N225967 SRLATCHRHP_BASIC_GEN
+ PARAMS: VDD=1 VSS=0 VTHRESH=0.5
X_U4_U15         U4_LDRV_CAL U4_N119463 U4_N226689 COMP_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=0.5
X_U4_U162         U4_LDRV_CAL U4_N119519 U4_N236835 COMP_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=0.5
X_U4_U172         U4_LDRV_CAL U4_N2948636 U4_N2948662 COMP_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=0.5
V_U4_V6 U4_N2948636 0 0.28
X_U5_S2    U5_N14748523 0 PGOOD 0 PGOOD_U5_S2 
X_U5_U40         U5_N14728952 U5_N14728944 RUN U5_N14729244 U5_N14748523
+ NAND4_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
V_U5_V2 U5_N14736445 0 0.647
X_U5_U13         SS_COMPLETE U5_N14729018 U5_N14728952 AND2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
V_U5_V4 U5_N14729286 0 0.552
X_U5_U37         U5_N14736445 U5_N14729274 U5_N14728944 COMP_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=0.5
X_U5_U38         FB U5_N14729304 U5_N14729244 COMP_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=0.5
X_U5_U17         OCFLT U5_N14729018 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
E_U5_E4 FB U5_N14729274 U5_N14728944 0 0.004
E_U5_E5 U5_N14729286 U5_N14729304 U5_N14729244 0 0.004
X_U6_U97         U6_Q0B U6_Q1B U6_Q2B U6_X U6_N2978628 AND4_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U103         U6_N2976676 U6_Q1 U6_Q2 U6_N2976512 AND3_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U122         U6_N3239945 U6_N2975746 U6_Y N3081633 SRLATCHRHP_BASIC_GEN
+ PARAMS: VDD=1 VSS=0 VTHRESH=0.5
X_U6_U126         U6_N3133255 U6_XY_RESET one_shot_1 PARAMS: PARAMS:  T=50  
X_U6_U86         HDRV U6_N2975986 U6_HDRV_HIGH COMP_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=0.5
X_U6_U124_U1         U6_N2978548 U6_N2978674 U6_N2978700 U6_N2978628
+ U6_U124_N00318 OR4_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U124_U2         U6_U124_N00318 U6_Y U6_N3116510 OR2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U120         U6_Q2 U6_Q1 U6_Q0 OCFLT AND3_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U6_U104         U6_N2976688 U6_N2976692 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U6_U111         U6_N2977724 U6_XY_RESET U6_RESET_SM U6_N2978050 OR3_BASIC_GEN
+ PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U89         U6_HDRV_HIGH U6_N2976880 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U6_U114         CSS_DISCHARGED U6_N2975396 U6_RESET_SM OR2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U92         CLK U6_CLOCK_BAR INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U6_U107         U6_Q2 U6_N2975532 U6_N2975600 AND2_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
X_U6_U6         U6_HDRV_HIGH U6_N2977028 UTD_TPS40007AVG PARAMS: K=1 TD=220n
X_U6_U5         U6_LDRV_HIGH U6_N2978062 UTD_TPS40007AVG PARAMS: K=1 TD=55n
X_U6_U113         U6_Q0 U6_X U6_N2976688 XOR2_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
V_U6_V1 U6_N2978184 0 2.2Vdc
X_U6_U85         LDRV U6_N2978184 U6_LDRV_HIGH COMP_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=0.5
X_U6_U105         U6_Q1 U6_Q0 U6_X U6_N2975532 OR3_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
X_U6_U116         U6_LDRV_HIGH U6_N2977724 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U6_U102         U6_N2976692 U6_Q1B U6_Q2 U6_N2976630 AND3_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U88         U6_N2977670 U6_N2977028 U6_HDRV_HIGH U6_N3239945
+ AND3_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U109         U6_Q0 U6_X U6_Q1B U6_Q2B U6_N2976658 AND4_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
G_U6_ABMII2 VDD ILIM VALUE { {IF(V(RUN)>0.5,10u,0)} }
X_U6_U118         U6_Q1 U6_Q1B U6_CLOCK_BAR U6_N3120549 U6_RESET_SM U6_Y
+ DFFSR_RHPBASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U123_U1         U6_N2976512 U6_N2976630 U6_N2976644 U6_N2976658
+ U6_U123_N00318 OR4_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U123_U2         U6_U123_N00318 U6_Y U6_N3120549 OR2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U87         U6_V_SC SW U6_N2977670 COMP_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=0.5
X_U6_U121         U6_N2978054 U6_N2978050 U6_X N3077128 SRLATCHRHP_BASIC_GEN
+ PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_U6_ABM5 U6_OCP 0 VALUE { {IF(V(NORMAL_OC)>0.5,V(ILIM),
+ 1.5*(V(ILIM)))} }
X_U6_U106         U6_Q0 U6_X U6_N2976676 OR2_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
V_U6_V3 U6_N2975986 SW 2.2Vdc
X_U6_U98         U6_Q0B U6_Q1 U6_Q2B U6_N2978700 AND3_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
X_U6_U101         U6_N2976688 U6_Q1 U6_Q2B U6_N2976644 AND3_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
E_U6_ABM6 U6_V_SC 0 VALUE { V(VIN) - V(U6_SCP) }
D_U6_D1 ILIM VDD D_D1
X_U6_U90         U6_N2976880 U6_XY_RESET U6_RESET_SM U6_N2975746 OR3_BASIC_GEN
+ PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
E_U6_MULT1 U6_SCP 0 VALUE {V(A)*V(U6_OCP)}
X_U6_U99         U6_Q0B U6_Q1B U6_Q2 U6_N2978674 AND3_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
X_U6_U108         U6_Q2B U6_Q1 U6_Q0 U6_X U6_N2975680 AND4_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
E_U6_E3 U6_N2978874 0 SW 0 -1
X_U6_U117         U6_Q2 U6_Q2B U6_CLOCK_BAR U6_N3117424 U6_RESET_SM U6_Y
+ DFFSR_RHPBASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U119         U6_Q0 U6_Q0B U6_CLOCK_BAR U6_N3116510 U6_RESET_SM U6_Y
+ DFFSR_RHPBASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U112         U6_N2978874 U6_OCP U6_N2978088 COMP_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=0.5
X_U6_U110         U6_N2975680 U6_N2975600 U6_Y U6_N3117424 OR3_BASIC_GEN
+ PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U115         U6_N2978088 U6_N2978062 U6_LDRV_HIGH U6_N2978054
+ AND3_BASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
X_U6_U91         RUN U6_N2975396 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U6_U125         CLK U6_N3133255 one_shot_1 PARAMS: PARAMS:  T=50  
X_U6_U100         U6_Q1 U6_Q2 U6_N2978548 AND2_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
E_U9_ABM25 U9_N2897726 0 VALUE {
+ {IF((V(CALIBRATION)<0.5),V(U9_N2897628),2e-06)} }
X_U9_U6         U9_N2897742 U9_N2897880 UTD_TPS40007AVG PARAMS: K=1 TD=50n
E_U9_ABM23 U9_N2898154 0 VALUE {
+ {IF((V(CALIBRATION)<0.5),V(U9_N2897800),1)} }
X_U9_U138         CT U9_N2897632 U9_N2897886 COMP_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=0.5
V_U9_V6 U9_N2689936 0 2.0Vdc
X_U9_U115         U9_SYNC_IN U9_N2689954 U9_N2690152 AND2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U9_U132         U9_SYNC_Y U9_N2897742 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
R_U9_R12 0 SYNC 10Meg
X_U9_U128         U9_N2897880 U9_SYNC_Y U9_SYNC_PLS AND2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U9_U137         CT U9_N2897788 U9_N2897766 COMP_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=0.5
R_U9_R6 U9_N2689534 U9_N2689298 10
X_U9_U118         U9_N2689448 U9_N2689344 U9_N2689298 COMP_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=0.5
X_U9_U119         U9_N2689298 U9_SYNC_ACTIVE INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U9_U139         U9_SYNC_0 U9_SYNC_180 CLK U9_N2690546 RUN U9_HI
+ DFFSBRB_RHPBASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
E_U9_ABM26 U9_N2897632 0 VALUE {
+ {IF((V(U9_N2897640)<0.5),V(U9_N2898154),1.4*V(U9_N2898154))} }
X_U9_U136         U9_SYNC_PLS U9_N2897886 U9_N2897906 OR2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U9_U110         M/S U9_N2689936 U9_N2690450 COMP_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=0.5
V_U9_V5 U9_N2689896 0 1.0Vdc
X_U9_U133         CALIBRATION U9_CAL_BAR INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U9_U111         U9_SYNC_IN U9_N2689866 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U9_U117         U9_N2690152 U9_N2690174 U9_X OR2_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
V_U9_V7 U9_HI 0 1
R_U9_R17 U9_N2897570 CT 100
X_U9_U3         U9_N2897906 U9_N3244723 UTD_TPS40007AVG PARAMS: K=1 TD=170n
R_U9_R4 0 M/S 750k
X_U9_U131         U9_N2897766 U9_N2898064 U9_N2897962 AND2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U9_U126         U9_SYNC_ACTIVE U9_SYNC_RUN U9_N2897858 AND2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U9_U121         U9_SYNC_IN U9_N2689326 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
E_U9_GAIN8 U9_N2897788 0 VALUE {1/30 * V(VIN)}
X_U9_U134         N592387 RUN U9_N2897684 AND2_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
C_U9_C3 0 U9_N2689534 1n IC=0
X_U9_HSYNC5    U9_N2897800 RT U9_N2897628 0 OSCILLATOR_SYNC_U9_HSYNC5 
I_U9_I1 0 U9_N2689448 DC 1uAdc
X_U9_U143         U9_N2897684 U9_N3224396 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U9_U39_S2    U9_SYNC_180 0 U9_SYNC_IN U9_SYNC_X ANALOGMUX_U9_U39_S2 
X_U9_U39_S1    U9_U39_N00398 0 U9_N2689326 U9_SYNC_X ANALOGMUX_U9_U39_S1 
X_U9_U39_U1         U9_SYNC_180 U9_U39_N00398 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U9_U116         U9_N2689866 U9_N2689980 U9_N2690174 AND2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
R_U9_R8 SYNC U9_N2689254 1k
X_U9_U144         U9_N3244723 U9_N3224396 U9_N3228902 OR2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=100E-3
X_U9_U129         U9_SLAVE U9_SYNC_ACTIVE U9_N2897640 AND2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
X_U9_S1    U9_X 0 U9_N2689448 0 OSCILLATOR_SYNC_U9_S1 
X_U9_S3    U9_N2897736 0 CT 0 OSCILLATOR_SYNC_U9_S3 
X_U9_U114         U9_N2689980 U9_N2689954 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
C_U9_CT4 0 CT 100p IC=0
X_U9_S2    CLK 0 U9_N2897570 0 OSCILLATOR_SYNC_U9_S2 
E_U9_ABM21 U9_SYNC_OUT 0 VALUE { {IF(V(U9_N2897962)>0.5,V(VBP),0)} }
R_U9_R15 0 RT 1G
X_U9_U140         U9_MASTER U9_SLAVE CLK U9_N2690450 RUN U9_HI
+ DFFSBRB_RHPBASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
X_U9_U120         U9_N2689348 U9_SLAVE U9_SYNC_IN AND2_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
R_U9_R3 M/S U9_N2689286 900k
X_U9_U141         U9_N2898064 N3194383 U9_N2897766 U9_HI U9_N2898106 U9_HI
+ DFFSBRB_RHPBASIC_GEN PARAMS: VDD=1 VSS=0 VTHRESH=500E-3
X_U9_U40_S2    U9_SLAVE 0 U9_N2689348 U9_N2689254 ANALOGMUX_U9_U40_S2 
X_U9_U40_S1    U9_U40_N00398 0 U9_SYNC_OUT U9_N2689254 ANALOGMUX_U9_U40_S1 
X_U9_U40_U1         U9_SLAVE U9_U40_N00398 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U9_U109         M/S U9_N2689896 U9_N2690546 COMP_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=0.5
X_U9_U127         RUN U9_CAL_BAR U9_SYNC_RUN AND2_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
V_U9_V4 U9_N2689340 0 2.0Vdc
X_U9_U113         U9_N2689866 U9_N2689930 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
X_U9_U142         U9_N2897906 U9_N3228902 CLK N3248566 SRLATCHRHP_BASIC_GEN
+ PARAMS: VDD=1 VSS=0 VTHRESH=0.3
X_U9_U125         U9_SYNC_X U9_N2897858 U9_SYNC_Y AND2_BASIC_GEN PARAMS: VDD=1
+ VSS=0 VTHRESH=500E-3
E_U9_ABM22 U9_N2897800 0 VALUE { {IF((V(RUN)>0.5),V(VIN)/15,0)} }
X_U9_U135         U9_N2897684 U9_N2897736 INV_BASIC_GEN PARAMS: VDD=1 VSS=0
+ VTHRESH=500E-3
E_U9_E1 U9_N2689340 U9_N2689344 U9_N2689534 0 1
E_U9_GAIN5 U9_N2689286 0 VALUE {1 * V(VDD)}
X_U9_U5         U9_N2689930 U9_N2689980 UTD_TPS40007AVG PARAMS: K=1 TD=100n
X_U9_U130         U9_SYNC_RUN U9_MASTER U9_N2898106 AND2_BASIC_GEN PARAMS:
+ VDD=1 VSS=0 VTHRESH=500E-3
G_U9_ABM2I1 0 CT VALUE { {IF((V(CLK)<0.5),V(U9_N2897726),0)} }
C_U9_C1 0 U9_N2689448 10p IC=0
R_R18 PGND 0 1m
.PARAM ss=0
.ENDS TPS40170
*$
.subckt ERROR_AMP_U3_S2 1 2 3 4
S_U3_S2 3 4 1 2 _U3_S2
RS_U3_S2 1 2 1G
.MODEL         _U3_S2 VSWITCH Roff=1e7 Ron=1.0 Voff=0.25V Von=0.75V
.ends ERROR_AMP_U3_S2
*$
.subckt EN_SS_U1_S1 1 2 3 4
S_U1_S1 3 4 1 2 _U1_S1
RS_U1_S1 1 2 1G
.MODEL         _U1_S1 VSWITCH Roff=10e6 Ron=1m Voff=0.0V Von=1.0V
.ends EN_SS_U1_S1
*$
.subckt DRIVER_U8_S1 1 2 3 4
S_U8_S1 3 4 1 2 _U8_S1
RS_U8_S1 1 2 1G
.MODEL         _U8_S1 VSWITCH Roff=1e9 Ron=2.64 Voff=0.25V Von=0.75V
.ends DRIVER_U8_S1
*$
.subckt DRIVER_U8_S2 1 2 3 4
S_U8_S2 3 4 1 2 _U8_S2
RS_U8_S2 1 2 1G
.MODEL         _U8_S2 VSWITCH Roff=1e9 Ron=2.4 Voff=0.25V Von=0.75V
.ends DRIVER_U8_S2
*$
.subckt DRIVER_U8_S3 1 2 3 4
S_U8_S3 3 4 1 2 _U8_S3
RS_U8_S3 1 2 1G
.MODEL         _U8_S3 VSWITCH Roff=1e9 Ron=2.4 Voff=0.25V Von=0.75V
.ends DRIVER_U8_S3
*$
.subckt DRIVER_U8_S4 1 2 3 4
S_U8_S4 3 4 1 2 _U8_S4
RS_U8_S4 1 2 1G
.MODEL         _U8_S4 VSWITCH Roff=1e9 Ron=1.1 Voff=0.25V Von=0.75V
.ends DRIVER_U8_S4
*$
.subckt LDO_U2_S1 1 2 3 4
S_U2_S1 3 4 1 2 _U2_S1
RS_U2_S1 1 2 1G
.MODEL         _U2_S1 VSWITCH Roff=10e6 Ron=1.0m Voff=0.0V Von=1.0V
.ends LDO_U2_S1
*$
.subckt LDO_U2_S2 1 2 3 4
S_U2_S2 3 4 1 2 _U2_S2
RS_U2_S2 1 2 1G
.MODEL         _U2_S2 VSWITCH Roff=10e6 Ron=1.0m Voff=0.0V Von=1.0V
.ends LDO_U2_S2
*$
.subckt PWMOSC_U7_S2 1 2 3 4
S_U7_S2 3 4 1 2 _U7_S2
RS_U7_S2 1 2 1G
.MODEL         _U7_S2 VSWITCH Roff=10e7 Ron=1m Voff=0.25V Von=0.75V
.ends PWMOSC_U7_S2
*$
.subckt PWMOSC_U7_S3 1 2 3 4
S_U7_S3 3 4 1 2 _U7_S3
RS_U7_S3 1 2 1G
.MODEL         _U7_S3 VSWITCH Roff=10e7 Ron=1m Voff=0.25V Von=0.75V
.ends PWMOSC_U7_S3
*$
.subckt COMP_CALIB_U4_S2 1 2 3 4
S_U4_S2 3 4 1 2 _U4_S2
RS_U4_S2 1 2 1G
.MODEL         _U4_S2 VSWITCH Roff=1e9 Ron=1 Voff=0.25V Von=0.75V
.ends COMP_CALIB_U4_S2
*$
.subckt PGOOD_U5_S2 1 2 3 4
S_U5_S2 3 4 1 2 _U5_S2
RS_U5_S2 1 2 1G
.MODEL         _U5_S2 VSWITCH Roff=10E6 Ron=30 Voff=0.2 Von=0.8
.ends PGOOD_U5_S2
*$
.subckt OSCILLATOR_SYNC_U9_HSYNC5 1 2 3 4
H_U9_HSYNC5 3 4 VH_U9_HSYNC5 1
VH_U9_HSYNC5 1 2 0V
.ends OSCILLATOR_SYNC_U9_HSYNC5
*$
.subckt ANALOGMUX_U9_U39_S2 1 2 3 4
S_U9_U39_S2 3 4 1 2 _U9_U39_S2
RS_U9_U39_S2 1 2 1G
.MODEL         _U9_U39_S2 VSWITCH Roff=10e6 Ron=1m Voff=0.2 Von=0.8
.ends ANALOGMUX_U9_U39_S2
*$
.subckt ANALOGMUX_U9_U39_S1 1 2 3 4
S_U9_U39_S1 3 4 1 2 _U9_U39_S1
RS_U9_U39_S1 1 2 1G
.MODEL         _U9_U39_S1 VSWITCH Roff=10e6 Ron=1m Voff=0.2 Von=0.8
.ends ANALOGMUX_U9_U39_S1
*$
.subckt OSCILLATOR_SYNC_U9_S1 1 2 3 4
S_U9_S1 3 4 1 2 _U9_S1
RS_U9_S1 1 2 1G
.MODEL         _U9_S1 VSWITCH Roff=1e7 Ron=1m Voff=0.2 Von=0.8
.ends OSCILLATOR_SYNC_U9_S1
*$
.subckt OSCILLATOR_SYNC_U9_S3 1 2 3 4
S_U9_S3 3 4 1 2 _U9_S3
RS_U9_S3 1 2 1G
.MODEL         _U9_S3 VSWITCH Roff=10e6 Ron=1m Voff=0.2 Von=0.8
.ends OSCILLATOR_SYNC_U9_S3
*$
.subckt OSCILLATOR_SYNC_U9_S2 1 2 3 4
S_U9_S2 3 4 1 2 _U9_S2
RS_U9_S2 1 2 1G
.MODEL         _U9_S2 VSWITCH Roff=10e6 Ron=1m Voff=0.2 Von=0.8
.ends OSCILLATOR_SYNC_U9_S2
*$
.subckt ANALOGMUX_U9_U40_S2 1 2 3 4
S_U9_U40_S2 3 4 1 2 _U9_U40_S2
RS_U9_U40_S2 1 2 1G
.MODEL         _U9_U40_S2 VSWITCH Roff=10e6 Ron=1m Voff=0.2 Von=0.8
.ends ANALOGMUX_U9_U40_S2
*$
.subckt ANALOGMUX_U9_U40_S1 1 2 3 4
S_U9_U40_S1 3 4 1 2 _U9_U40_S1
RS_U9_U40_S1 1 2 1G
.MODEL         _U9_U40_S1 VSWITCH Roff=10e6 Ron=1m Voff=0.2 Von=0.8
.ends ANALOGMUX_U9_U40_S1
*$
.subckt DC_1mV_1mA_1V_1nA A C
G1 A C TABLE { V(A, C) } ( (-1,-1n)(0,0)(1m,1m) (2m,100m) (3m,10) )
.ends DC_1mV_1mA_1V_1nA
*$
.subckt DC_1mV_1A_1V_1nA A C
G1 A C TABLE { V(A, C) } ( (-1,-1n)(0,0)(1m,1) (2m,10) (3m,1000) )
.ends DC_1mV_1A_1V_1nA
*$
.SUBCKT D_D 1 2
D1 1 2 DD
.MODEL DD D( IS=1F N=0.01 TT = 10p )
.ENDS D_D
*$
*.SUBCKT COMPARATOR INP INM OUT
*EOUT OUT 0 VALUE { IF( V(INP)>V(INM),1,0) }
*.ends COMPARATOR
*$
.SUBCKT ONE_SHOT IN OUT
+ PARAMs: T=100
S_S1 MEAS 0 RESET2 0 S1
E_ABM1 CH 0 VALUE { if( V(IN)>0.5 | V(OUT)>0.5,1,0) }
R_R2 RESET2 RESET 0.1
E_ABM3 OUT 0 VALUE { if( V(MEAS)<0.5 & V(CH)>0.5,1,0) }
R_R1 MEAS CH {T}
C_C2 0 RESET2 1.4427n
C_C1 0 MEAS 1.4427n
E_ABM2 RESET 0 VALUE { if(V(CH)<0.5,1,0) }
.MODEL         S1 VSWITCH Roff=1e9 Ron=1.0 Voff=0.25V Von=0.75V
.ENDS ONE_SHOT
*$
.SUBCKT ONE_SHOT_1 IN OUT
+ PARAMs: T=100
S_S1 MEAS 0 RESET2 0 S1
E_ABM1 CH 0 VALUE { if( V(IN)<0.5 | V(OUT)>0.5,1,0) }
R_R2 RESET2 RESET 0.1
E_ABM3 OUT 0 VALUE { if( V(MEAS)<0.5 & V(CH)>0.5,1,0) }
R_R1 MEAS CH {T}
C_C2 0 RESET2 1.4427n
C_C1 0 MEAS 1.4427n
E_ABM2 RESET 0 VALUE { if(V(CH)<0.5,1,0) }
.MODEL         S1 VSWITCH Roff=1e9 Ron=1.0 Voff=0.25V Von=0.75V
.ENDS ONE_SHOT_1
*$
*.SUBCKT AND_1 A B OUT
*EOUT OUT 0 VALUE { IF( V(A)>0.5 & V(B)<0.5,1,0) }
*.ends AND_1
*$
*.SUBCKT AND A B OUT
*EOUT OUT 0 VALUE { IF( V(A)>0.5 & V(B)>0.5,1,0) }
*.ends AND
*$
.SUBCKT DLATCH D CLK Q
EABM1 1 0 VALUE { If( (V(D)>0.5 & V(CLK)>0.5) | V(Q)>0.5, 1,0) }
EABM2 Q 0 VALUE { If( V(2)>0.5 & (V(CLK)<0.5 | V(D)>0.5) , 1,0) }
R1 1 2 1
C1 2 0 5n
.ENDS DLATCH
*$
*.SUBCKT INVERTER IN OUT
*EOUT OUT 0 VALUE { IF( V(IN)<0.5,1,0) }
*.ends INVERTER
*$
*.SUBCKT OR A B OUT
*EOUT OUT 0 VALUE { IF( V(A)>0.5 | V(B)>0.5,1,0) }
*.ends OR
*$
*.SUBCKT RSFF_RDOM R S Q
*EABM1 1 0 VALUE { If( V(S)>0.5 | V(Q)>0.5, 1,0) }
*EABM2 Q 0 VALUE { If( V(2)>0.5 & V(R)<0.5, 1,0) }
*R1 1 2 1
*C1 2 0 5n
*.ENDS RSFF_RDOM
*$
.model DIDEAL D Is=1e-14 Cjo=.1pF Rs=.1
*$
*.SUBCKT AND3 A B C OUT
*EOUT OUT 0 VALUE { IF( V(A)>0.5 & V(B)>0.5 & V(C)>0.5,1,0) }
*.ends AND3
*$
.SUBCKT DELAY_TPS40170 IN OUT
+ PARAMs: T=100
S_S1 MEAS 0 RESET2 0 S1
E_ABM1 CH 0 VALUE { if( V(IN)>0.5,1,0) }
E_ABM3 OUT 0 VALUE { if( V(MEAS)>0.5 & V(CH)>0.5,1,0) }
R_R1 MEAS CH {T}
C_C1 0 MEAS 1.4427n
E_ABM2 RESET 0 VALUE { if(V(CH)<0.5,1,0) }
R_R2 RESET2 RESET 0.1
C_C2 0 RESET2 1.4427n
.MODEL         S1 VSWITCH Roff=1e9 Ron=1.0 Voff=0.25V Von=0.75V
.ENDS DELAY_TPS40170
*$
.SUBCKT OSC FAULT RAMP CLK PARAMS: FREQ=100E3 TCLK=1E-6
VCLK CLK2 0 PULSE 0 1 {TON} 1n 1n {TCLK} {1/FREQ}
S1 RAMP 0 2 0 S1M
EOUT1 2 0 VALUE { if( V(FAULT)>0.5 | V(CLK)>0.5,1,0) }
EOUT2 CLK 0 VALUE { if( V(FAULT)<0.5,V(CLK2),0) }
ICH 0 RAMP DC {ICHARGE}
COSC 0 RAMP 1n IC=0
.PARAM ICHARGE={1E-9/TON} RON={TCLK/100/1E-9} TON={(1/FREQ)-TCLK}
.MODEL         S1M VSWITCH Roff=1G Ron=1m Voff=0.25 Von=0.75 
.ENDS OSC
*$
.MODEL D_D1 D( IS=1e-15 TT=10p Rs=0.05 N=.1  )
*$
.SUBCKT OP_AMP P M OUT
+ PARAMs: Hlimit=5 Rin=10Meg BW=18Meg DC_Gain=100 Rout=100 Llimit=0 SRP=1 SRM=1
R_Rin P M {Rin}
E_E1 5 0 M P {-Gain}
E_LIMIT2 6 0 VALUE {LIMIT(V(5), {-Abs(SRM)*Ca*1Meg+V(1)/Ra},
+ {SRP*Ca*1Meg+V(1)/Ra})}
G_G2 1 0 6 0 -1
R_Ra 0 1 {Ra}
C_Ca 0 1 {Ca}
E_LIMIT1 2 0 VALUE {LIMIT(V(1),{Llimit},{Hlimit})}
V_VL 3 0 {Llimit+200m}
V_VH 4 0 {Hlimit-200m}
D_D1 3 1 Dideal
D_D2 1 4 Dideal
R_Rout OUT 2 {Rout}
.model Dideal D Is=1e-10 Cjo=.01pF Rs=1m  N=1
.PARAM Ra=1k Ca={exp(DC_gain*log(10)/20)/(2*3.14159*BW*Ra)}
+ Gain={exp(DC_gain*log(10)/20)/Ra}
.ENDS OP_AMP
*$
.SUBCKT COMP_BASIC INP INM Y
*** Changed 5V output to 1V output ***
*E_ABM Yint 0 VALUE {IF (V(INP) >
*+ V(INM), 5,0)}
E_ABM Yint 0 VALUE {IF (V(INP) >
+ V(INM), 1,0)}
R1 Yint Y 1
C1 Y 0 1n
.ENDS COMP_BASIC
*$
.SUBCKT COMPHYS_BASIC_GEN INP INM HYS OUT PARAMS: VDD=1 VSS=0 VTHRESH=0.5
EIN INP1 INM1 INP INM 1
EHYS INP1 INP2 VALUE { IF( V(1) > {VTHRESH},-V(HYS),0) }
EOUT OUT 0 VALUE { IF( V(INP2)>V(INM1), {VDD} ,{VSS}) }
R1 OUT 1 1
C1 1 0 5n
RINP1 INP1 0 1K
.ENDS COMPHYS_BASIC_GEN
*$
.SUBCKT AND2_BASIC_GEN A B Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABMGATE YINT 0 VALUE {{IF(V(A) > {VTHRESH} &
+ V(B) > {VTHRESH},{VDD},{VSS})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS AND2_BASIC_GEN
*$
.SUBCKT AND3_BASIC_GEN A B C Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABMGATE YINT 0 VALUE {{IF(V(A) > {VTHRESH} &
+ V(B) > {VTHRESH} &
+ V(C) > {VTHRESH},{VDD},{VSS})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS AND3_BASIC_GEN
*$
.SUBCKT OR2_BASIC_GEN A B Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABMGATE YINT 0 VALUE {{IF(V(A) > {VTHRESH} |
+ V(B) > {VTHRESH},{VDD},{VSS})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS OR2_BASIC_GEN
*$
.SUBCKT OR3_BASIC_GEN A B C Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABMGATE YINT 0 VALUE {{IF(V(A) > {VTHRESH} |
+ V(B) > {VTHRESH} |
+ V(C) > {VTHRESH},{VDD},{VSS})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS OR3_BASIC_GEN
*$
.SUBCKT OR4_BASIC_GEN A B C D Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABMGATE YINT 0 VALUE {{IF(V(A) > {VTHRESH} |
+ V(B) > {VTHRESH} |
+ V(C) > {VTHRESH} |
+ V(D) > {VTHRESH},{VDD},{VSS})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS OR4_BASIC_GEN
*$
.SUBCKT NAND2_BASIC_GEN A B Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABMGATE YINT 0 VALUE {{IF(V(A) > {VTHRESH} &
+ V(B) > {VTHRESH},{VSS},{VDD})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS NAND2_BASIC_GEN
*$
.SUBCKT NAND3_BASIC_GEN A B C Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABMGATE YINT 0 VALUE {{IF(V(A) > {VTHRESH} &
+ V(B) > {VTHRESH} &
+ V(C) > {VTHRESH},{VSS},{VDD})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS NAND3_BASIC_GEN
*$
.SUBCKT NOR2_BASIC_GEN A B Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABMGATE YINT 0 VALUE {{IF(V(A) > {VTHRESH} |
+ V(B) > {VTHRESH},{VSS},{VDD})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS NOR2_BASIC_GEN
*$
.SUBCKT INV_BASIC_GEN A Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABMGATE YINT 0 VALUE {{IF(V(A) > {VTHRESH} ,
+ {VSS},{VDD})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS INV_BASIC_GEN
*$
.SUBCKT INV_DELAY_BASIC_GEN A Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5 DELAY = 10n
E_ABMGATE1 YINT1 0 VALUE {{IF(V(A) > {VTHRESH} ,
+ {VDD},{VSS})}}
RINT YINT1 YINT2 1
CINT YINT2 0 {DELAY*1.3}
E_ABMGATE2 YINT3 0 VALUE {{IF(V(YINT2) > {VTHRESH} ,
+ {VSS},{VDD})}}
RINT2 YINT3 Y 1
CINT2 Y 0 1n
.ENDS INV_DELAY_BASIC_GEN
*$
.SUBCKT BUF_BASIC_GEN A Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABMGATE YINT 0 VALUE {{IF(V(A) > {VTHRESH} ,
+ {VDD},{VSS})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS BUF_BASIC_GEN
*$
.SUBCKT BUF_DELAY_BASIC_GEN A Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5 DELAY = 10n
E_ABMGATE1 YINT1 0 VALUE {{IF(V(A) > {VTHRESH} ,
+ {VDD},{VSS})}}
RINT YINT1 YINT2 1
CINT YINT2 0 {DELAY*1.3}
E_ABMGATE2 YINT3 0 VALUE {{IF(V(YINT2) > {VTHRESH} ,
+ {VDD},{VSS})}}
RINT2 YINT3 Y 1
CINT2 Y 0 1n
.ENDS BUF_DELAY_BASIC_GEN
*$
.SUBCKT XOR2_BASIC_GEN A B Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABMGATE YINT 0 VALUE {{IF(V(A) > {VTHRESH} ^
+ V(B) > {VTHRESH},{VDD},{VSS})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS XOR2_BASIC_GEN
*$
**Reset has higher priority in this latch
.SUBCKT SRLATCHRHP_BASIC_GEN S R Q QB PARAMS: VDD=1 VSS=0 VTHRESH=0.5
GQ 0 Qint VALUE = {IF(V(R) > {VTHRESH},-5,IF(V(S)>{VTHRESH},5, 0))}
CQint Qint 0 1n
RQint Qint 0 1000MEG
D_D10 Qint MY5 D_D1
V1 MY5 0 {VDD}
D_D11 MYVSS Qint D_D1
V2 MYVSS 0 {VSS}
EQ Qqq 0 Qint 0 1
X3 Qqq Qqqd1 BUF_BASIC_GEN PARAMS: VDD={VDD} VSS={VSS} VTHRESH={VTHRESH}
RQq Qqqd1 Q 1
EQb Qbr 0 VALUE = {IF( V(Q) > {VTHRESH}, {VSS},{VDD})}
RQb Qbr QB 1
Cdummy1 Q 0 1n
Cdummy2 QB 0 1n
.IC V(Qint) {VSS}
.ENDS SRLATCHRHP_BASIC_GEN
*$
.SUBCKT DFFSBRB_RHPBASIC_GEN Q QB CLK D RB SB PARAMS: VDD=1 VSS=0 VTHRESH=0.5
***Set has higher priority in this
** Changed the delay from 7n/10n to 15n/20n to help larger time step simulations
**Faster flip-flops require a a smaller time step to simulate
X1 CLK CLKdel INV_DELAY_BASIC_GEN PARAMS: VDD={VDD} VSS={VSS} VTHRESH={VTHRESH} DELAY = 15n
X2 CLK CLKdel CLKint AND2_BASIC_GEN PARAMS: VDD={VDD} VSS={VSS} VTHRESH={VTHRESH} 
GQ 0 Qint VALUE = {IF(V(RB) < {VTHRESH},-5,IF(V(SB)< {VTHRESH},5, IF(V(CLKint)> {VTHRESH},
+ IF(V(D)> {VTHRESH},5,-5),0)))}
CQint Qint 0 1n
RQint Qint 0 1000MEG
D_D10 Qint MY5 D_D1
V1 MY5 0 5
D_D11 0 Qint D_D1
EQ Qqq 0 Qint 0 1
X3 Qqq Qqqd1 BUF_DELAY_BASIC_GEN PARAMS: VDD={VDD} VSS={VSS} VTHRESH={VTHRESH} DELAY = 20n
RQq Qqqd1 Q 1
EQb Qbr 0 VALUE = {IF( V(Q) > {VTHRESH}, {VSS},{VDD})}
RQb Qbr Qb 1
Cdummy1 Q 0 1nF
Cdummy2 QB 0 1nF
.IC V(Qint) {VSS}
.ENDS DFFSBRB_RHPBASIC_GEN
*$
**** BUFFER
.SUBCKT BUFFER_PS A Y PARAMS: vhi=1 vlo=0 vthresh=500e-3 tplh=1e-9 tphl=1e-9 tr=1e-9 tf=1e-9
RA A 0 1e11
CA A 0 0.01pF
VS VSUP 0 DC 1
***** boolean ************
EBUF1 Ypp 0 VALUE={IF(V(A) > ({vthresh}), 1, 0)}
ROUTpp Ypp 0 1e11
***** add delay lines ****
XNSW1 OUTp Ypp 0 NSW_PS PARAMS: RONval={(tplh+1e-15)/(1e-12*0.693)} VTHval=0.5
XPSW1 OUTp Ypp VSUP PSW_PS PARAMS: RONval={(tphl+1e-15)/(1e-12*0.693)} VTHval=0.5
CDEL1 OUTp 0 1pF
ETHRESH Yp 0 VALUE={IF(V(OUTp) > 0.5, 1, 0)}
ROUTp Yp 0 1e11
** add rise and fall *****
XNSW2 OUTr Yp 0 NSW_PS PARAMS: RONval={(tf+1e-15)/(1e-12*2.3)} VTHval=0.5
XPSW2 OUTr Yp VSUP PSW_PS PARAMS: RONval={(tr+1e-15)/(1e-12*2.3)} VTHval=0.5
CDEL2 OUTr 0 1pF
**************************
EOUT OUTf 0 VALUE={V(OUTr)*({vhi} - {vlo})+{vlo}}
RDR OUTf Y 1000
RO Y 0 1e11
.ENDS BUFFER_PS
*$
**** INVERTER
.SUBCKT INV_PS Y A PARAMS: vhi=1 vlo=0 vthresh=500e-3 tplh=1e-9 tphl=1e-9 tr=1e-9 tf=1e-9
RA A 0 1e11
CA A 0 0.01pF
VS VSUP 0 DC 1
***** boolean ************
EINV1 Ypp 0 VALUE={IF(V(A) > ({vthresh}), 0, 1)}
ROUTpp Ypp 0 1e11
***** add delay lines ****
XNSW1 OUTp Ypp 0 NSW_PS PARAMS: RONval={(tplh+1e-15)/(1e-12*0.693)} VTHval=0.5
XPSW1 OUTp Ypp VSUP PSW_PS PARAMS: RONval={(tphl+1e-15)/(1e-12*0.693)} VTHval=0.5
CDEL1 OUTp 0 1pF
ETHRESH Yp 0 VALUE={IF(V(OUTp) > 0.5, 1, 0)}
ROUTp Yp 0 1e11
** add rise and fall *****
XNSW2 OUTr Yp 0 NSW_PS PARAMS: RONval={(tf+1e-15)/(1e-12*2.3)} VTHval=0.5
XPSW2 OUTr Yp VSUP PSW_PS PARAMS: RONval={(tr+1e-15)/(1e-12*2.3)} VTHval=0.5
CDEL2 OUTr 0 1pF
**************************
EOUT OUTf 0 VALUE={V(OUTr)*({vhi} - {vlo})+{vlo}}
RDR OUTf Y 1000
RO Y 0 1e11
.ENDS INV_PS
*$
.SUBCKT SW1P2T_PS A SWC SWD1 SWD2 PARAMS: vth=500e-3 ron=100 roff=1e6 tdelay=1e-9 trise=1e-9 tfall=1e-9 initval=0
*
VS VSUP 0 DC 1
***** boolean ************
EBUF1 Ypp 0 VALUE={IF(V(A) > ({vth}), {initval}, {1-initval})}
ROUTpp Ypp 0 1e11
***** add delay lines ****
XNSW1 OUTp Ypp 0 NSW_PS PARAMS: RONval={(tdelay+1e-15)/(1e-12*0.693)} VTHval=0.5
XPSW1 OUTp Ypp VSUP PSW_PS PARAMS: RONval={(tdelay+1e-15)/(1e-12*0.693)} VTHval=0.5
CDEL1 OUTp 0 1pF
ETHRESH Yp 0 VALUE={IF(V(OUTp) > 0.5, 1, 0)}
ROUTp Yp 0 1e11
** Add rise and fall *****
XNSW2 OUTr Yp 0 NSW_PS PARAMS: RONval={(trise+1e-15)/(1e-12*2.3)} VTHval=0.5
XPSW2 OUTr Yp VSUP PSW_PS PARAMS: RONval={(tfall+1e-15)/(1e-12*2.3)} VTHval=0.5
CDEL2 OUTr 0 1pF
***Switches ************
EOUT1 VG1 test1 VALUE={V(OUTr)}
Etest1 test1 0 VALUE {IF(V(SWD1) < V(SWC), V(SWD1), V(SWC))}
Etest2 test2 0 VALUE {IF(V(SWD2) < V(SWC), V(SWD2), V(SWC))}
EOUT2 VG2 test2 VALUE={1-V(OUTr)}
XNSW3 SWD1 VG1 SWC NSW_PS PARAMS: RONval={ron} VTHval=0.5
XNSW4 SWD2 VG2 SWC NSW_PS PARAMS: RONval={ron} VTHval=0.5
.ENDS SW1P2T_PS
*$
.SUBCKT NSW_PS D G S PARAMS: RONval=10k VTHval=0.7 VCHARval=0.01 CGval=0.01pF CDval=0.01pF CSval=0.01pf
RDDUM D 0 1e11
RSDUM S 0 1e11
RGDUM G 0 1e11
CG G D {CGval}
CD D S {CDval}
CS G S {CSval}
***EEXP F1 0 VALUE={LIMIT(((V(G,S)-VTHval)/VCHARval),-80,80)}
Etest test 0 VALUE={IF(V(D) > V(S), V(G,S), V(G,D))}
GOUT D S VALUE={V(D,S)/(RONval*(1+EXP(-LIMIT(((V(test)-VTHval)/VCHARval),-80,80))))}
.ENDS NSW_PS
*$
.SUBCKT PSW_PS D G S PARAMS: RONval=10k VTHval=0.7 VCHARval=0.01 CGval=0.01pF CDval=0.01pF
RDDUM D 0 1e11
RSDUM S 0 1e11
RGDUM G 0 1e11
CG G D {CGval}
CD D S {CDval}
***EEXP F1 0 VALUE={LIMIT(((V(S,G)-VTHval)/VCHARval),-80,80)}
Etest test 0 VALUE={IF(V(S) > V(D), V(S,G), V(D,G))}
GOUT S D VALUE={V(S,D)/(RONval*(1+EXP(-LIMIT(((V(test)-VTHval)/VCHARval),-80,80))))}
.ENDS PSW_PS
*$
.SUBCKT LDCR IN OUT
+ PARAMs: L=1u DCR=0.01 IC=0
L IN 1 {L} IC={IC}
RDCR 1 OUT {DCR}
.ENDS LDCR
*$
.SUBCKT CESR IN OUT
+ PARAMs: C=100u ESR=0.01 X=2 IC=0
C IN 1 {C*X} IC={IC}
RESR 1 OUT {ESR/X}
.ENDS CESR
*$
.SUBCKT COMP_BASIC_GEN INP INM Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABM Yint 0 VALUE {IF (V(INP) >
+ V(INM), {VDD},{VSS})}
R1 Yint Y 1
C1 Y 0 1n
.ENDS COMP_BASIC_GEN
*$
.SUBCKT AND4_BASIC_GEN A B C D Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABMGATE YINT 0 VALUE {{IF(V(A) > {VTHRESH} &
+ V(B) > {VTHRESH} &
+ V(C) > {VTHRESH} &
+ V(D) > {VTHRESH},{VDD},{VSS})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS AND4_BASIC_GEN
*$
.MODEL D300 D
+ IS=4.4997E-12
+ N=.79874
+ RS=1.0000E-6
+ IKF=1.0000E3
+ CJO=1.0000E-12
+ M=.3333
+ VJ=.75
+ ISR=100.00E-12
+ BV=100
+ IBV=100.00E-6
+ TT=5.0000E-9
*$
.SUBCKT NAND4_BASIC_GEN A B C D Y PARAMS: VDD=1 VSS=0 VTHRESH=0.5
E_ABMGATE YINT 0 VALUE {{IF(V(A) > {VTHRESH} &
+ V(B) > {VTHRESH} &
+ V(C) > {VTHRESH} &
+ V(D) > {VTHRESH},{VSS},{VDD})}}
RINT YINT Y 1
CINT Y 0 1n
.ENDS NAND4_BASIC_GEN
*$
.SUBCKT DFFSR_RHPBASIC_GEN Q QB CLK D R S PARAMS: VDD=1 VSS=0 VTHRESH=0.5
***Set has higher priority in this
** Changed the delay from 7n/10n to 15n/20n to help larger time step simulations
**Faster flip-flops require a a smaller time step to simulate
X1 CLK CLKdel INV_DELAY_BASIC_GEN PARAMS: VDD={VDD} VSS={VSS} VTHRESH={VTHRESH} DELAY = 15n
X2 CLK CLKdel CLKint AND2_BASIC_GEN PARAMS: VDD={VDD} VSS={VSS} VTHRESH={VTHRESH}  
GQ 0 Qint VALUE = {IF(V(R) > {VTHRESH},-5,IF(V(S) > {VTHRESH},5, IF(V(CLKint)> {VTHRESH},
+ IF(V(D)> {VTHRESH},5,-5),0)))}
CQint Qint 0 1n
RQint Qint 0 1000MEG
D_D10 Qint MY5 D_D1
V1 MY5 0 {VDD}
D_D11 MYVSS Qint D_D1
V2 MYVSS 0 {VSS}
EQ Qqq 0 Qint 0 1
X3 Qqq Qqqd1 BUF_DELAY_BASIC_GEN PARAMS: VDD={VDD} VSS={VSS} VTHRESH={VTHRESH} DELAY = 20n
RQq Qqqd1 Q 1
EQb Qbr 0 VALUE = {IF( V(Q) > {VTHRESH}, {VSS},{VDD})}
RQb Qbr Qb 1
Cdummy1 Q 0 1nF
Cdummy2 QB 0 1nF
.IC V(Qint) {VSS}
.ENDS DFFSR_RHPBASIC_GEN
*$
.SUBCKT POWERMOS G D S PARAMS: RDSON=16m Ciss=1375p Crss=70p Coss=340p VSP=3.5 RG=1
* This is a simple model for Power MOSFET.
* The parameters modeled are 
* - RDSon, 
* - Input Capacitance, 
* - Reverse capacitance, 
* - Output capacitance,
* - Switching point voltage (Gate voltage where the FET starts switching), 
* - Gate Resistance
C_C1 S Da {Coss} IC=0
R_R1 Da D 10
C_C2 Ga D {Crss} IC=0
R_R2 G Ga {RG}
C_C3 Ga S {Ciss} IC=0
D_D1 S Db Dbreak
R_R3 Db D 1m
S_switchM D S Ga S _switchM
RS_switchM Ga S 100Meg
.MODEL         _switchM VSWITCH Roff=100e6 Ron={RDSON} Voff=1.1 Von={VSP}
.model Dbreak D Is=1e-14 Cjo=.1pF Rs=.1
.ends POWERMOS
*$
.SUBCKT UTD_TPS40007avg 1 2 PARAMS: K=1 TD=0.45U
RIN 1 0 1E15
E1 3 0 1 0 {K}
T1 3 0 2 0 Z0=1 TD={TD}
R1 2 0 1
.ENDS UTD_TPS40007avg
*$
.model Dbreak D Is=1e-14 Cjo=.1pF Rs=.1
*$
