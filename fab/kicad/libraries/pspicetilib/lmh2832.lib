* LMH2832
*****************************************************************************
* (C) Copyright 2012 Texas Instruments Incorporated. All rights reserved.                                            
*****************************************************************************
** This model is designed as an aid for customers of Texas Instruments.
** TI and its licensors and suppliers make no warranties, either expressed
** or implied, with respect to this model, including the warranties of 
** merchantability or fitness for a particular purpose.  The model is
** provided solely on an "as is" basis.  The entire risk as to its quality
** and performance is with the customer.
*****************************************************************************
*
** Released by: WEBENCH(R) Design Center, Texas Instruments Inc.
* Part: LMH2832
* Date: 4/11/16
* Model Type: All In One
* Simulator: TINA
* Simulator Version: 9.3.150.4 SF-TI
* EVM Order Number: N/A 
* EVM Users Guide: N/A
* Datasheet: SBOS709A - JULY 2016 - REVISED JULY 2016
*
* Model Version: 1.1
*
*****************************************************************************
*
* Updates:
*
* Version 1.0 : Release to Web
* Version 1.1 : Revise internal CM output connection
*****************************************************************************
* Notes: 
* 1. 
* 2. 
* 3. 
* 4. 
*****************************************************************************
*$
.SUBCKT LMH2832 OUTP OUTM INP INM B5 B4 B3 B2 B1 B0 PD VCC GND
R_R59         B4 GND  1e7 TC=0,0 
X_U2         ATTEN_OUTP ATTEN_OUTM N2564924 N2564772 GND B5 B4 B3 B2 B1 B0 GND
+  LMH2832_Noise_Source 
E_E5         VCM GND VCC GND 0.5
V_V14         N2564780 GND 0Vdc
V_V15         N2684353 GND 0.375Vdc
E_E3         ATTEN_OUT 0 ATTEN_OUTP ATTEN_OUTM 1
X_U4         CNTRL_OUT INP INM VCC GND VCM PD GND CONTROL 
X_U1         ATTEN_OUTP ATTEN_OUTM INP INM GND GND GND B5 B4 B3 B2 B1 B0 PD_INT
+  VCC GND LMH2832_DIG_ATTEN
C_C1         GND COMP_IN  110p  TC=0,0 
V_V16         VDIG_PU GND 2Vdc
R_R52         CNTRL_OUT COMP_IN  1.05k TC=0,0 
X_U3         PD_INT COMP_IN N2684353 GND COMPARATOR 
E_E4         GAIN_STAGE_OUT 0 GAIN_STAGE_OUTP GAIN_STAGE_OUTM 1
R_R47         N2564780 N2564924  125 TC=0,0 
R_R54         B0 VDIG_PU  1e7 TC=0,0 
R_R48         N2564772 N2564780  125 TC=0,0 
R_R55         B1 VDIG_PU  1e7 TC=0,0 
R_LMH2832_GAIN_STAGE_R10         LMH2832_GAIN_STAGE_N2332670
+  LMH2832_GAIN_STAGE_N2332656  10 TC=0,0 
G_LMH2832_GAIN_STAGE_G11         LMH2832_GAIN_STAGE_GAIN_INM
+  LMH2832_GAIN_STAGE_GAIN_INP ATTEN_OUTP ATTEN_OUTM -1
G_LMH2832_GAIN_STAGE_G2         LMH2832_GAIN_STAGE_N2914755
+  LMH2832_GAIN_STAGE_N2914767 LMH2832_GAIN_STAGE_P1P LMH2832_GAIN_STAGE_P1M 0.2
R_LMH2832_GAIN_STAGE_R6         LMH2832_GAIN_STAGE_GCM LMH2832_GAIN_STAGE_GCP 
+  2 TC=0,0 
R_LMH2832_GAIN_STAGE_R11         GND LMH2832_GAIN_STAGE_N2914755  5 TC=0,0 
C_LMH2832_GAIN_STAGE_C3         LMH2832_GAIN_STAGE_P2M LMH2832_GAIN_STAGE_P2P 
+  20f  TC=0,0 
R_LMH2832_GAIN_STAGE_R7         GND GAIN_STAGE_OUTP  1 TC=0,0 
R_LMH2832_GAIN_STAGE_R42         OSTG_FBP GND  1k TC=0,0 
R_LMH2832_GAIN_STAGE_R36         LMH2832_GAIN_STAGE_N2949694
+  LMH2832_GAIN_STAGE_N2949688  200 TC=0,0 
R_LMH2832_GAIN_STAGE_R12         LMH2832_GAIN_STAGE_N2914767 GND  5 TC=0,0 
L_LMH2832_GAIN_STAGE_L12         LMH2832_GAIN_STAGE_N2332670
+  LMH2832_GAIN_STAGE_P1M  100pH  
R_LMH2832_GAIN_STAGE_R14         GAIN_STAGE_OUTM GND  1 TC=0,0 
R_LMH2832_GAIN_STAGE_R13         LMH2832_GAIN_STAGE_N2914767
+  LMH2832_GAIN_STAGE_N2914755  10 TC=0,0 
R_LMH2832_GAIN_STAGE_R16         GND LMH2832_GAIN_STAGE_GAIN_INM  1 TC=0,0 
R_LMH2832_GAIN_STAGE_R15         GAIN_STAGE_OUTM GAIN_STAGE_OUTP  2 TC=0,0 
R_LMH2832_GAIN_STAGE_R17         LMH2832_GAIN_STAGE_GAIN_INP GND  1 TC=0,0 
X_LMH2832_GAIN_STAGE_U2         LMH2832_GAIN_STAGE_OUT1P
+  LMH2832_GAIN_STAGE_OUT1M LMH2832_GAIN_STAGE_N2949676
+  LMH2832_GAIN_STAGE_N2949682 LMH2832_GAIN_STAGE_N2949694
+  LMH2832_GAIN_STAGE_N2949688 LMH2832_GAIN_STAGE_GAIN_INP
+  LMH2832_GAIN_STAGE_GAIN_INM GAIN 
L_LMH2832_GAIN_STAGE_L11         LMH2832_GAIN_STAGE_N2332656
+  LMH2832_GAIN_STAGE_P1P  100pH  
G_LMH2832_GAIN_STAGE_G1         LMH2832_GAIN_STAGE_N2332656
+  LMH2832_GAIN_STAGE_N2332670 LMH2832_GAIN_STAGE_GCP LMH2832_GAIN_STAGE_GCM 0.2
R_LMH2832_GAIN_STAGE_R18         LMH2832_GAIN_STAGE_GAIN_INP
+  LMH2832_GAIN_STAGE_GAIN_INM  2 TC=0,0 
R_LMH2832_GAIN_STAGE_R35         LMH2832_GAIN_STAGE_N2949682
+  LMH2832_GAIN_STAGE_N2949676  200 TC=0,0 
R_LMH2832_GAIN_STAGE_R8         GND LMH2832_GAIN_STAGE_N2332656  5 TC=0,0 
G_LMH2832_GAIN_STAGE_G6         GAIN_STAGE_OUTP GAIN_STAGE_OUTM
+  LMH2832_GAIN_STAGE_P2P LMH2832_GAIN_STAGE_P2M 1
G_LMH2832_GAIN_STAGE_G10         LMH2832_GAIN_STAGE_GCP LMH2832_GAIN_STAGE_GCM
+  LMH2832_GAIN_STAGE_OUT1P LMH2832_GAIN_STAGE_OUT1M 1
C_LMH2832_GAIN_STAGE_C1         LMH2832_GAIN_STAGE_P1M LMH2832_GAIN_STAGE_P1P 
+  20p  TC=0,0 
R_LMH2832_GAIN_STAGE_R4         GND LMH2832_GAIN_STAGE_GCP  1 TC=0,0 
L_LMH2832_GAIN_STAGE_L13         LMH2832_GAIN_STAGE_N2914767
+  LMH2832_GAIN_STAGE_P2M  100pH  
L_LMH2832_GAIN_STAGE_L14         LMH2832_GAIN_STAGE_N2914755
+  LMH2832_GAIN_STAGE_P2P  100pH  
R_LMH2832_GAIN_STAGE_R9         LMH2832_GAIN_STAGE_N2332670 GND  5 TC=0,0 
R_LMH2832_GAIN_STAGE_R43         OSTG_FBM GND  1k TC=0,0 
R_LMH2832_GAIN_STAGE_R5         LMH2832_GAIN_STAGE_GCM GND  1 TC=0,0 
C_LMH2832_GAIN_STAGE_C2         LMH2832_GAIN_STAGE_GCM LMH2832_GAIN_STAGE_GCP 
+  110p  TC=0,0 
R_R49         N2564772 N2564924  250 TC=0,0 
R_R56         B3 VDIG_PU  1e7 TC=0,0 
E_E2         IN_DIFF 0 INP INM 1
R_R57         B2 GND  1e7 TC=0,0 
R_U10_R47         U10_OUT_E2P U10_N2318853  65 TC=0,0 
C_U10_C2         U10_OUT_E2P U10_N2318853  3pF  TC=0,0 
R_U10_R51         OSTG_FBM U10_N2366245  10 TC=0,0 
L_U10_L2         U10_OUT_E2P U10_N2318853  1.290pH  
E_U10_E23         U10_N2318853 GND VCM U10_CM_OUT 1e4
R_U10_R49         VCC 0  10k TC=0,0 
E_U10_E5         U10_VOUT GND OUTP OUTM 1
*E_U10_E26         U10_CM_OUT GND OUTP U10_N2319283 0.5
E_U10_E26         U10_CM_OUT GND OSTG_FBP U10_N2319283 0.5
C_U10_C1         U10_N2318853 U10_OUT_E1M  3pF  TC=0,0 
X_U10_H1    U10_N2366105 OUTP U10_IOUTP GND LMH2832_OUTPUT_STAGE_U10_H1 
*E_U10_E27         U10_N2319283 GND OUTM GND -1
E_U10_E27         U10_N2319283 GND OSTG_FBM GND -1
R_U10_R27         GND U10_VOUT  1k TC=0,0 
X_U10_U2         U10_OUT_LIM2P U10_OUT_LIM2M GAIN_STAGE_OUTP GAIN_STAGE_OUTM
+  U10_IOUTM LIMIT_POLY 
R_U10_R50         OSTG_FBP U10_N2366105  10 TC=0,0 
E_U10_E15         OSTG_FBP U10_OUT_E1M U10_OUT_LIM1P U10_OUT_LIM1M 1
X_U10_H2    U10_N2366245 OUTM U10_IOUTM GND LMH2832_OUTPUT_STAGE_U10_H2 
R_U10_R46         U10_N2318853 U10_OUT_E1M  65 TC=0,0 
X_U10_U1         U10_OUT_LIM1P U10_OUT_LIM1M GAIN_STAGE_OUTP GAIN_STAGE_OUTM
+  U10_IOUTP LIMIT_POLY 
E_U10_E16         U10_OUT_E2P OSTG_FBM U10_OUT_LIM2P U10_OUT_LIM2M 1
L_U10_L1         U10_N2318853 U10_OUT_E1M  12.9pH  
R_R53         PD GND  1e7 TC=0,0 
R_R58         B5 GND  1e7 TC=0,0 
R_R51         PD_INT 0  1k TC=0,0 
.ENDS
*$
.subckt LMH2832_OUTPUT_STAGE_U10_H1 1 2 3 4  
H_U10_H1         3 4 VH_U10_H1 -0.7
VH_U10_H1         1 2 0V
.ends
*$
.subckt LMH2832_OUTPUT_STAGE_U10_H2 1 2 3 4  
H_U10_H2         3 4 VH_U10_H2 -0.7
VH_U10_H2         1 2 0V
.ends
*$
.SUBCKT LMH2832_Noise_Source IOUT+ IOUT- INPD INMD B6 B5 B4 B3 B2 B1 B0 GRND
.PARAM VCM_OUT = 2.5
.PARAM VTHRESH_DIG = 1.05
.PARAM G_B6 = -6.4
.PARAM G_B5 = 2.6
.PARAM G_B4 = 0.6
.PARAM G_B3 = 1.5
.PARAM G_B2 = 1.2
.PARAM G_B1 = -1.8
.PARAM G_B0 = -0.9
.PARAM RINT = 100k
.PARAM VINT_INIT_0 = {0}
.PARAM VINT_INIT_1 = {1}
.PARAM ATTEN_GAIN_MIN = -8
EB6 N_B6 0 VALUE = {0.5*(1 + SGN(V(B6)-VTHRESH_DIG))}
EB5 N_B5 0 VALUE = {0.5*(1 + SGN(V(B5)-VTHRESH_DIG))}
EB4 N_B4 0 VALUE = {0.5*(1 + SGN(V(B4)-VTHRESH_DIG))}
EB3 N_B3 0 VALUE = {0.5*(1 + SGN(V(B3)-VTHRESH_DIG))}
EB2 N_B2 0 VALUE = {0.5*(1 + SGN(V(B2)-VTHRESH_DIG))}
EB1 N_B1 0 VALUE = {0.5*(1 + SGN(V(B1)-VTHRESH_DIG))}
EB0 N_B0 0 VALUE = {0.5*(1 + SGN(V(B0)-VTHRESH_DIG))}
*
E_ATTEN_GAIN_DB N_GAIN_DB 0 VALUE = {MAX(G_B6*V(N_B6)+G_B5*V(N_B5)+G_B4*V(N_B4)+G_B3*V(N_B3)
+ +G_B2*V(N_B2)+G_B1*V(N_B1)+G_B0*V(N_B0),ATTEN_GAIN_MIN)}
E_ATTEN_GAIN a1 0 VALUE = {PWR(10,V(N_GAIN_DB)/20)}
E_ID DIFF_IN 0      VALUE = {V(INPD) - V(INMD)}
G_DIFF_IN IOUT+ IOUT- VALUE = {V(a1)*V(DIFF_IN)}
.ENDS
*$
.SUBCKT CONTROL OUT INP INN VCC VEE GNDF PD GND
.PARAM VS_MAX = 5.3
.PARAM VS_MIN = 4.7
.PARAM VIH = 1.5
.PARAM VIL = 1.5
.PARAM VTHR = 1.0 
EVSTEST NVSTEST GNDF VALUE = {0.25*(1+SGN(VS_MAX - V(VCC,VEE)))*(1+SGN(V(VCC,VEE) - VS_MIN))}
EVICM NVICM GNDF VALUE = {0.5*(V(INP,GNDF)+V(INN,GNDF))}
EVICMMAXTEST NVICMMAXTEST GNDF VALUE = {IF(V(NVICM,GNDF) 
+ > V(VCC,GNDF)-VIH,0,1)}
EVICMMINTEST NVICMMINTEST GNDF VALUE = {IF(V(NVICM,GNDF) 
+ < V(VEE,GNDF)+VIL,0,1)}
EPD NPD GNDF VALUE = {0.5*(1 - SGN(V(PD,GND) - VTHR))}
EOUT OUT GND VALUE = {V(NVSTEST,GNDF)*V(NVICMMAXTEST,GNDF)
+*V(NVICMMINTEST,GNDF)*V(NPD,GNDF)}
.ENDS
*$
.SUBCKT LMH2832_DIG_ATTEN VOUT+ VOUT- INPD INMD INPS INMS B6 B5 B4 B3 B2 B1 B0 EN VCC GRND
.PARAM VCM_OUT = 2.5
.PARAM VTHRESH_DIG = 1.05
.PARAM VTHRESH_EN = 0.5
.PARAM SCALE = {1/1.3}
.PARAM G_B6 = -64
.PARAM G_B5 = -32
.PARAM G_B4 = -16
.PARAM G_B3 = -8
.PARAM G_B2 = -4
.PARAM G_B1 = -2
.PARAM G_B0 = -1
.PARAM RINT = 100k
.PARAM VINT_INIT_0 = {0}
.PARAM VINT_INIT_1 = {1}
.PARAM VCC_MIN = 4.74
.PARAM VCC_MAX = 5.26
.PARAM VCC_NOM = 5.0
.PARAM VIN_MAX = 3.5
.PARAM VIN_MIN = 1.5
.PARAM ATTEN_GAIN_MIN = -39
.PARAM VCM_IN = 2.5
.PARAM a3 = -1.13e-4
.PARAM a2 = -4e-5
.PARAM a0 = 0
.PARAM G_FDTHRU = {PWR(10,-(97/20))}
EVCC_TEST N_VCC_TEST 0 VALUE = {0.5*(1 - SGN(V(VCC,GRND)-VCC_MIN)*SGN(V(VCC,GRND)-VCC_MAX))}
EB6 N_B6 0 VALUE = {0.5*(1 + SGN(1000*(V(B6)-VTHRESH_DIG)))}
EB5 N_B5 0 VALUE = {0.5*(1 + SGN(1000*(V(B5)-VTHRESH_DIG)))}
EB4 N_B4 0 VALUE = {0.5*(1 + SGN(1000*(V(B4)-VTHRESH_DIG)))}
EB3 N_B3 0 VALUE = {0.5*(1 + SGN(1000*(V(B3)-VTHRESH_DIG)))}
EB2 N_B2 0 VALUE = {0.5*(1 + SGN(1000*(V(B2)-VTHRESH_DIG)))}
EB1 N_B1 0 VALUE = {0.5*(1 + SGN(1000*(V(B1)-VTHRESH_DIG)))}
EB0 N_B0 0 VALUE = {0.5*(1 + SGN(1000*(V(B0)-VTHRESH_DIG)))}
*
*EEN N_EN 0 VALUE = {MIN(MAX(SCALE*(V(EN)-VTHRESH_DIG),0),1)}
EEN N_EN 0 VALUE = {0.5*(1 + SGN(V(EN)-VTHRESH_EN))}
*
E_ATTEN_GAIN_DB N_GAIN_DB 0 VALUE = {MAX(G_B6*V(N_B6)+G_B5*V(N_B5)+G_B4*V(N_B4)+G_B3*V(N_B3)
+ +G_B2*V(N_B2)+G_B1*V(N_B1)+G_B0*V(N_B0),ATTEN_GAIN_MIN)}
*
E_ATTEN_GAIN a1 0 VALUE = {(1 - V(N_EN))*V(N_VCC_TEST)*(10^(V(N_GAIN_DB)/20)) + V(N_EN)*G_FDTHRU}
*
EinCM CM_INT 0 VALUE = {0.5*V(VCC,GRND)}
GINPD INPD INPDmid INPD INPDmid 0.0133
LINPD INPDmid CM_INT 1.5pH
CINPD INPD CM_INT 1.2p
GINMD INMD INMDmid INMD INMDmid 0.0133
LINMD INMDmid CM_INT 1.5pH
CINMD INMD CM_INT 1.2p
RINPS INPS GRND 50
RINMS INMS GRND 50
E_LIM_INPD INPD_LIM 0 VALUE = {MIN(MAX(V(INPD),VIN_MIN),VIN_MAX)}
E_LIM_INMD INMD_LIM 0 VALUE = {MIN(MAX(V(INMD),VIN_MIN),VIN_MAX)}
E_ID DIFF_IN 0        VALUE = {V(INPD_LIM) - V(INMD_LIM)}
G_DIFF_IN VOUT+ VOUT- VALUE = {(a0 + V(a1)*V(DIFF_IN) + a2*PWR(V(DIFF_IN),2) + a3*PWRS(V(DIFF_IN),3))}
GQ_EN VCC GRND VALUE = {(1-V(N_EN))*V(N_VCC_TEST)*0.1}
GQ_DIS VCC GRND VALUE = {(V(N_EN))*V(N_VCC_TEST)*(0.005)}
ROUT1+ VOUT+ N2 1
ROUT1- VOUT- N2 1
ROUTp  VOUT+ VOUT- 2
EoutCM N2 GRND VALUE = {0.5*V(VCC,GRND)}
.ENDS
*$
.SUBCKT COMPARATOR OUT IN REF GNDF
.PARAM VOUT_MAX = 1
.PARAM VOUT_MIN = 0
.PARAM GAIN = 1e4
EOUT OUT GNDF VALUE = {0.5*(1 - SGN(V(IN,REF)))}
.ENDS
*$
.SUBCKT GAIN OUT1+ OUT1- OUT2+ OUT2- OUT3+ OUT3- IN+ IN-
.PARAM a0 = 0
.PARAM a1 = {PWR(10,30/20)}
.PARAM a2 = 0.01
.PARAM a3 = 0.01
.PARAM LL = -1000
.PARAM UL = 1000
Eid DIFF_IN 0 VALUE = {V(IN+) - V(IN-)}
E1 OUT1+ OUT1- VALUE = {MAX(MIN(a1*V(DIFF_IN),UL),LL)}
E2 OUT2+ OUT2- VALUE = {MAX(MIN(a2*V(DIFF_IN)*V(DIFF_IN),UL),LL)}
E3 OUT3+ OUT3- VALUE = {MAX(MIN(a3*V(DIFF_IN)*V(DIFF_IN)*V(DIFF_IN),UL),LL)}
RE1+ OUT1+ 0 200
RE1- 0 OUT1- 200
RE1d OUT1+ OUT1- 400
RE2+ OUT2+ 0 200
RE2- 0 OUT2- 200
RE2d OUT2+ OUT2- 400
RE3+ OUT3+ 0 200
RE3- 0 OUT3- 200
RE3d OUT3+ OUT3- 400
.ENDS
*$
.SUBCKT LIMIT_POLY OUT+ OUT- IN+ IN- VC
.PARAM VCM_OUT = 0
.PARAM GAIN = 0.5
* Polynomial coefficients from MATLAB script VOUTvsIOUTfit.m
.PARAM a3 = -486.9354
.PARAM a2 = -164.9378
.PARAM a1 = 1.8034
.PARAM a0 = 1.544
E_UL UL 0 VALUE = {a3*PWRS(V(VC),3) + a2*PWR(V(VC),2) + a1*V(VC) + a0}
E_LL LL 0 VALUE = {a3*PWRS(V(VC),3) - a2*PWR(V(VC),2) + a1*V(VC) - a0}
EOUT OUT+ OUT- VALUE = {MIN(MAX(GAIN*(V(IN+)-V(IN-)),V(LL)),V(UL))}
V1CM N2 0 {VCM_OUT}
ROUT1+ OUT+ N2 100
ROUT1- OUT- N2 100
.ENDS
*$
