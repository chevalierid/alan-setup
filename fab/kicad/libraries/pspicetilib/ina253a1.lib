* INA253
*****************************************************************************
* (C) Copyright 2012 Texas Instruments Incorporated. All rights reserved.                                            
*****************************************************************************
** This model is designed as an aid for customers of Texas Instruments.
** TI and its licensors and suppliers make no warranties, either expressed
** or implied, with respect to this model, including the warranties of 
** merchantability or fitness for a particular purpose.  The model is
** provided solely on an "as is" basis.  The entire risk as to its quality
** and performance is with the customer.
*****************************************************************************
*
** Released by: WEBENCH(R) Design Center, Texas Instruments Inc.
* Part: INA253
* Date: 06/09/17
* Model Type: All In One
* Simulator: Pspice
* Simulator Version: Pspice 16.2
* EVM Order Number: N/A 
* EVM Users Guide: N/A
* Datasheet: SBOS954 - April 2017
* Model Version: 1.0
*
*****************************************************************************
*
* Updates:
*
* Version 1.0 : Release to Web
*
*
*****************************************************************************
* Notes: 
* The model reflects the following parameters:
* Common-mode input range, CMRR, VOS, IIB, Gain, BW, Vout versus Iout, 
* slew rate, noise, power supply range, IQ.
* The model does not track device behavior over temperature
*  
*****************************************************************************
*$
.SUBCKT INA253A1 OUT INP INN SHP SHN ISP ISN REF1 REF2 VCC GND
R_RISP       ISP SHP 1e-9 TC=0,0
R_RISN       ISN SHN 1e-9 TC=0,0
E_E2         N609752 0 GND 0 -1
X_U40         VCC GND INPUT_VCLAMP INPUT_ZOUT VIMON EN GNDF
+  VOUTVSIOUT_NROS_SHDN_INA253A1 
E_E11         INP_BUF_OUT GNDF INP GNDF 1
X_U12         INPUT_TF INPUT_VCLAMP VCC GND EN GNDF TF_INA253A1
X_U39         OUT_CNTRL VICM VCC GND GNDF CONTROL_INA253A1 
C_C3         N337909 0  1  TC=0,0 
E_E12         INN_BUF_OUT GNDF N409527 GNDF 1
R_R26         INPUT_OUTP N494504  475k TC=0,0 
X_U38         VCC GND INP_PSRR_IN INP_PSRR_OUT GNDF PSRR_INA253A1 
R_R23         OUT_CNTRL N698091  1m TC=0,0 
X_U31         INPUT_VIMON OUT VIMON GNDF AMETER_INA253A1 
R_R19         N494504 REF1  50k TC=0,0 
X_U18         INP GNDF VCC GND VICM GNDF IIBP_INA253A1
D_D1         IN_COMP N698091 Dideal 
R_R22         OUT_CNTRL IN_COMP  1000 TC=0,0 
R_R11         INPUT_ZOUT INPUT_VIMON  10 TC=0,0 
X_U5         VICM INP INN GNDF VICM_INA253A1
R_R27         N768714 ISP  2e-3 TC=0,0 
X_U37         INPUTP_GBW INPUT_OUTP vnse_INA253A1  
L_L1         ISN N768714  3pH  
E_E13         INP_BUF_OUT INP_CMRR VICM GNDF 0
R_R16         GNDF INP  1e9 TC=0,0 
V_V9         COMP_REF GNDF 0.7Vdc
E_E14         INN_BUF_OUT INN_CMRR VICM GNDF 0
V_V8         INN N409527 2.5uVdc
R_R25         N494504 REF2  50k TC=0,0 
C_C2         N337676 0  1  TC=0,0 
X_U17         INN GNDF VCC GND VICM GNDF IIBN_INA253A1
R_R4         INN_CMRR INPUTN_GBW  10k TC=0,0 
X_U36         VICM INP_CMRR INP_PSRR_IN GNDF CMRR_INA253A1 
R_R18         OUT INPUTN_GBW  500k TC=0,0 
X_U43         VCC GND VICM EN VIMON GNDF IQ_VICM_INA253A1 
R_R21         N609752 N337909  1 TC=0,0 
R_R3         INP_PSRR_OUT INPUT_OUTP  10k TC=0,0 
C_C1         N337909 N337676  1  TC=0,0 
X_U42         EN IN_COMP COMP_REF GNDF COMPARATOR_INA253A1 
E_E3         GNDF 0 N337676 N337909 0.5
R_R17         INN GNDF  1e9 TC=0,0 
R_R20         N609492 N337676  1 TC=0,0 
C_C4         GNDF IN_COMP  3n  TC=0,0 
E_E1         N609492 0 VCC 0 1
R_R24         GNDF EN  1k TC=0,0 
X_U41         INPUTP_GBW INPUTN_GBW INPUT_TF EN VCC GND GNDF GBW_SLEW_OUTLIMITS_INA253A1 
.MODEL Dideal D 
.ENDS
*$
*
.SUBCKT VNSE_INA253A1 1 2 
.PARAM NLF = 35 
.PARAM FLW = 1n  
.PARAM NVR = 35
.PARAM GLF={PWR(FLW,0.25)*NLF/1164}
.PARAM RNV={1.184*PWR(NVR,2)}
.MODEL DVN D KF={PWR(FLW,0.5)/1E11} IS=1.0E-16
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVN
D2 8 0 DVN
E1 3 6 7 8 {GLF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNV}
R5 5 0 {RNV}
R6 3 4 1E9
R7 4 0 1E9
E3 1 2 3 4 1
C1 1 0 1E-15
C2 2 0 1E-15
C3 1 2 1E-15
.ENDS
*$
*
.SUBCKT VOUTvsIOUT_NROS_SHDN_INA253A1  VCC  VEE  VI  VO VIMON SHDN GNDF
.PARAM ISC_POS = 0.003
.PARAM ISC_NEG = -0.0055
.PARAM IMAXLIN_POS = 0.0024
.PARAM IMAXLIN_NEG = -0.0045
.PARAM VOUTMAXLIN = 4.8
.PARAM VOUTMINLIN = 0.4
.PARAM VHR_VCC = -0.05
.PARAM VHR_VEE = 0.001
.PARAM VCC_DATASHEET = 5
.PARAM VEE_DATASHEET = 0
.PARAM VMID_DATASHEET = {(VCC_DATASHEET + VEE_DATASHEET)/2}
.PARAM VHR_MAX_LINEAR = {VOUTMAXLIN - VCC_DATASHEET}
.PARAM VHR_MIN_LINEAR = {VOUTMINLIN  - VEE_DATASHEET}
ER1 NR1 GNDF VALUE = {(VOUTMAXLIN - (VCC_DATASHEET + VHR_VCC))/IMAXLIN_POS}
ER2 NR2 GNDF VALUE = {(VOUTMINLIN - (VEE_DATASHEET + VHR_VEE))/IMAXLIN_NEG}
EVOUT1pos NVOUT1_MAX GNDF VALUE = {(V(VCC,GNDF) + VHR_VCC) + V(NR1,GNDF)*V(VIMON,GNDF)}
EVOUT1neg NVOUT1_MIN GNDF VALUE = {(V(VEE,GNDF) + VHR_VEE) + V(NR2,GNDF)*V(VIMON,GNDF)}
EM1 NM1 GNDF VALUE = {(VOUTMAXLIN - VMID_DATASHEET)/(IMAXLIN_POS - ISC_POS)}
EM2 NM2 GNDF VALUE = {(VOUTMINLIN - VMID_DATASHEET)/(IMAXLIN_NEG - ISC_NEG)}
EVMID NVMID GNDF VALUE = {(V(VCC,GNDF) + V(VEE,GNDF))/2}
E1 N1 GNDF VALUE = {V(VCC,GNDF) + VHR_MAX_LINEAR}
E2 N2 GNDF VALUE = {V(VEE,GNDF) + VHR_MIN_LINEAR} 
EV1 NV1 GNDF VALUE = {V(NVMID,GNDF) + (V(N1,GNDF) - V(NVMID,GNDF))/(1 - IMAXLIN_POS/ISC_POS)}
EV2 NV2 GNDF VALUE = {V(NVMID,GNDF) + (V(N2,GNDF) - V(NVMID,GNDF))/(1 - IMAXLIN_NEG/ISC_NEG)}
EVOUT2pos NVOUT2_MAX GNDF VALUE = {V(NV1,GNDF) + V(VIMON,GNDF)*V(NM1,GNDF)}
EVOUT2neg NVOUT2_MIN GNDF VALUE = {V(NV2,GNDF) + V(VIMON,GNDF)*V(NM2,GNDF)}
EHRPOS HRPOS GNDF VALUE = {MIN(V(NVOUT1_MAX,GNDF),V(NVOUT2_MAX,GNDF))}
EHRNEG HRNEG GNDF VALUE = {MAX(V(NVOUT1_MIN,GNDF),V(NVOUT2_MIN,GNDF))}
ECLAMP  VO GNDF VALUE = {V(SHDN,GNDF)*MAX(MIN(V(VI,GNDF), V(HRPOS,GNDF)), V(HRNEG,GNDF))}
.ENDS
*$
*
.SUBCKT TF_INA253A1  VI  VO  VCC VEE SHDN GNDF
.PARAM fz1 = 10G 
.PARAM fz2 = 10G 
.PARAM fz3 = 10G 
.PARAM fz4 = 10G 
.PARAM fz5 = 10G
.PARAM fp1 = 10e6 
.PARAM fp2 = 10G 
.PARAM fp3 = 10G 
.PARAM fp4 = 10G
.PARAM Gm = 1M
.PARAM Ro = {1/Gm}
.PARAM PI = 3.141592
.PARAM gL = 1M
Gp1  GNDF Vp1 VI GNDF {Gm}
Rp1  Vp1 GNDF {Ro}
Cp1  Vp1 GNDF {1/(2*PI*Ro*fp1)} IC = 0
Gp2  GNDF Vp2 Vp1 GNDF {Gm}
Rp2  Vp2 GNDF {Ro}
Cp2  Vp2 GNDF {1/(2*PI*Ro*fp2)} IC = 0
Gp3  GNDF Vp3 Vp2 GNDF {Gm}
Rp3  Vp3 GNDF {Ro}
Cp3  Vp3 GNDF {1/(2*PI*Ro*fp3)} IC = 0
Gp4  GNDF VO Vp3 GNDF {Gm}
Rp4  VO GNDF {Ro}
Cp4  VO GNDF {1/(2*PI*Ro*fp4)} IC = 0
.ENDS
*$
*
.SUBCKT CONTROL_INA253A1 OUT_CNTRL IN VCC VEE GNDF
.PARAM VCCMAX = 6.0
.PARAM VCCMIN = 2.69
.PARAM VICMMAX = 80.01
.PARAM VICMMIN = -4.01
EN1 N1 0 VALUE = {SGN(VCCMAX - V(VCC,VEE)) - 1 + ABS(SGN(VCCMAX - V(VCC,VEE)))}
EN2 N2 0 VALUE = {SGN(V(VCC,VEE)-VCCMIN) - 1 + ABS(SGN(V(VCC,VEE)-VCCMIN))}
EVCCMAX NVCCMAX 0 VALUE = {0.5*(1 + V(N1))}
EVCCMIN NVCCMIN 0 VALUE = {0.5*(1 + V(N2))}
EN3 N3 0 VALUE = {SGN(VICMMAX - V(IN)) - 1 + ABS(SGN(VICMMAX - V(IN)))}
EN4 N4 0 VALUE = {SGN(V(IN)-VICMMIN) - 1 + ABS(SGN(V(IN)-VICMMIN))}
EVICMMAX NVICMMAX 0 VALUE = {0.5*(1 + V(N3))}
EVICMMIN NVICMMIN 0 VALUE = {0.5*(1 + V(N4))}
EOUT OUT_CNTRL GNDF VALUE = {V(NVCCMAX)*V(NVCCMIN)*V(NVICMMAX)*V(NVICMMIN)}
.ENDS
*$
*
.SUBCKT PSRR_INA253A1  VDD  VSS  VI  VO  GNDF 
.PARAM PSRR = 120
.PARAM fpsrr = 300
.PARAM PI = 3.141592
.PARAM RPSRR = 1
.PARAM GPSRR = {PWR(10,-PSRR/20)/RPSRR}
.PARAM LPSRR = {RPSRR/(2*PI*fpsrr)}
G1  GNDF 1 VDD VSS {GPSRR}
R1  1 2 {RPSRR}
L1  2 GNDF {LPSRR} 
E1  VO VI 1 GNDF 1
.ENDS
*$
*
.SUBCKT AMETER_INA253A1  VI  VO VIMON GNDF
.PARAM GAIN = 1
VSENSE VI VO DC = 0
EMETER VIMON GNDF VALUE = {I(VSENSE)*GAIN}
.ENDS
*$
*
.SUBCKT IIBP_INA253A1 OUT IN VCC VEE INP GNDF
.PARAM VCMBRK = 5
.PARAM IIB_ZERO_VCM = 0
.PARAM IIB_VCMBRK = {2*32u}
.PARAM REQ_VCC_NEZERO = {1e6/2}
.PARAM REQ_VCC_EQZERO = {950k/2}
.PARAM R_DELTA = {1/(1/REQ_VCC_EQZERO - 1/REQ_VCC_NEZERO)}
EVCCTEST NVCCTEST 0 VALUE = {SGN(V(VCC,VEE)) - 1 + ABS(SGN(V(VCC,VEE)))}
E1ACT N1SGN 0 VALUE = {SGN(V(INP)-VCMBRK) - 1 + ABS(SGN(V(INP)-VCMBRK))}
GOUT2 OUT IN VALUE = {V(INP,GNDF)*(1/REQ_VCC_NEZERO 
+ + 0.5*(1-V(NVCCTEST ))/R_DELTA)
+ + 0.5*(1-V(NVCCTEST ))*(IIB_ZERO_VCM)}
GOUT1 OUT IN VALUE = {0.5*(1+V(N1SGN))*0.5*(1+V(NVCCTEST))*IIB_VCMBRK}
.ENDS
*$
*
.SUBCKT VICM_INA253A1 OUT INP INN GNDF
EOUT OUT GNDF VALUE = {0.5*(V(INP,GNDF) + V(INN,GNDF))}
.ENDS
*$
*
.SUBCKT IIBN_INA253A1 OUT IN VCC VEE INN GNDF
.PARAM VCMBRK = 5
.PARAM IIB_ZERO_VCM = 0
.PARAM IIB_VCMBRK = {2*32u}
.PARAM REQ_VCC_NEZERO = {1e6/2}
.PARAM REQ_VCC_EQZERO = {950k/2}
.PARAM R_DELTA = {1/(1/REQ_VCC_EQZERO - 1/REQ_VCC_NEZERO)}
EVCCTEST NVCCTEST 0 VALUE = {SGN(V(VCC,VEE)) - 1 + ABS(SGN(V(VCC,VEE)))}
E1ACT N1SGN 0 VALUE = {SGN(V(INN)-VCMBRK) - 1 + ABS(SGN(V(INN)-VCMBRK))}
GOUT2 OUT IN VALUE = {V(INN,GNDF)*(1/REQ_VCC_NEZERO 
+ + 0.5*(1-V(NVCCTEST ))/R_DELTA)
+ + 0.5*(1-V(NVCCTEST ))*(IIB_ZERO_VCM)}
GOUT1 OUT IN VALUE = {0.5*(1+V(N1SGN))*0.5*(1+V(NVCCTEST))*IIB_VCMBRK}
.ENDS
*$
*
.SUBCKT CMRR_INA253A1  VICM VI  VO  GNDF 
.PARAM CMRR = 132
.PARAM fcmrr = 500
.PARAM PI = 3.141592
.PARAM RCMRR = 1
.PARAM GCMRR = {PWR(10,-CMRR/20)/RCMRR}
.PARAM LCMRR = {RCMRR/(2*PI*fcmrr)}
.PARAM CCMRR = {RCMRR/(2*PI*fcmrr)}
G1  GNDF 1 VICM GNDF {GCMRR}
R1  1 2 {RCMRR}
L1  2 GNDF {LCMRR}
E1  VI VO 1 GNDF 1
.ENDS
*$
*
.SUBCKT IQ_VICM_INA253A1 VCC VEE VICM SHDN VIMON GNDF
.PARAM IQ_SHDN = 0.01u
.PARAM Geq = 18.75u
.PARAM IQ_NOM = 2.5e-3
GVAR VCC VEE VALUE = {(V(SHDN)+ 1e-9)*Geq}
GIQ VCC VEE VALUE = {IQ_NOM*V(SHDN,GNDF)}
ESGNIOUT NSGNIOUT 0 VALUE = {SGN(V(VIMON,GNDF))}
GOUTP VCC GNDF VALUE = {0.5*(1 + V(NSGNIOUT))*V(VIMON,GNDF)*V(SHDN,GNDF)}
GOUTN GNDF VEE VALUE = {0.5*(1 - V(NSGNIOUT))*V(VIMON,GNDF)*V(SHDN,GNDF)}
.ENDS
*$
*
.SUBCKT COMPARATOR_INA253A1 OUT IN REF GNDF
.PARAM VOUT_MAX = 1
.PARAM VOUT_MIN = 0
.PARAM GAIN = 1e4
EOUT OUT GNDF VALUE = {MAX(MIN(GAIN*V(IN,REF),VOUT_MAX),VOUT_MIN)}
.ENDS
*$
*
.SUBCKT GBW_SLEW_OUTLIMITS_INA253A1  VIP  VIM  VO SHDN VCC VEE GNDF 
.PARAM Aol = 160  
.PARAM GBW = 19e6  
.PARAM SRP = 3e6  
.PARAM SRN = 3e6 
.PARAM IT = 0.001
.PARAM PI = 3.141592
.PARAM IP = {IT*MAX(1,SRP/SRN)}
.PARAM IN = {IT*MIN(-1,-SRN/SRP)}
.PARAM CC = {IT*MAX(1/SRP,1/SRN)}
.PARAM FP = {GBW/PWR(10,AOL/20)}
.PARAM RC = {1/(2*PI*CC*FP)}
.PARAM GC = {PWR(10,AOL/20)/RC}
G1p GNDF OUTG1p VALUE = {MAX(MIN(GC*V(SHDN,GNDF)*V(VIP,VIM),IP),IN)}
G1n OUTG1n GNDF VALUE = {MAX(MIN(GC*V(SHDN,GNDF)*V(VIP,VIM),IP),IN)}
E1OUT VO GNDF VALUE = {MAX(MIN(V(SHDN,GNDF)*V(OUTG1p,OUTG1n),V(VCC,GNDF)),V(VEE,GNDF))}
RG1p OUTG1p GNDF {0.5*RC}
Cg1dp OUTG1p GNDF {2*CC} IC=0
RG1n OUTG1n GNDF {0.5*RC}
Cg1dn OUTG1n GNDF {2*CC} IC=0
.ENDS
*$
*